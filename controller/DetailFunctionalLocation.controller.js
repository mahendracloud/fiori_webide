sap.ui.define(["ugiaiwui/mdg/aiw/request/controller/BaseController","sap/ui/model/json/JSONModel","sap/ui/core/routing/History","ugiaiwui/mdg/aiw/request/model/formatter","sap/ui/model/Filter","sap/ui/model/FilterOperator","ugiaiwui/mdg/aiw/request/util/ValueHelpRequest","ugiaiwui/mdg/aiw/library/js/ClassUtils","ugiaiwui/mdg/aiw/library/js/ValueHelpProvider","sap/m/BusyDialog","sap/ui/core/message/Message"],function(e,t,a,i,n,l,o,r,s,d,c){"use strict";return e.extend("ugiaiwui.mdg.aiw.request.controller.DetailFunctionalLocation",{formatter:i,detailFlag:true,oAttach:[],_oCatalog:null,_oResourceBundle:null,oFileUpload:"",flCatSelectDialog:undefined,stSelectDialog:undefined,otCatSelectDialog:undefined,mpCatSelectDialog:undefined,cntrySelectDialog:undefined,isItemPress:"",classType:"",_class:"",defaultCharArr:[],charValueArr:[],lArray:[],singleVal:"",charValue:"",cPath:"",sPath:"",resultArr:[],system:false,onInit:function(){this._oView=this.getView();this._oComponent=sap.ui.component(sap.ui.core.Component.getOwnerIdFor(this.getView()));this.getRouter().getRoute("detailFloc").attachPatternMatched(this._onRouteMatched,this);var e=this._oComponent.getModel();e.setDefaultCountMode(sap.ui.model.odata.CountMode.None);this.getView().setModel(e);var a=this._oComponent.getModel("NewModel");this.getView().setModel(a,"valueHelp");var i=this._oComponent.getModel("NewModel2");this.getView().setModel(i,"valueHelp2");this.oAttach=[];this.resultArr=[];this.oModelUpdateFlag=false;this.oModelName="AIWFLOC";var n=this.getView().createId("clsFrag");var l=this.getView().createId("charFrag");var o=this.getView().createId("linearcharFrag");var r=this.getView().createId("lamFrag");this.class=sap.ui.core.Fragment.byId(n,"assignmentTab");this.char=sap.ui.core.Fragment.byId(l,"characteristicsTab");this.linearChar=sap.ui.core.Fragment.byId(o,"idTblLinearChar");this.lam=sap.ui.core.Fragment.byId(r,"lamSimpleForm");var s=this.getView().createId("lamAprvFrag");this.lamAprvSF=sap.ui.core.Fragment.byId(s,"lamSimpleForm");var c={titleName:this.getOwnerComponent().getModel("i18n").getProperty("createFlocTitle"),visible:false,enabled:true,AltLblVisible:true};var u={createVisible:true,approveVisible:false,approveVisibleLin:false};this.getView().setModel(new t({enabled:true}),"flocAddressView");this.getView().setModel(new t,"SUP_FLOC_DATA");this.getView().setModel(new t(c),"mainView");this.getView().setModel(new t(u),"ApproveModel");this.readAddressTitle();this.isLam();this.readAddressVersion(this);this.AltKeyDerivation();this.BusyDialog=new d;this.getClassType(this);this.readDOIList();var g=new sap.ui.model.json.JSONModel;g.setData([]);this.getView().setModel(g,"dataOrigin");var p=sap.ui.getCore().getMessageManager();this.getView().setModel(p.getMessageModel(),"message");p.registerObject(this.getView(),true)},readDOIList:function(){var e=this.getView().getModel("valueHelp2");var t=this;var a=[new sap.ui.model.Filter("Entity","EQ","FUNCLOC")];e.read("/DOIListSet",{filters:a,success:function(e){var a=new sap.ui.model.json.JSONModel;var i=e.results;var n=[];for(var l=0;l<i.length;l++){var o=new Object;var r=e.results[l].Property;o["SupFlVal"]="";o["instLoc"]=false;o["maintenance"]=false;o["Label"]=e.results[l].Label;o["property"]=e.results[l].Property;o["currentVal"]="";o["doiIcon"]=true;o[e.results[l].Property]="";if(e.results[l].Property==="Maintplant"){o["locEnable"]=false;o["maintEnable"]=false}else{o["locEnable"]=true;o["maintEnable"]=true}n.push(o)}t.DOIarrayFL=n},error:function(e){}})},_superFlocDesc:function(e,t){var a=this;var i="/FunctionLocationSet";var n=this.getView().getModel(this.oModelName).getData();var l=[new sap.ui.model.Filter("Tplnr","EQ",e.getValue())];var o=a.getView().getModel("valueHelp");o.read(i,{filters:l,success:function(e,t){n.SupFlocdescription=e.results[0].Pltxt;n.SupFunctionallocationVS="None";a.getView().getModel(this.oModelName).setData(n)},error:function(e){n.SupFlocdescription="";n.SupFunctionallocationVS="Error";a.getView().getModel(this.oModelName).setData(n)}})},onDOICancelPress:function(e){if(this.doiDisplayFlag){e.getSource().getParent().close();this.doiDisplayFlag=false;return}var t=this.getView().getModel(this.oModelName).getData();var a=e.getSource().getParent().getBeginButton().getText();if(a!=="Dismantle"){if(this.isInstall){this.getView().byId("superFloc").setValue(this.prevFlocValue);if(this.prevFlocValue){this._superFlocDesc(this.getView().byId("superFloc"),"prev")}}else{t.SupFunctionallocation="";t.SupFlocdescription="";t.SupFunctionallocationVS="None";this.functionalLocation="";this.functionalLocDesc=""}}else{t.SupFunctionallocation="";t.SupFlocdescription=""}this.getView().getModel(this.oModelName).setData(t);e.getSource().getParent().close()},onObjectSelect:function(e){var t=e.getSource().getText();var a="";var i=e.getParameter("selected"),n;var l=e.getSource().getParent().getParent();var o=l.getItems();var r=e.getSource().getParent().getParent().getParent().getBeginButton().getText();if(t==="IL"){a=e.getSource().getParent().getParent().getColumns()[5].getAggregation("header");n=a.getSelected();if(i){a.setSelected(false)}o.forEach(function(e){var t=e.getCells()[3];var a=e.getCells()[5];var n=e.getBindingContext().getObject();if(i){if(r==="Dismantle"){t.setSelected(i);n.finalDismantle=n.SupFlVal}else{t.setSelected(i);a.setSelected(false);n.targetVal=n.SupFlVal}}else{if(r==="Dismantle"){t.setSelected(i);n.finalDismantle=""}}})}else if(t==="FL"){a=e.getSource().getParent().getParent().getColumns()[3].getAggregation("header");n=a.getSelected();if(i){a.setSelected(false)}o.forEach(function(e){var t=e.getCells()[5];var a=e.getCells()[3];var n=e.getBindingContext().getObject();if(i){t.setSelected(i);a.setSelected(false);n.targetVal=""}})}},AltKeyDerivation:function(){var e="/DefaultValueSet";var t=this;var a=this.getView().getModel("valueHelp");a.read(e,{success:function(e,a){var i=t.getView().getModel("mainView").getData();i.AltLblVisible=e.results[0].AltLabel==="2"?true:false;t.getView().getModel("mainView").setData(i);t.AltLblDerv=e.results[0].AltLabel}})},_onRouteMatched:function(e){var a=this;var i=e.getParameter("name");if(i==="detailFloc"){var n=sap.ui.getCore().getModel("ClassAttachRequest");var l=n.getData();if(l.attachFlocFlag){this.attachRequest();l.attachFlocFlag=false;n.setData(l)}this.rowIndex=decodeURIComponent(e.getParameter("arguments").Path);this.viewName=e.getParameter("arguments").ViewName;this.oModelUpdateFlag=false;var o=[],r=[],s=[],d;var c=true;var u=false;var g=sap.ui.getCore().getModel("flocAddressView");var p=g.getData();var f=this.getView().getModel("flocAddressView");var m=this.getView().getModel("mainView");var S=this.getView().getModel("ApproveModel");var h=f.getData();var F=m.getData();var M=S.getData();var v=new t;var L;F.enabled=true;F.visible=false;var C=sap.ui.getCore().getModel("dataOriginMOP");var V=C.getData();if(sap.ui.getCore().getModel("refreshModel")!==undefined){var A=sap.ui.getCore().getModel("refreshModel");A.setProperty("/refreshSearch",false)}this.getView().byId("idTBLAltLbl").setMode("Delete");this.getView().byId("idTBLIntlAddr").setMode("Delete");this.getView().byId("idBTNnewIntlAddr").setEnabled(true);this.getView().byId("idAddAltLbl").setEnabled(true);this.sCrStatus=e.getParameter("arguments").CrStatus;if(this.viewName==="CreateFloc"){v.setData(sap.ui.getCore().getModel(this.oModelName).getProperty(this.rowIndex));this.getView().setModel(v,this.oModelName);if(v.getData().Maintplant!==""&&v.getData().MaintplantVS!=="Error"){this.SOPMaintPlant=v.getData().Maintplant}else{this.SOPMaintPlant=""}var D=false;for(var b=0;b<V.FL.length;b++){if(v.getData().Functionallocation===V.FL[b].key){var N=new sap.ui.model.json.JSONModel;N.setData(V.FL[b].DOI);a.getView().setModel(N,"dataOrigin");this.functionalLocation=v.getData().SupFunctionallocation;this.functionalLocDesc=v.getData().SupFlocdescription;D=true;break}}if(!D){if(this.DOIarrayFL){var N=new sap.ui.model.json.JSONModel;N.setData(this.DOIarrayFL);a.getView().setModel(N,"dataOrigin");this.functionalLocation="";this.functionalLocDesc=""}else{jQuery.sap.delayedCall(10,a,function(){var e=new sap.ui.model.json.JSONModel;e.setData(this.DOIarrayFL);a.getView().setModel(e,"dataOrigin");this.functionalLocation="";this.functionalLocDesc=""})}}if(v.getData().viewParameter==="change"){v.getData().FunctionalLocEnabled=false;if(v.getData().Floccategory===""||v.getData().Floccategory===undefined){v.getData().FlocCatEnabled=true}else{v.getData().FlocCatEnabled=false}if(v.getData().Strucindicator===""||v.getData().Strucindicator===undefined){v.getData().StrucIndEnabled=true}else{v.getData().StrucIndEnabled=false}if(v.getData().Maintplant===""||v.getData().Maintplant===undefined){v.getData().MaintplantEnabled=true}else{v.getData().MaintplantEnabled=false}if(v.getData().Bukrs===""||v.getData().Bukrs===undefined){v.getData().BukrsEnabled=true}else{v.getData().BukrsEnabled=false}F.titleName=this.getOwnerComponent().getModel("i18n").getProperty("changeFloc")}else{v.getData().FunctionalLocEnabled=true;v.getData().FlocCatEnabled=true;v.getData().StrucIndEnabled=true;F.titleName=this.getOwnerComponent().getModel("i18n").getProperty("createFloc")}if(v.getData().Floccategory==="L"&&a.lamSwitch==="X"){this.lam.setVisible(true);this.lam.setModel(v,"AIWLAM")}else{this.lam.setVisible(false)}o=v.getData().classItems;this.chData=v.getData().characteristics;if(this.chData){if(o){for(var T=0;T<this.chData.length;T++){if(o[0].Class===this.chData[T].Class){r.push(this.chData[T])}}}}this.lnrChData=$.map(v.getData().linearChar,function(e){return $.extend(true,{},e)});if(this.lnrChData.length>0){for(var w=0;w<this.lnrChData.length;w++){if(r[0].Atnam===this.lnrChData[w].Charid){s.push(this.lnrChData[w])}}}d=v.getData().charNewButton;u=v.getData().linearCharAddEnable;L=v.getData().UstaEqui;this.setObjectAddress(this.oModelName);this.readSystemStatus(this);h.enabled=true;if(p.length>0){for(var I=0;I<p.length;I++){if(v.getData().Functionallocation===p[I].Functionallocation){h.enabled=p[I].IsEditable;break}}}if(h.enabled===false){this.getView().byId("idTBLIntlAddr").setMode("None")}else{this.getView().byId("idTBLIntlAddr").setMode("Delete")}var P=sap.ui.getCore().getModel("SUP_FLOC_DATA");if(P.getData()&&P.getData().length>0){var y;for(var x=0;x<P.getData().length;x++){if(v.getData().Functionallocation===P.getData()[x].Functionallocation){y="/"+x;break}}var k=[P.getProperty(y)];var E=$.map(k,function(e){return $.extend(true,{},e)});var O=new t;O.setData(E);this.getView().setModel(O,"SUP_FLOC_DATA")}else{this.getView().setModel(new t,"SUP_FLOC_DATA")}}if(this.viewName==="ChangeFloc"){var R=e.getParameter("arguments").CrStatus;var B=e.getParameter("arguments").Floc;F.titleName=this.getOwnerComponent().getModel("i18n").getProperty("changeFloc");if(R==="true"){c=false;d=false;u=false;F.enabled=false;h.enabled=false;this.getView().byId("idTBLAltLbl").setMode("None");this.getView().byId("idTBLIntlAddr").setMode("None");this.getView().byId("idBTNnewIntlAddr").setEnabled(false);this.getView().byId("idAddAltLbl").setEnabled(false)}this.readSystemStatus(this);this.sExistFlag=false;var H;var W=sap.ui.getCore().getModel(this.oModelName).getData();if(W.length>0){for(var U=0;U<W.length;U++){if(W[U].Functionallocation===B){H=U;this.sExistFlag=true;break}}}if(this.sExistFlag){if(p.length>0){for(var q=0;q<p.length;q++){if(W[H].Functionallocation===p[q].Functionallocation){h.enabled=p[q].IsEditable;break}}}if(h.enabled===false){this.getView().byId("idTBLIntlAddr").setMode("None")}else{this.getView().byId("idTBLIntlAddr").setMode("Delete")}o=W[H].classItems;this.chData=W[H].characteristics;if(this.chData.length>0){if(o.length>0){for(var T=0;T<this.chData.length;T++){if(o[0].Class===this.chData[T].Class){r.push(this.chData[T])}}}}this.lnrChData=$.map(v.getData().linearChar,function(e){return $.extend(true,{},e)});if(this.lnrChData.length>0){for(var w=0;w<this.lnrChData.length;w++){if(r[0].Atnam===this.lnrChData[w].Charid){s.push(this.lnrChData[w])}}}d=W[H].charNewButton;L=W[H].UstaEqui;W[H].FunctionalLocEnabled=false;W[H].FlocCatEnabled=false;W[H].StrucIndEnabled=false;W[H].MaintplantEnabled=false;W[H].BukrsEnabled=false;this.getView().setModel(new t(W[H]),this.oModelName);this.setObjectAddress(this.oModelName);if(W[H].Floccategory==="L"&&a.lamSwitch==="X"){this.lam.setVisible(true);this.lam.setModel(new t(W[H]),"AIWLAM")}else{this.lam.setVisible(false)}var K=sap.ui.getCore().getModel("dataOriginMOP").getData().FL;for(var b=0;b<K.length;b++){if(K[b].key===W[H].Functionallocation){this.getView().getModel("dataOrigin").setData(K[b].DOI);this.functionalLocation=W[H].SupFunctionallocation;this.functionalLocDesc=W[H].SupFlocdescription}}if(W[H].Maintplant!==""&&W[H].MaintplantVS!=="Error"){this.SOPMaintPlant=W[H].Maintplant}else{this.SOPMaintPlant=""}}else{this.readFunctionalLocData(B,R)}}if(this.viewName==="Approve"){v.setData(sap.ui.getCore().getModel(this.oModelName).getProperty(this.rowIndex));v.getData().FunctionalLocEnabled=false;v.getData().FlocCatEnabled=false;v.getData().StrucIndEnabled=false;v.getData().MaintplantEnabled=false;v.getData().BukrsEnabled=false;L=v.getData().UstaEqui;this.getView().setModel(v,this.oModelName);var z=new t;var _=sap.ui.getCore().getModel("AIWAPPROVE").getProperty("/AIWFLOC"+this.rowIndex);z.setData(_);this.getView().setModel(z,"AIWAPPROVE");F.titleName=this.getOwnerComponent().getModel("i18n").getProperty("approveFloc");F.enabled=false;h.enabled=false;M.createVisible=false;M.approveVisible=true;M.approveVisibleLin=false;this.getView().byId("idTBLAltLbl").setMode("None");this.getView().byId("idTBLIntlAddr").setMode("None");this.getView().byId("idBTNnewIntlAddr").setEnabled(false);this.getView().byId("idAddAltLbl").setEnabled(false);this.lam.setVisible(M.createVisible);this.lamAprvSF.setModel(v,"AIWLAM")}if(L){F.visible=true}var Z=this.getView().createId("clsFrag");var j=sap.ui.core.Fragment.byId(Z,"newHeader");j.setEnabled(c);var G=this.getView().createId("linearcharFrag");var J=sap.ui.core.Fragment.byId(G,"idBtnAddLinChar");J.setEnabled(u);this.class.setModel(new t(o));this.char.setModel(new t(r));this.linearChar.setModel(new t(s));this.class.setVisible(M.createVisible);this.char.setVisible(M.createVisible);this.linearChar.setVisible(M.createVisible);if(v.getData().Floccategory==="L"&&this.lamSwitch==="X"&&this.viewName!=="Approve"){this.linearChar.setVisible(true)}else{this.linearChar.setVisible(false)}if(this.viewName==="Approve"){var X=this.getView().createId("lamAprvFrag");var Q=sap.ui.core.Fragment.byId(X,"idPanelLinDataAprv");if(this.lamSwitch==="X"){Q.setVisible(true);M.approveVisibleLin=true}else{Q.setVisible(false);M.approveVisibleLin=false}}f.setData(h);m.setData(F);S.setData(M)}else{return}},isLam:function(){var e=this;var t=this.getView().getModel("valueHelp");t.read("/LAM_switchSet('')",{success:function(t,a){e.lamSwitch=t.lam_switch;var i=e.getView().getModel(e.oModelName);if(e.viewName==="Approve"){e.lam.setVisible(false);e.lamAprvSF.setModel(i,"AIWLAM");e.linearChar.setVisible(false)}else if(i.getData().Floccategory==="L"&&e.lamSwitch==="X"){e.lam.setVisible(true);e.lam.setModel(i,"AIWLAM");e.linearChar.setVisible(true)}else{e.lam.setVisible(false);e.linearChar.setVisible(false)}},error:function(e){}})},onInactiveSelect:function(e){var t=e.getSource().getModel(this.oModelName).getData();t.Deact=e.getSource().getSelected();this.readStatusProf(t.Floccategory,this)},onAfterRendering:function(){var e=this;if(sap.m.Input.prototype.onAfterRendering){$(document).on("focusin","input",function(){$(this).data("val",$(this).val())}).on("change","input",function(){if(this.id.indexOf("superFloc")>-1){e.prevFlocValue=$(this).data("val");e.currentFlocValue=$(this).val()}})}},onFlocPermitSelect:function(e){var t=this;var a=e.getParameter("listItem").getBindingContext(t.oModelName).getPath();a=parseInt(a.substring(a.lastIndexOf("/")+1));var i=this.getView().getModel(t.oModelName);if(i!==undefined){var n=i.getData();for(var l=0;l<n.Permits.length;l++){if(a===l){n.PermitLt=n.Permits[l].PermitLt;i.setData(n);break}}}},attachModelEventHandlers:function(e){e.attachPropertyChange(this.handlePropertyChanged,this)},handlePropertyChanged:function(){this.oModelUpdateFlag=true},valueHelpFunSelect:function(e){var t=e.getSource().getBindingInfo("value").binding.sPath;if(t.indexOf("/Floccategory")!==-1){o.valueHelpFunFlocCat(e.getSource().getModel(this.oModelName).getData(),this)}else if(t.indexOf("/Strucindicator")!==-1){o.valueHelpFunStrInd(e.getSource().getModel(this.oModelName).getData(),this)}else if(t.indexOf("/SupFunctionallocation")!==-1){o.valueHelpFunSupFloc(e,this)}else if(t.indexOf("/StsmEqui")!==-1){o.valueHelpFunStatProf(e.getSource().getModel(this.oModelName).getData(),this)}else if(t.indexOf("/UstwEqui")!==-1){o.valueHelpFunStatus(e.getSource().getModel(this.oModelName).getData(),this)}else if(t.indexOf("/UswoEqui")!==-1){o.valueHelpFunStatusWO(e.getSource().getModel(this.oModelName).getData(),this)}else if(t.indexOf("/TechnicalObjectTyp")!==-1){o.valueHelpFunTechObj(e.getSource().getModel(this.oModelName).getData(),this)}else if(t.indexOf("/Maintplant")!==-1){o.valueHelpFunMaintPlant(e.getSource().getModel(this.oModelName).getData(),this,e)}else if(t.indexOf("/Location")!==-1){o.valueHelpFunLocation(e.getSource().getModel(this.oModelName).getData(),this)}else if(t.indexOf("/Abckz")!==-1){o.valueHelpFunAbcInd(e.getSource().getModel(this.oModelName).getData(),this)}else if(t.indexOf("/Arbpl")!==-1){o.valueHelpFunWc(e.getSource().getModel(this.oModelName).getData(),this)}else if(t.indexOf("/BeberFl")!==-1){o.valueHelpFunPlantSec(e.getSource().getModel(this.oModelName).getData(),this)}else if(t.indexOf("/Bukrs")!==-1){o.valueHelpFunCompCode(e.getSource().getModel(this.oModelName).getData(),this)}else if(t.indexOf("/Kostl")!==-1){o.valueHelpFunCostCenter(e.getSource().getModel(this.oModelName).getData(),this)}else if(t.indexOf("/Werks")!==-1){o.valueHelpFunPlanPlant(e.getSource().getModel(this.oModelName).getData(),this)}else if(t.indexOf("/Ingrp")!==-1){o.valueHelpFunPlGrp(e.getSource().getModel(this.oModelName).getData(),this)}else if(t.indexOf("/MainArbpl")!==-1){o.valueHelpFunMainWc(e.getSource().getModel(this.oModelName).getData(),this)}else if(t.indexOf("/ConstrType")!==-1){o.ConstrTypeVH(this,e)}else if(t.indexOf("/RefPosta")!==-1){o.valueHelpFunCntry(e,this)}else if(t.indexOf("/Langucode")!==-1){o.valueHelpFunLang(e.getSource().getModel(this.oModelName).getData(),this)}else if(t.indexOf("/Title")!==-1){o.valueHelpFunTitle(e.getSource().getModel(this.oModelName).getData(),this)}else if(t.indexOf("/TimeZone")!==-1){o.valueHelpFunTimeZone(e,this)}else if(t.indexOf("/Region")!==-1){o.valueHelpFunRegion(e,this)}},flocCatChange:function(e){var t=this;var a=e.getSource().getValue();if(a===""||a===undefined){e.getSource().setValue("");e.getSource().getModel(t.oModelName).getData().FlocCategoryDesc=""}e.getSource().setValueState("None")},StructureIndicatorChange:function(e){var t=this;var a=e.getSource().getValue();if(a===""||a===undefined){e.getSource().getModel(t.oModelName).getData().Strucindicator="";e.getSource().getModel(t.oModelName).getData().StrucIndicatorDesc="";e.getSource().getModel(t.oModelName).getData().EditMask="";e.getSource().getModel(t.oModelName).getData().Hierarchy="";e.getSource().getModel(t.oModelName).getData().Location="";e.getSource().getModel(t.oModelName).getData().Locationdesc="";e.getSource().getModel(t.oModelName).getData().Abckz="";e.getSource().getModel(t.oModelName).getData().Abctx="";e.getSource().getModel(t.oModelName).getData().Bukrs="";e.getSource().getModel(t.oModelName).getData().Butxt="";e.getSource().getModel(t.oModelName).getData().City="";e.getSource().getModel(t.oModelName).getData().Kostl="";e.getSource().getModel(t.oModelName).getData().Mctxt="";e.getSource().getModel(t.oModelName).getData().Kokrs="";e.getSource().getModel(t.oModelName).getData().Werks="";e.getSource().getModel(t.oModelName).getData().Planningplantdes="";e.getSource().getModel(t.oModelName).getData().Ingrp="";e.getSource().getModel(t.oModelName).getData().Innam="";e.getSource().getModel(t.oModelName).getData().MainArbpl="";e.getSource().getModel(t.oModelName).getData().MainKtext="";e.getSource().getModel(t.oModelName).getData().MainWerks=""}e.getSource().setValueState("None")},onStrChange:function(e){var t=this;var a=e.getSource().getValue();if(a===""||a===undefined){e.getSource().setValue("")}else{var i=e.getSource().getModel(t.oModelName).getData().Functionallocation;if(i===""||i===undefined){e.getSource().setValue("");this.invokeMessage(this.getResourceBundle().getText("functionalLocationMand"))}else{e.getSource().setValue(a.toUpperCase());o._changeStrIndicator(e.getSource().getModel(t.oModelName).getData(),t)}}},SupflocChange:function(e){e.getSource().setValueState("None")},onSupFlocChange:function(e){var t=this;var a=e.getSource().getValue();if(a===""||a===undefined){this.openDoiView(a);e.getSource().setValue("");e.getSource().getModel(t.oModelName).getData().SupFlocdescription=""}else{e.getSource().setValue(a.toUpperCase());var i=false;var n=a.toUpperCase();var l=e.getSource().getModel(t.oModelName).getData().Strucindicator;var r=sap.ui.getCore().getModel(t.oModelName);var s=r.getData();for(var d=0;d<s.length;d++){if(n===s[d].Functionallocation){e.getSource().getModel(t.oModelName).getData().SupFlocdescription=s[d].Flocdescription;i=true;break}}if(i&&l){var c=e.getSource().getModel(t.oModelName).getData().SupFlocdescription;this.readSupFlocDetails(n,"SUP",c)}else{o._changeSupFunctionalLocation(e.getSource().getModel(t.oModelName).getData(),t)}}},readSupFlocDetails:function(e,a,n){var l=this;var o="/ChangeRequestSet";var r=l.getView().getModel();var s=l.getView().getModel("mainView");var d=s.getData();var c=sap.ui.getCore().getModel(l.oModelName);var u=l.getView().getModel(l.oModelName);var g=u.getData().Functionallocation;var p=[];var f={};var m={};var S={};var h=[];var F={ChangeRequestType:"AIWEAM0P",CrDescription:"",Reason:"01",DeriveData:true,FuncLoc:[],FLAddr:[],FLAddrI:[],FLALTLBEL:[],FLLAM:[],FLClass:[],FLVal:[],Equipment:[],EqAddr:[],EqAddrI:[],EqPRT:[],EqLAM:[],EqClass:[],EqVal:[],MSPoint:[],MSLAM:[],MSClass:[],MSVal:[],MPLAN:[],MPItem:[],MPLAM:[],MPOBList:[],MPCycle:[],MRBHeader:[],MRBItem:[],MRBSBIT:[],EBHeader:[],EBItem:[],EBSBIT:[],FBHeader:[],FBItem:[],FBSBIT:[],WBHeader:[],WBItem:[],WBSBIT:[],ONetwork:[],ONLAM:[],Workcenter:[],WCCost:[],GTList:[],GTOprs:[],GTComp:[],GTClass:[],GTVal:[],ETList:[],ETOprs:[],ETComp:[],ETClass:[],ETVal:[],FTList:[],FTOprs:[],FTComp:[],FTClass:[],FTVal:[],Olink:[],OLClass:[],OLVal:[],Messages:[],FLDOI:[],FLLAMCH:[]};var M=sap.ui.getCore().getModel(l.oModelName).getData();if(M.length>0){for(var v=0;v<M.length;v++){if(M[v].Functionallocation===""||M[v].Functionallocation===undefined){return}var L={Tplnr:M[v].Functionallocation,Txtmi:M[v].Flocdescription,TplkzFlc:M[v].Strucindicator,Tplxt:M[v].StrucIndicatorDesc,EditMask:M[v].EditMask,Hierarchy:M[v].Hierarchy,Fltyp:M[v].Floccategory,Flttx:M[v].FlocCategoryDesc,Swerk:M[v].Maintplant,Plantname:M[v].MaintplantDesc,StorFloc:M[v].Location,Locationdesc:M[v].Locationdesc,Abckzfloc:M[v].Abckz,Abctx:M[v].Abctx,Bukrsfloc:M[v].Bukrs,Butxt:M[v].Butxt,City:M[v].City,KostFloc:M[v].Kostl,KokrFloc:M[v].Kokrs,Contareaname:M[v].Mctxt,PlntFloc:M[v].Werks,Planningplantdes:M[v].Planningplantdes,Ingrp:M[v].Ingrp,Plannergrpdesc:M[v].Innam,Arbplfloc:M[v].Arbpl,Workcenterdesc:M[v].Ktext,Wergwfloc:M[v].WcWerks,Gewrkfloc:M[v].MainArbpl,MainWcDesc:M[v].MainKtext,MainWcPlant:M[v].MainWerks,Tplma:M[v].SupFunctionallocation,Supflocdesc:M[v].SupFlocdescription,BeberFl:M[v].BeberFl,Fing:M[v].Fing,Tele:M[v].Tele,Submtiflo:M[v].ConstrType,Constdesc:M[v].ConstructionDesc,Eqart:M[v].TechnicalObjectTyp,Eartx:M[v].Description,Stattext:M[v].Stattext,StsmFloc:M[v].StsmEqui,Statproftxt:M[v].StsmEquiDesc,UstwFloc:M[v].UstwEqui,UswoFloc:M[v].UswoEqui,UstaFloc:M[v].UstaEqui,IsMenu:M[v].menuAction,Adrnr:M[v].Adrnr,Adrnri:M[v].Adrnri,Deact:M[v].Deact,Alkey:M[v].Alkey,Modeldesc:M[v].Modeldesc,Modelref:M[v].Modelref,Modelrver:M[v].Modelrver,Modelext:M[v].Modelext,Modelname:M[v].Modelname,Modelver:M[v].Modelver};if(a&&g===M[v].Functionallocation){f=M[v];L.IsDOI=true}else if(g===M[v].Functionallocation&&g.indexOf("-")>-1){f=M[v];L.IsDOI=true;a="SUP";var C=g.lastIndexOf("-");var V=g.substring(0,C);L.Tplma=V}var A=sap.ui.getCore().getModel("dataOriginMOP").getData().FL;if(A&&A.length>0){var D=A[v].DOI;L.Swerki=D[0].instLoc?"H":D[0].maintenance?"D":"";L.Storti=D[1].instLoc?"H":D[1].maintenance?"D":"";L.Beberi=D[2].instLoc?"H":D[2].maintenance?"D":"";L.Ppsidi=D[3].instLoc?"H":D[3].maintenance?"D":"";L.Abckzi=D[4].instLoc?"H":D[4].maintenance?"D":"";L.Bukrsi=D[5].instLoc?"H":D[5].maintenance?"D":"";L.Kostli=D[6].instLoc?"H":D[6].maintenance?"D":"";L.Kokrsi=D[7].instLoc?"H":D[7].maintenance?"D":"";L.Iwerki=D[8].instLoc?"H":D[8].maintenance?"D":"";L.Ingrpi=D[9].instLoc?"H":D[9].maintenance?"D":"";L.Lgwidi=D[10].instLoc?"H":D[10].maintenance?"D":"";L.Adrnri=D[12].instLoc?"H":D[12].maintenance?"D":""}if(M[v].viewParameter==="create"){L.Type=true}F.FuncLoc.push(L);if(M[v].Title!==""&&M[v].Title!==undefined||M[v].TitleCode!==""&&M[v].TitleCode!==undefined||M[v].Name1!==""&&M[v].Name1!==undefined||M[v].Name2!==""&&M[v].Name2!==undefined||M[v].Name3!==""&&M[v].Name3!==undefined||M[v].Name4!==""&&M[v].Name4!==undefined||M[v].Sort1!==""&&M[v].Sort1!==undefined||M[v].Sort2!==""&&M[v].Sort2!==undefined||M[v].NameCo!==""&&M[v].NameCo!==undefined||M[v].PostCod1!==""&&M[v].PostCod1!==undefined||M[v].City1!==""&&M[v].City1!==undefined||M[v].Building!==""&&M[v].Building!==undefined||M[v].Floor!==""&&M[v].Floor!==undefined||M[v].Roomnum!==""&&M[v].Roomnum!==undefined||M[v].AddrLocation!==""&&M[v].AddrLocation!==undefined||M[v].Strsuppl1!==""&&M[v].Strsuppl1!==undefined||M[v].Strsuppl2!==""&&M[v].Strsuppl2!==undefined||M[v].Strsuppl3!==""&&M[v].Strsuppl3!==undefined||M[v].TimeZone!==""&&M[v].TimeZone!==undefined||M[v].RefPosta!==""&&M[v].RefPosta!==undefined||M[v].Region!==""&&M[v].Region!==undefined){var b={Funcloc:M[v].Functionallocation,Title:M[v].TitleCode,Name1:M[v].Name1,Name2:M[v].Name2,Name3:M[v].Name3,Name4:M[v].Name4,Sort1:M[v].Sort1,Sort2:M[v].Sort2,NameCo:M[v].NameCo,PostCod1:M[v].PostCod1,City1:M[v].City1,Building:M[v].Building,Floor:M[v].Floor,Roomnum:M[v].Roomnum,Strsuppl1:M[v].Strsuppl1,Strsuppl2:M[v].Strsuppl2,Strsuppl3:M[v].Strsuppl3,Location:M[v].AddrLocation,RPostafl:M[v].RefPosta,Landx:M[v].Landx,TimeZone:M[v].TimeZone,RPostFl:M[v].Region,Regiotxt:M[v].RegionDesc};F.FLAddr.push(b);if(a&&M[v].Functionallocation===g){S=b}}var N=M[v].intlAddr;if(N.length>0){for(var T=0;T<N.length;T++){N[T].Funcloc=M[v].Functionallocation;F.FLAddrI.push(N[T])}if(a&&M[v].Functionallocation===g){h=F.FLAddrI}}if(l.AltLblDerv==="2"&&M[v].altlbl.length>0){for(var w=0;w<M[v].altlbl.length;w++){var I={Funcloc:M[v].Functionallocation,AltAlkey:M[v].altlbl[w].AltAlkey,AltStrno:M[v].altlbl[w].AltStrno,AltTplkz:M[v].altlbl[w].AltTplkz};F.FLALTLBEL.push(I)}}if(M[v].lam){var P={Funcloc:M[v].Functionallocation,Lrpid:M[v].lam.Lrpid,Strtptatr:M[v].lam.Strtptatr,Endptatr:M[v].lam.Endptatr,Length:M[v].lam.Length,LinUnit:M[v].lam.LinUnit,Startmrkr:M[v].lam.Startmrkr,Endmrkr:M[v].lam.Endmrkr,Mrkdisst:M[v].lam.Mrkdisst,Mrkdisend:M[v].lam.Mrkdisend,MrkrUnit:M[v].lam.MrkrUnit,LamDer:M[v].lam.LamDer}}if(P){if(e&&M[v].Functionallocation===g){m=P;P.LamDer="D"}F.FLLAM.push(P)}var y=M[v].classItems;if(y){if(y.length>0){for(var x=0;x<y.length;x++){var k={Funcloc:M[v].Functionallocation,Classtype:y[x].Classtype,Class:y[x].Class,Clstatus1:y[x].Clstatus1,Artxt:y[x].ClassTypeDesc};F.FLClass.push(k)}}}var E=M[v].characteristics;if(E){if(E.length>0){for(var O=0;O<E.length;O++){var R={Funcloc:M[v].Functionallocation,Atnam:E[O].Atnam,Textbez:E[O].Textbez,Atwrt:E[O].Atwrt,Class:E[O].Class};F.FLVal.push(R)}}}var B=M[v].linearChar;if(B){if(B.length>0){var H=$.map(B,function(e){return $.extend(true,{},e)});for(var O=0;O<H.length;O++){delete H[O].linCharEnable;H[O].Funcloc=M[v].Functionallocation;F.FLLAMCH.push(H[O])}}}}}var W=function(o){if(o.Messages.results.length>0){var r=[];for(var u=0;u<o.Messages.results.length;u++){r.push({type:i.getMessageType(o.Messages.results[u].Type),title:o.Messages.results[u].Message})}l.createMessagePopover(r,"");d.viewBusy=false;s.setData(d);return}if(o.FuncLoc.results.length>0){for(var F=0;F<o.FuncLoc.results.length;F++){var M=o.FuncLoc.results[F];var v={intlAddr:[],altlbl:[],classItems:[],characteristics:[],linearChar:[],FunctionallocationVS:"None",FunctionallocationVST:"",FlocdescriptionVS:"None",FlocdescriptionVST:"",StrucindicatorVS:"None",StrucindicatorVST:"",FloccategoryVS:"None",FloccategoryVST:"",SupFunctionallocationVS:"None",SupFunctionallocationVST:"",MaintplantVS:"None",MaintplantVST:"",StsmEquiVS:"None",StsmEquiVST:"",UstwEquiVS:"None",UstwEquiVST:"",UswoEquiVS:"None",UswoEquiVST:"",TechnicalObjectTypVS:"None",TechnicalObjectTypVST:"",LocationVS:"None",LocationVST:"",AbckzVS:"None",AbckzVST:"",MainArbplVS:"None",MainArbplVST:"",BeberFlVS:"None",BeberFlVST:"",BukrsVS:"None",BukrsVST:"",KostlVS:"None",KostlVST:"",WerksVS:"None",WerksVST:"",IngrpVS:"None",IngrpVST:"",ArbplVS:"None",ArbplVST:"",ConstrTypeVS:"None",ConstrTypeVST:"",RefPostaVS:"None",RefPostaVST:"",LangucodeVS:"None",LangucodeVST:"",TimeZoneVS:"None",TimeZoneVST:"",TplnrEnabled:true,FunctionalLocEnabled:true,FlocCatEnabled:true,StrucIndEnabled:true,MaintplantEnabled:true,BukrsEnabled:true};v.Functionallocation=M.Tplnr;v.Flocdescription=M.Txtmi;v.EditMask=M.EditMask;v.Hierarchy=M.Hierarchy;v.Floccategory=M.Fltyp;v.FlocCategoryDesc=M.Flttx;v.Strucindicator=M.TplkzFlc;v.StrucIndicatorDesc=M.Tplxt;v.SupFunctionallocation=M.Tplma;v.SupFlocdescription=M.Supflocdesc;v.Stattext=M.Stattext;v.StsmEqui=M.StsmFloc;v.StsmEquiDesc=M.Statproftxt;v.UstwEqui=M.UstwFloc;v.UswoEqui=M.UswoFloc;v.UstaEqui=M.UstaFloc;v.TechnicalObjectTyp=M.Eqart;v.Description=M.Eartx;v.Maintplant=M.Swerk;v.MaintplantDesc=M.Plantname;v.Location=M.StorFloc;v.Locationdesc=M.Locationdesc;v.BeberFl=M.BeberFl;v.Fing=M.Fing;v.Tele=M.Tele;v.Arbpl=M.Arbplfloc;v.Ktext=M.Workcenterdesc;v.WcWerks=M.Wergwfloc;v.MainArbpl=M.Gewrkfloc;v.MainKtext=M.MainWcDesc;v.MainWerks=M.MainWcPlant;v.Abckz=M.Abckzfloc;v.Abctx=M.Abctx;v.Bukrs=M.Bukrsfloc;v.Butxt=M.Butxt;v.City=M.City;v.Kostl=M.KostFloc;v.Kokrs=M.KokrFloc;v.Mctxt=M.Contareaname;v.Werks=M.PlntFloc;v.Planningplantdes=M.Planningplantdes;v.Ingrp=M.Ingrp;v.Innam=M.Plannergrpdesc;v.ConstrType=M.Submtiflo;v.ConstructionDesc=M.Constdesc;v.menuAction=M.IsMenu;v.Adrnr=M.Adrnr;v.Adrnri=M.Adrnri;v.Deact=M.Deact;v.Alkey=M.Alkey;v.Altxt=M.Altxt;v.Modeldesc=M.Modeldesc;v.Modelref=M.Modelref;v.Modelrver=M.Modelrver;v.Modelext=M.Modelext;v.Modelname=M.Modelname;v.Modelver=M.Modelver;if(a&&v.Functionallocation===g){l.flHeader=o.FuncLoc.results[F];v.Maintplant=f.Maintplant;v.MaintplantDesc=f.MaintplantDesc;v.Bukrs=f.Bukrs;v.Butxt=f.Butxt;v.Location=f.Location;v.Locationdesc=f.Locationdesc;v.Abckz=f.Abckz;v.Abctx=f.Abctx;v.Kostl=f.Kostl;v.Kokrs=f.Kokrs;v.Mctxt=f.Mctxt;v.Werks=f.Werks;v.Planningplantdes=f.Planningplantdes;v.Ingrp=f.Ingrp;v.Innam=f.Innam;v.MainArbpl=f.MainArbpl;v.MainKtext=f.MainKtext;v.MainWerks=f.MainWerks;v.BeberFl=f.BeberFl;v.Fing=f.Fing;v.Tele=f.Tele;v.Stattext=f.Stattext}if(M.Type===true){v.viewParameter="create"}if(M.Type===false){v.viewParameter="change";if(v.Floccategory===""||v.Floccategory===undefined){v.FlocCatEnabled=true}else{v.FlocCatEnabled=false}if(v.Strucindicator===""||v.Strucindicator===undefined){v.StrucIndEnabled=true}else{v.StrucIndEnabled=false}v.FunctionalLocEnabled=false}if(M.Swerk!==""){v.BukrsEnabled=false}else{v.MaintplantEnabled=true;v.BukrsEnabled=true}if(o.FLLAM.results.length>0){var L=o.FLLAM.results;for(var C=0;C<L.length;C++){if(L[C].Funcloc===v.Functionallocation){var V={Funcloc:L[C].Funcloc,Lrpid:L[C].Lrpid,LrpidDesc:L[C].LrpDescr,Strtptatr:L[C].Strtptatr,Endptatr:L[C].Endptatr,Length:L[C].Length,LinUnit:L[C].LinUnit,LinUnitDesc:L[C].Uomtext,Startmrkr:L[C].Startmrkr,Endmrkr:L[C].Endmrkr,Mrkdisst:L[C].Mrkdisst,Mrkdisend:L[C].Mrkdisend,MrkrUnit:L[C].MrkrUnit};v.lam=V;break}}}if(a&&v.Functionallocation===g&&v.Floccategory==="L"){v.lam=m;if(o.FLLAM.results.length>0){l.flLAM=o.FLLAM.results}}if(o.FLAddr){if(o.FLAddr.results){var A=o.FLAddr.results;if(A){if(A.length>0){for(var D=0;D<A.length;D++){if(v.Functionallocation===A[D].Funcloc){var b=sap.ui.getCore().getModel("flocAddressView");var N=b.getData();var T=true;var w,I;if(N.length>0){for(var P=0;P<N.length;P++){if(v.Functionallocation===N[P].Functionallocation){T=false;I=P;break}}}if(T&&v.SupFunctionallocation!==""&&v.SupFunctionallocation!==undefined){w={Functionallocation:v.Functionallocation,IsEditable:A[D].IsEditable};N.push(w);b.setData(N)}if(!T&&v.SupFunctionallocation!==""&&v.SupFunctionallocation!==undefined){N[I].Functionallocation=v.Functionallocation;N[I].IsEditable=A[D].IsEditable;b.setData(N)}v.IsEditable=A[D].IsEditable;v.Title=A[D].Titletxt?A[D].Titletxt:"";v.TitleCode=A[D].Title?A[D].Title:"";v.Name1=A[D].Name1?A[D].Name1:"";v.Name2=A[D].Name2?A[D].Name2:"";v.Name3=A[D].Name3?A[D].Name3:"";v.Name4=A[D].Name4?A[D].Name4:"";v.Sort1=A[D].Sort1?A[D].Sort1:"";v.Sort2=A[D].Sort2?A[D].Sort2:"";v.NameCo=A[D].NameCo?A[D].NameCo:"";v.PostCod1=A[D].PostCod1?A[D].PostCod1:"";v.City1=A[D].City1?A[D].City1:"";v.Building=A[D].Building?A[D].Building:"";v.Floor=A[D].Floor?A[D].Floor:"";v.Roomnum=A[D].Roomnum?A[D].Roomnum:"";v.Strsuppl1=A[D].Strsuppl1?A[D].Strsuppl1:"";v.Strsuppl2=A[D].Strsuppl2?A[D].Strsuppl2:"";v.Strsuppl3=A[D].Strsuppl3?A[D].Strsuppl3:"";v.AddrLocation=A[D].Location?A[D].Location:"";v.RefPosta=A[D].RPostafl?A[D].RPostafl:"";v.Landx=A[D].Landx?A[D].Landx:"";v.TimeZone=A[D].TimeZone?A[D].TimeZone:"";v.Region=A[D].RPostFl?A[D].RPostFl:"";v.RegionDesc=A[D].Regiotxt?A[D].Regiotxt:""}}}else{v.Title=v.Title?v.Title:"";v.TitleCode=v.TitleCode?v.TitleCode:"";v.Name1=v.Name1?v.Name1:"";v.Name2=v.Name2?v.Name2:"";v.Name3=v.Name3?v.Name3:"";v.Name4=v.Name4?v.Name4:"";v.Sort1=v.Sort1?v.Sort1:"";v.Sort2=v.Sort2?v.Sort2:"";v.NameCo=v.NameCo?v.NameCo:"";v.PostCod1=v.PostCod1?v.PostCod1:"";v.City1=v.City1?v.City1:"";v.Building=v.Building?v.Building:"";v.Floor=v.Floor?v.Floor:"";v.Roomnum=v.Roomnum?v.Roomnum:"";v.Strsuppl1=v.Strsuppl1?v.Strsuppl1:"";v.Strsuppl2=v.Strsuppl2?v.Strsuppl2:"";v.Strsuppl3=v.Strsuppl3?v.Strsuppl3:"";v.AddrLocation=v.AddrLocation?v.AddrLocation:"";v.RefPosta=v.RefPosta?v.RefPosta:"";v.Landx=v.Landx?v.Landx:"";v.TimeZone=v.TimeZone?v.TimeZone:"";v.Region=v.Region?v.Region:"";v.RegionDesc=v.RegionDesc?v.RegionDesc:""}}}}if(a&&v.Functionallocation===g){var b=sap.ui.getCore().getModel("flocAddressView");var N=b.getData();var T=true;var w,I;if(N.length>0){for(var P=0;P<N.length;P++){if(v.Functionallocation===N[P].Functionallocation){T=false;I=P;break}}}if(T&&v.SupFunctionallocation!==""&&v.SupFunctionallocation!==undefined){w={Functionallocation:v.Functionallocation,IsEditable:S.IsEditable};N.push(w);b.setData(N)}if(!T&&v.SupFunctionallocation!==""&&v.SupFunctionallocation!==undefined){N[I].Functionallocation=v.Functionallocation;N[I].IsEditable=v.IsEditable;b.setData(N)}v.IsEditable=S.IsEditable;v.Title=S.Titletxt?S.Titletxt:"";v.TitleCode=S.Title?S.Title:"";v.Name1=S.Name1?S.Name1:"";v.Name2=S.Name2?S.Name2:"";v.Name3=S.Name3?S.Name3:"";v.Name4=S.Name4?S.Name4:"";v.Sort1=S.Sort1?S.Sort1:"";v.Sort2=S.Sort2?S.Sort2:"";v.NameCo=S.NameCo?S.NameCo:"";v.PostCod1=S.PostCod1?S.PostCod1:"";v.City1=S.City1?S.City1:"";v.Building=S.Building?S.Building:"";v.Floor=S.Floor?S.Floor:"";v.Roomnum=S.Roomnum?S.Roomnum:"";v.Strsuppl1=S.Strsuppl1?S.Strsuppl1:"";v.Strsuppl2=S.Strsuppl2?S.Strsuppl2:"";v.Strsuppl3=S.Strsuppl3?S.Strsuppl3:"";v.AddrLocation=S.Location?S.Location:"";v.RefPosta=S.RPostafl?S.RPostafl:"";v.Landx=S.Landx?S.Landx:"";v.TimeZone=S.TimeZone?S.TimeZone:"";v.Region=S.RPostFl?S.RPostFl:"";v.RegionDesc=S.Regiotxt?S.Regiotxt:"";if(o.FLAddr.results){l.flAddr=o.FLAddr.results}}var y=o.FLAddrI.results;if(y.length>0){for(var x=0;x<y.length;x++){if(y[x].Funcloc===v.Functionallocation){y[x].AdNationEnable=false;y[x].City1iVS="None";y[x].StreetiVS="None";v.intlAddr.push(y[x])}}}if(a&&v.Functionallocation===g&&v.intlAddr.length>0){l.flIntlAddr=v.intlAddr;v.intlAddr=h}else{l.flIntlAddr=[]}var k=o.FLALTLBEL.results;if(k.length>0){for(var E=0;E<k.length;E++){if(k[E].Funcloc===v.Functionallocation){var O={Funcloc:M.Tplnr,AltAlkey:k[E].AltAlkey,Altxt:k[E].Altxt,AltStrno:k[E].AltStrno,AltTplkz:k[E].AltTplkz,Tplxt:k[E].Tplxt,Name1i:k[E].Editm,Actvs:k[E].Actvs,AltPrkey:k[E].AltPrkey,AltReuse:k[E].AltReuse,enableLblSys:false,enableAltLbl:true,enableStrInd:true,LblSysVS:"None",AltLblVS:"None",StrIndVS:"None"};v.altlbl.push(O)}}}if(o.FLClass){var R=o.FLClass.results;if(R){if(R.length>0){for(var B=0;B<R.length;B++){if(v.Functionallocation===R[B].Funcloc){R[B].ctEnable=false;R[B].classEnable=false;R[B].ClassTypeDesc=R[B].Artxt;delete R[B].Artxt;R[B].ClassDesc=R[B].Kltxt;delete R[B].Kltxt;delete R[B].Changerequestid;delete R[B].Clint;delete R[B].Service;v.classItems.push(R[B])}}if(v.Functionallocation===""){var H=[];v.classItems=v.classItems.filter(function(e){if(H.indexOf(e.Classtype+e.Class+e.Funcloc)===-1){H.push(e.Classtype+e.Class+e.Funcloc);return true}return false})}v.charNewButton=true;if(l.class&&l.class.getId().includes("detailFloc")===true){l.class.setModel(new t(v.classItems))}}}}if(o.FLVal){var W=o.FLVal.results;if(W){if(W.length>0){for(var D=0;D<W.length;D++){if(v.Functionallocation===W[D].Funcloc){W[D].cNameEnable=false;W[D].Textbz=W[D].Atwtb;delete W[D].Ataut;delete W[D].Ataw1;delete W[D].Atawe;delete W[D].Atcod;delete W[D].Atflb;delete W[D].Atflv;delete W[D].Atimb;delete W[D].Atsrt;delete W[D].Atvglart;delete W[D].Atzis;delete W[D].Changerequestid;delete W[D].CharName;delete W[D].Charid;delete W[D].Classtype;delete W[D].Service;delete W[D].Valcnt;W[D].slNo=D+1;W[D].flag=W[D].Class+"-"+W[D].slNo;v.characteristics.push(W[D])}}if(v.Functionallocation===""){var H=[];v.characteristics=v.characteristics.filter(function(e){if(H.indexOf(e.Class+e.Atnam+e.Atwrt)===-1){H.push(e.Class+e.Atnam+e.Atwrt);return true}return false})}for(var x=0;x<v.characteristics.length;x++){var U=1;for(var E=0;E<v.characteristics.length;E++){if(x===E){continue}if(v.characteristics[E].Atnam===v.characteristics[x].Atnam&&v.characteristics[E].Class===v.characteristics[x].Class){U++}}if(U>1){v.characteristics[x].charDltEnable=true}else{v.characteristics[x].charDltEnable=false}if(v.characteristics[x].Atein===true){v.characteristics[x].charAddEnable=false}}if(l.char&&l.char.getId().includes("detailFloc")===true){l.char.setModel(new t(v.characteristics))}}}}if(o.FLLAMCH){var q=o.FLLAMCH.results;if(q){if(q.length>0){for(var D=0;D<q.length;D++){if(v.Functionallocation===q[D].Funcloc){q[D].linCharEnable=true;v.linearChar.push(q[D])}}if(v.Functionallocation===""){var H=[];v.linearChar=v.linearChar.filter(function(e){if(H.indexOf(e.Charid+e.Atwrt)===-1){H.push(e.Charid+e.Atwrt);return true}return false})}}}}if(v.UstaEqui){d.visible=true}else{d.visible=false}s.setData(d);p.push(v)}c.setData(p);for(var K=0;K<c.getData().length;K++){if(g===c.getData()[K].Functionallocation){l.rowIndex="/"+K;var z=new t;var _=c.getProperty(l.rowIndex);_.Title=_.Title?_.Title:"";_.TitleCode=_.TitleCode?_.TitleCode:"";_.Name1=_.Name1?_.Name1:"";_.Name2=_.Name2?_.Name2:"";_.Name3=_.Name3?_.Name3:"";_.Name4=_.Name4?_.Name4:"";_.Sort1=_.Sort1?_.Sort1:"";_.Sort2=_.Sort2?_.Sort2:"";_.NameCo=_.NameCo?_.NameCo:"";_.PostCod1=_.PostCod1?_.PostCod1:"";_.City1=_.City1?_.City1:"";_.Building=_.Building?_.Building:"";_.Floor=_.Floor?_.Floor:"";_.Roomnum=_.Roomnum?_.Roomnum:"";_.Strsuppl1=_.Strsuppl1?_.Strsuppl1:"";_.Strsuppl2=_.Strsuppl2?_.Strsuppl2:"";_.Strsuppl3=_.Strsuppl3?_.Strsuppl3:"";_.AddrLocation=_.AddrLocation?_.AddrLocation:"";_.RefPosta=_.RefPosta?_.RefPosta:"";_.Landx=_.Landx?_.Landx:"";_.TimeZone=_.TimeZone?_.TimeZone:"";_.Region=_.Region?_.Region:"";_.RegionDesc=_.RegionDesc?_.RegionDesc:"";if(_.Title!==""&&_.Title!==undefined||_.TitleCode!==""&&_.TitleCode!==undefined||_.Name1!==""&&_.Name1!==undefined||_.Name2!==""&&_.Name2!==undefined||_.Name3!==""&&_.Name3!==undefined||_.Name4!==""&&_.Name4!==undefined||_.Sort1!==""&&_.Sort1!==undefined||_.Sort2!==""&&_.Sort2!==undefined||_.NameCo!==""&&_.NameCo!==undefined||_.PostCod1!==""&&_.PostCod1!==undefined||_.City1!==""&&_.City1!==undefined||_.Building!==""&&_.Building!==undefined||_.Floor!==""&&_.Floor!==undefined||_.Roomnum!==""&&_.Roomnum!==undefined||_.AddrLocation!==""&&_.AddrLocation!==undefined||_.Strsuppl1!==""&&_.Strsuppl1!==undefined||_.Strsuppl2!==""&&_.Strsuppl2!==undefined||_.Strsuppl3!==""&&_.Strsuppl3!==undefined||_.TimeZone!==""&&_.TimeZone!==undefined||_.RefPosta!==""&&_.RefPosta!==undefined||_.Region!==""&&_.Region!==undefined){_.RefPostaLblReq=true;var Z=l.getView().getModel("flocAddressView");var j=Z.getData();j.enabled=_.IsEditable;Z.setData(j)}z.setData(_);l.getView().setModel(z,l.oModelName);l.lam.setModel(z,"AIWLAM");var G=[z.getData()];var J=$.map(G,function(e){return $.extend(true,{},e)});var X=new t;X.setData(J);l.getView().setModel(X,"SUP_FLOC_DATA");var Q=sap.ui.getCore().getModel("SUP_FLOC_DATA");var Y=Q.getData();var ee=true;for(var te=0;te<Y.length;te++){if(_.Functionallocation===Y[te].Functionallocation){ee=false}}if(ee&&_.SupFunctionallocation!==""&&_.SupFunctionallocation!==undefined){Y.push(J[0]);Q.setData(Y)}d.viewBusy=false;s.setData(d);break}}}d.viewBusy=false;s.setData(d);if(a){l.functionalLocation=e;l.functionalLocDesc=n;l.getView().getModel("dataOrigin").setProperty("/originDerive",o);l.openDoiView(undefined,o)}else{var ae=sap.ui.getCore().getModel("dataOriginMOP").getData().FL;for(var F=0;F<o.FuncLoc.results.length;F++){var M=o.FuncLoc.results[F];for(var x=0;x<ae.length;x++){if(M.Tplnr===ae[x].key){var ie=ae[x].DOI;if(M.Swerki===""){ie[0].maintenance=false;ie[0].instLoc=false;ie[0].SupFlVal="";ie[0].currentVal="";ie[0].targetVal=""}else if(M.Swerki==="D"){ie[0].maintenance=true;ie[0].instLoc=false;ie[0].SupFlVal="";ie[0].currentVal=M.Swerk;ie[0].targetVal=M.Swerk}else{ie[0].maintenance=false;ie[0].instLoc=true;ie[0].SupFlVal=M.Swerk;ie[0].currentVal="";ie[0].targetVal=M.Swerk}if(M.Storti===""){ie[1].maintenance=false;ie[1].instLoc=false;ie[1].SupFlVal="";ie[1].currentVal="";ie[1].targetVal=""}else if(M.Storti==="D"){ie[1].maintenance=true;ie[1].instLoc=false;ie[1].SupFlVal="";ie[1].currentVal=M.StorFloc;ie[1].targetVal=M.StorFloc}else{ie[1].maintenance=false;ie[1].instLoc=true;ie[1].SupFlVal=M.StorFloc;ie[1].currentVal="";ie[1].targetVal=M.StorFloc}if(M.Beberi===""){ie[2].maintenance=false;ie[2].instLoc=false;ie[2].SupFlVal="";ie[2].currentVal="";ie[2].targetVal=""}else if(M.Beberi==="D"){ie[2].maintenance=true;ie[2].instLoc=false;ie[2].SupFlVal="";ie[2].currentVal=M.BeberFl;ie[2].targetVal=M.BeberFl}else{ie[2].maintenance=false;ie[2].instLoc=true;ie[2].SupFlVal=M.BeberFl;ie[2].currentVal="";ie[2].targetVal=M.BeberFl}if(M.Ppsidi===""){ie[3].maintenance=false;ie[3].instLoc=false;ie[3].SupFlVal="";ie[3].currentVal="";ie[3].targetVal=""}else if(M.Ppsidi==="D"){ie[3].maintenance=true;ie[3].instLoc=false;ie[3].SupFlVal="";ie[3].currentVal=M.Arbplfloc;ie[3].targetVal=M.Arbplfloc}else{ie[3].maintenance=false;ie[3].instLoc=true;ie[3].SupFlVal=M.Arbplfloc;ie[3].currentVal="";ie[3].targetVal=M.Arbplfloc}if(M.Abckzi===""){ie[4].maintenance=false;ie[4].instLoc=false;ie[4].SupFlVal="";ie[4].currentVal="";ie[4].targetVal=""}else if(M.Abckzi==="D"){ie[4].maintenance=true;ie[4].instLoc=false;ie[4].SupFlVal="";ie[4].currentVal=M.Abckzfloc;ie[4].targetVal=M.Abckzfloc}else{ie[4].maintenance=false;ie[4].instLoc=true;ie[4].SupFlVal=M.Abckzfloc;ie[4].currentVal="";ie[4].targetVal=M.Abckzfloc}if(M.Bukrsi===""){ie[5].maintenance=false;ie[5].instLoc=false;ie[5].SupFlVal="";ie[5].currentVal="";ie[5].targetVal=""}else if(M.Bukrsi==="D"){ie[5].maintenance=true;ie[5].instLoc=false;ie[5].SupFlVal="";ie[5].currentVal=M.Bukrsfloc;ie[5].targetVal=M.Bukrsfloc}else{ie[5].maintenance=false;ie[5].instLoc=true;ie[5].SupFlVal=M.Bukrsfloc;ie[5].currentVal="";ie[5].targetVal=M.Bukrsfloc}if(M.Kostli===""){ie[6].maintenance=false;ie[6].instLoc=false;ie[6].SupFlVal="";ie[6].currentVal="";ie[6].targetVal=""}else if(M.Kostli==="D"){ie[6].maintenance=true;ie[6].instLoc=false;ie[6].SupFlVal="";ie[6].currentVal=M.KostFloc;ie[6].targetVal=M.KostFloc}else{ie[6].maintenance=false;ie[6].instLoc=true;ie[6].SupFlVal=M.KostFloc;ie[6].currentVal="";ie[6].targetVal=M.KostFloc}if(M.Kokrsi===""){ie[7].maintenance=false;ie[7].instLoc=false;ie[7].SupFlVal="";ie[7].currentVal="";ie[7].targetVal=""}else if(M.Kokrsi==="D"){ie[7].maintenance=true;ie[7].instLoc=false;ie[7].SupFlVal="";ie[7].currentVal=M.KokrFloc;ie[7].targetVal=M.KokrFloc}else{ie[7].maintenance=false;ie[7].instLoc=true;ie[7].SupFlVal=M.KokrFloc;ie[7].currentVal="";ie[7].targetVal=M.KokrFloc}if(M.Iwerki===""){ie[8].maintenance=false;ie[8].instLoc=false;ie[8].SupFlVal="";ie[8].currentVal="";ie[8].targetVal=""}else if(M.Iwerki==="D"){ie[8].maintenance=true;ie[8].instLoc=false;ie[8].SupFlVal="";ie[8].currentVal=M.PlntFloc;ie[8].targetVal=M.PlntFloc}else{ie[8].maintenance=false;ie[8].instLoc=true;ie[8].SupFlVal=M.PlntFloc;ie[8].currentVal="";ie[8].targetVal=M.PlntFloc}if(M.Ingrpi===""){ie[9].maintenance=false;ie[9].instLoc=false;ie[9].SupFlVal="";ie[9].currentVal="";ie[9].targetVal=""}else if(M.Ingrpi==="D"){ie[9].maintenance=true;ie[9].instLoc=false;ie[9].SupFlVal="";ie[9].currentVal=M.Ingrp;ie[9].targetVal=M.Ingrp}else{ie[9].maintenance=false;ie[9].instLoc=true;ie[9].SupFlVal=M.Ingrp;ie[9].currentVal="";ie[9].targetVal=M.Ingrp}if(M.Lgwidi===""){ie[10].maintenance=false;ie[10].instLoc=false;ie[10].SupFlVal="";ie[10].currentVal="";ie[10].targetVal=""}else if(M.Lgwidi==="D"){ie[10].maintenance=true;ie[10].instLoc=false;ie[10].SupFlVal="";ie[10].currentVal=M.Gewrkfloc;ie[10].targetVal=M.Gewrkfloc}else{ie[10].maintenance=false;ie[10].instLoc=true;ie[10].SupFlVal=M.Gewrkfloc;ie[10].currentVal="";ie[10].targetVal=M.Gewrkfloc}if(M.Adrnri===""){ie[12].maintenance=false;ie[12].instLoc=false;ie[12].SupFlVal="";ie[12].currentVal="";ie[12].targetVal=""}else if(M.Adrnri==="D"){ie[12].maintenance=true;ie[12].instLoc=false;ie[12].SupFlVal="";ie[12].currentVal=M.Adrnr;ie[12].targetVal=M.Adrnr}else{ie[12].maintenance=false;ie[12].instLoc=true;ie[12].SupFlVal=M.Adrnr;ie[12].currentVal="";ie[12].targetVal=M.Adrnr}}}}}};var U=function(e){var t=[];if(JSON.parse(e.responseText).error.innererror.errordetails===undefined||JSON.parse(e.responseText).error.innererror.errordetails.length===0){t[0]=JSON.parse(e.responseText).error.message.value}else{for(var a=0;a<JSON.parse(e.responseText).error.innererror.errordetails.length;a++){t[a]=JSON.parse(e.responseText).error.innererror.errordetails[a].message}}var i=t.join("\n");d.viewBusy=false;s.setData(d);l.invokeMessage(i)};d.viewBusy=true;s.setData(d);if(F.FLAddrI.length>0){F.FLAddrI=$.map(F.FLAddrI,function(e){return $.extend(true,{},e)});for(var q=0;q<F.FLAddrI.length>0;q++){delete F.FLAddrI[q].AdNationEnable;delete F.FLAddrI[q].City1iVS;delete F.FLAddrI[q].StreetiVS}}r.create(o,F,{success:W,error:U})},readSupFlocDetailsChange:function(e,a,i){var n=this;var l="/ChangeRequestSet";var o=n.getView().getModel();var r=n.getView().getModel("mainView");var s=r.getData();var d=sap.ui.getCore().getModel("AIWFLOC").getData();var c=n.getView().getModel(n.oModelName);var u=c.getData().Functionallocation;var g=[];var p={};var f={};var m={};var S=[];var h={ChangeRequestType:"AIWEAM0P",CrDescription:"",Reason:"01",DeriveData:true,FuncLoc:[],FLAddr:[],FLAddrI:[],FLALTLBEL:[],FLLAM:[],FLClass:[],FLVal:[],Equipment:[],EqAddr:[],EqAddrI:[],EqPRT:[],EqLAM:[],EqClass:[],EqVal:[],MSPoint:[],MSLAM:[],MSClass:[],MSVal:[],MPLAN:[],MPItem:[],MPLAM:[],MPOBList:[],MPCycle:[],MRBHeader:[],MRBItem:[],MRBSBIT:[],EBHeader:[],EBItem:[],EBSBIT:[],FBHeader:[],FBItem:[],FBSBIT:[],WBHeader:[],WBItem:[],WBSBIT:[],ONetwork:[],ONLAM:[],Workcenter:[],WCCost:[],GTList:[],GTOprs:[],GTComp:[],GTClass:[],GTVal:[],ETList:[],ETOprs:[],ETComp:[],ETClass:[],ETVal:[],FTList:[],FTOprs:[],FTComp:[],FTClass:[],FTVal:[],Olink:[],OLClass:[],OLVal:[],Messages:[],FLDOI:[]};if(d.length>0){for(var F=0;F<d.length;F++){var M={Tplnr:d[F].Functionallocation,Txtmi:d[F].Flocdescription,TplkzFlc:d[F].Strucindicator,Tplxt:d[F].StrucIndicatorDesc,EditMask:d[F].EditMask,Hierarchy:d[F].Hierarchy,Fltyp:d[F].Floccategory,Flttx:d[F].FlocCategoryDesc,Swerk:d[F].Maintplant,Plantname:d[F].MaintplantDesc,StorFloc:d[F].Location,Locationdesc:d[F].Locationdesc,Abckzfloc:d[F].Abckz,Abctx:d[F].Abctx,Bukrsfloc:d[F].Bukrs,Butxt:d[F].Butxt,City:d[F].City,KostFloc:d[F].Kostl,KokrFloc:d[F].Kokrs,Contareaname:d[F].Mctxt,PlntFloc:d[F].Werks,Planningplantdes:d[F].Planningplantdes,Ingrp:d[F].Ingrp,Plannergrpdesc:d[F].Innam,Arbplfloc:d[F].Arbpl,Wergwfloc:d[F].WcWerks,Gewrkfloc:d[F].MainArbpl,MainWcPlant:d[F].MainWerks,Tplma:d[F].SupFunctionallocation,Supflocdesc:d[F].SupFlocdescription,BeberFl:d[F].BeberFl,Fing:d[F].Fing,Tele:d[F].Tele,Submtiflo:d[F].ConstrType,Constdesc:d[F].ConstructionDesc,Eqart:d[F].TechnicalObjectTyp,Eartx:d[F].Description,Stattext:d[F].Stattext,StsmFloc:d[F].StsmEqui,Statproftxt:d[F].StsmEquiDesc,UstwFloc:d[F].UstwEqui,UswoFloc:d[F].UswoEqui,UstaFloc:d[F].UstaEqui,Adrnr:d[F].Adrnr,Adrnri:d[F].Adrnri,Deact:d[F].Deact,Alkey:d[F].Alkey,Modeldesc:d[F].Modeldesc,Modelref:d[F].Modelref,Modelrver:d[F].Modelrver,Modelext:d[F].Modelext,Modelname:d[F].Modelname,Modelver:d[F].Modelver};var v=sap.ui.getCore().getModel("dataOriginMOP").getData().FL;if(v&&v.length>0){var L=v[F].DOI;M.Swerki=L[0].instLoc?"H":"D";M.Storti=L[1].instLoc?"H":"D";M.Beberi=L[2].instLoc?"H":"D";M.Ppsidi=L[3].instLoc?"H":"D";M.Abckzi=L[4].instLoc?"H":"D";M.Bukrsi=L[5].instLoc?"H":"D";M.Kostli=L[6].instLoc?"H":"D";M.Kokrsi=L[7].instLoc?"H":"D";M.Iwerki=L[8].instLoc?"H":"D";M.Ingrpi=L[9].instLoc?"H":"D";M.Lgwidi=L[10].instLoc?"H":"D";M.Adrnri=L[12].instLoc?"H":"D"}h.FuncLoc.push(M);var C={Funcloc:d[F].Functionallocation,Title:d[F].TitleCode,Name1:d[F].Name1,Name2:d[F].Name2,Name3:d[F].Name3,Name4:d[F].Name4,Sort1:d[F].Sort1,Sort2:d[F].Sort2,NameCo:d[F].NameCo,PostCod1:d[F].PostCod1,City1:d[F].City1,Building:d[F].Building,Floor:d[F].Floor,Roomnum:d[F].Roomnum,Strsuppl1:d[F].Strsuppl1,Strsuppl2:d[F].Strsuppl2,Strsuppl3:d[F].Strsuppl3,Location:d[F].AddrLocation,RPostafl:d[F].RefPosta,Landx:d[F].Landx,TimeZone:d[F].TimeZone,RPostFl:d[F].Region,Regiotxt:d[F].RegionDesc};h.FLAddr.push(C);var V=d[F].intlAddr;if(V.length>0){for(var A=0;A<V.length;A++){h.FLAddrI.push(V[A])}}if(n.AltLblDerv==="2"&&d[F].altlbl.length>0){for(var D=0;D<d[F].altlbl.length;D++){var b={Funcloc:d[F].Functionallocation,AltAlkey:d[F].altlbl[D].AltAlkey,AltStrno:d[F].altlbl[D].AltStrno,AltTplkz:d[F].altlbl[D].AltTplkz};h.FLALTLBEL.push(b)}}if(d[F].Floccategory==="L"){var N={Funcloc:d[F].Functionallocation,Lrpid:d[F].lam.Lrpid,Strtptatr:d[F].lam.Strtptatr,Endptatr:d[F].lam.Endptatr,Length:d[F].lam.Length,LinUnit:d[F].lam.LinUnit,Startmrkr:d[F].lam.Startmrkr,Endmrkr:d[F].lam.Endmrkr,Mrkdisst:d[F].lam.Mrkdisst,Mrkdisend:d[F].lam.Mrkdisend,MrkrUnit:d[F].lam.MrkrUnit};h.FLLAM.push(N)}var T=d[F].classItems;if(T){if(T.length>0){for(var w=0;w<T.length;w++){var I={Funcloc:d[F].Functionallocation,Classtype:T[w].Classtype,Class:T[w].Class,Clstatus1:T[w].Clstatus1};h.FLClass.push(I)}}}var P=d[F].characteristics;if(P){if(P.length>0){for(var y=0;y<P.length;y++){var x={Funcloc:d[F].Functionallocation,Atnam:P[y].Atnam,Textbez:P[y].Textbez,Atwrt:P[y].Atwrt,Class:P[y].Class};h.FLVal.push(x)}}}}}var k=n.getView().getModel(n.oModelName).getData();var M={Tplnr:k.Functionallocation,Txtmi:k.Flocdescription,TplkzFlc:k.Strucindicator,Tplxt:k.StrucIndicatorDesc,EditMask:k.EditMask,Hierarchy:k.Hierarchy,Fltyp:k.Floccategory,Flttx:k.FlocCategoryDesc,Swerk:k.Maintplant,Plantname:k.MaintplantDesc,StorFloc:k.Location,Locationdesc:k.Locationdesc,Abckzfloc:k.Abckz,Abctx:k.Abctx,Bukrsfloc:k.Bukrs,Butxt:k.Butxt,City:k.City,KostFloc:k.Kostl,KokrFloc:k.Kokrs,Contareaname:k.Mctxt,PlntFloc:k.Werks,Planningplantdes:k.Planningplantdes,Ingrp:k.Ingrp,Plannergrpdesc:k.Innam,Arbplfloc:k.Arbpl,Wergwfloc:k.WcWerks,Gewrkfloc:k.MainArbpl,MainWcPlant:k.MainWerks,Tplma:k.SupFunctionallocation,Supflocdesc:k.SupFlocdescription,BeberFl:k.BeberFl,Fing:k.Fing,Tele:k.Tele,Submtiflo:k.ConstrType,Constdesc:k.ConstructionDesc,Eqart:k.TechnicalObjectTyp,Eartx:k.Description,Stattext:k.Stattext,StsmFloc:k.StsmEqui,Statproftxt:k.StsmEquiDesc,UstwFloc:k.UstwEqui,UswoFloc:k.UswoEqui,UstaFloc:k.UstaEqui,Adrnr:k.Adrnr,Adrnri:k.Adrnri,Deact:k.Deact,Alkey:k.Alkey};var v=this.getView().getModel("dataOrigin").getData();if(v){var L=v;M.Swerki=L[0].instLoc?"H":"D";M.Storti=L[1].instLoc?"H":"D";M.Beberi=L[2].instLoc?"H":"D";M.Ppsidi=L[3].instLoc?"H":"D";M.Abckzi=L[4].instLoc?"H":"D";M.Bukrsi=L[5].instLoc?"H":"D";M.Kostli=L[6].instLoc?"H":"D";M.Kokrsi=L[7].instLoc?"H":"D";M.Iwerki=L[8].instLoc?"H":"D";M.Ingrpi=L[9].instLoc?"H":"D";M.Lgwidi=L[10].instLoc?"H":"D";M.Adrnri=L[12].instLoc?"H":"D"}h.FuncLoc.push(M);p=M;M.IsDOI=true;var C={Funcloc:k.Functionallocation,Title:k.TitleCode,Name1:k.Name1,Name2:k.Name2,Name3:k.Name3,Name4:k.Name4,Sort1:k.Sort1,Sort2:k.Sort2,NameCo:k.NameCo,PostCod1:k.PostCod1,City1:k.City1,Building:k.Building,Floor:k.Floor,Roomnum:k.Roomnum,Strsuppl1:k.Strsuppl1,Strsuppl2:k.Strsuppl2,Strsuppl3:k.Strsuppl3,Location:k.AddrLocation,RPostafl:k.RefPosta,Landx:k.Landx,TimeZone:k.TimeZone,RPostFl:k.Region,Regiotxt:k.RegionDesc};h.FLAddr.push(C);m=C;var V=k.intlAddr;if(V.length>0){for(var A=0;A<V.length;A++){h.FLAddrI.push(V[A])}}S=V;if(n.AltLblDerv==="2"&&k.altlbl.length>0){for(var D=0;D<k.altlbl.length;D++){var b={Funcloc:k.Functionallocation,AltAlkey:k.altlbl[D].AltAlkey,AltStrno:k.altlbl[D].AltStrno,AltTplkz:k.altlbl[D].AltTplkz};h.FLALTLBEL.push(b)}}if(k.Floccategory==="L"){var N={Funcloc:k.Functionallocation,Lrpid:k.lam.Lrpid,Strtptatr:k.lam.Strtptatr,Endptatr:k.lam.Endptatr,Length:k.lam.Length.toString(),LinUnit:k.lam.LinUnit,Startmrkr:k.lam.Startmrkr,Endmrkr:k.lam.Endmrkr,Mrkdisst:k.lam.Mrkdisst,Mrkdisend:k.lam.Mrkdisend,MrkrUnit:k.lam.MrkrUnit};f=N;N.LamDer="D";h.FLLAM.push(N)}var T=k.classItems;if(T){if(T.length>0){for(var w=0;w<T.length;w++){var I={Funcloc:k.Functionallocation,Classtype:T[w].Classtype,Class:T[w].Class,Clstatus1:T[w].Clstatus1};h.FLClass.push(I)}}}var P=k.characteristics;if(P){if(P.length>0){for(var y=0;y<P.length;y++){var x={Funcloc:k.Functionallocation,Atnam:P[y].Atnam,Textbez:P[y].Textbez,Atwrt:P[y].Atwrt,Class:P[y].Class};h.FLVal.push(x)}}}var E=function(l){if(l.FuncLoc.results.length>0){for(var o=0;o<l.FuncLoc.results.length;o++){if(l.FuncLoc.results[o].Tplnr===u){var d=l.FuncLoc.results[o];var c={intlAddr:[],altlbl:[],classItems:[],characteristics:[],FunctionallocationVS:"None",FunctionallocationVST:"",FlocdescriptionVS:"None",FlocdescriptionVST:"",StrucindicatorVS:"None",StrucindicatorVST:"",FloccategoryVS:"None",FloccategoryVST:"",SupFunctionallocationVS:"None",SupFunctionallocationVST:"",MaintplantVS:"None",MaintplantVST:"",StsmEquiVS:"None",StsmEquiVST:"",UstwEquiVS:"None",UstwEquiVST:"",UswoEquiVS:"None",UswoEquiVST:"",TechnicalObjectTypVS:"None",TechnicalObjectTypVST:"",LocationVS:"None",LocationVST:"",AbckzVS:"None",AbckzVST:"",MainArbplVS:"None",MainArbplVST:"",BeberFlVS:"None",BeberFlVST:"",BukrsVS:"None",BukrsVST:"",KostlVS:"None",KostlVST:"",WerksVS:"None",WerksVST:"",IngrpVS:"None",IngrpVST:"",ArbplVS:"None",ArbplVST:"",ConstrTypeVS:"None",ConstrTypeVST:"",RefPostaVS:"None",RefPostaVST:"",LangucodeVS:"None",LangucodeVST:"",TimeZoneVS:"None",TimeZoneVST:"",TplnrEnabled:true,FunctionalLocEnabled:true,FlocCatEnabled:true,StrucIndEnabled:true,MaintplantEnabled:true,BukrsEnabled:true};c.Functionallocation=d.Tplnr;c.Flocdescription=d.Txtmi;c.EditMask=d.EditMask;c.Hierarchy=d.Hierarchy;c.Floccategory=d.Fltyp;c.FlocCategoryDesc=d.Flttx;c.Strucindicator=d.TplkzFlc;c.StrucIndicatorDesc=d.Tplxt;c.SupFunctionallocation=d.Tplma;c.SupFlocdescription=d.Supflocdesc;c.Stattext=d.Stattext;c.StsmEqui=d.StsmFloc;c.StsmEquiDesc=d.Statproftxt;c.UstwEqui=d.UstwFloc;c.UswoEqui=d.UswoFloc;c.UstaEqui=d.UstaFloc;c.TechnicalObjectTyp=d.Eqart;c.Description=d.Eartx;c.Maintplant=d.Swerk;c.MaintplantDesc=d.Plantname;c.Location=d.StorFloc;c.Locationdesc=d.Locationdesc;c.BeberFl=d.BeberFl;c.Fing=d.Fing;c.Tele=d.Tele;c.Arbpl=d.Arbplfloc;c.Ktext=d.Workcenterdesc;c.WcWerks=d.Wergwfloc;c.MainArbpl=d.Gewrkfloc;c.MainKtext=d.MainWcDesc;c.MainWerks=d.MainWcPlant;c.Abckz=d.Abckzfloc;c.Abctx=d.Abctx;c.Bukrs=d.Bukrsfloc;c.Butxt=d.Butxt;c.City=d.City;c.Kostl=d.KostFloc;c.Kokrs=d.KokrFloc;c.Mctxt=d.Contareaname;c.Werks=d.PlntFloc;c.Planningplantdes=d.Planningplantdes;c.Ingrp=d.Ingrp;c.Innam=d.Plannergrpdesc;c.ConstrType=d.Submtiflo;c.ConstructionDesc=d.Constdesc;c.menuAction=d.IsMenu;c.Adrnr=d.Adrnr;c.Adrnri=d.Adrnri;c.Deact=d.Deact;c.Alkey=d.Alkey;c.Altxt=d.Altxt;c.Modeldesc=d.Modeldesc;c.Modelref=d.Modelref;c.Modelrver=d.Modelrver;c.Modelext=d.Modelext;c.Modelname=d.Modelname;c.Modelver=d.Modelver;if(a&&c.Functionallocation===u){n.flHeader=l.FuncLoc.results[o];c.Maintplant=p.Swerk;c.MaintplantDesc=p.Name1;c.Bukrs=p.Bukrsfloc;c.Butxt=p.Butxt;c.Location=p.StorFloc;c.Locationdesc=p.Locationdesc;c.Abckz=p.Abckzfloc;c.Abctx=p.Abctx;c.Kostl=p.KostFloc;c.Kokrs=p.KokrFloc;c.Mctxt=p.Contareaname;c.Werks=p.PlntFloc;c.Planningplantdes=p.Planningplantdes;c.Ingrp=p.Ingrp;c.Innam=p.Innam;c.MainArbpl=p.Gewrkfloc;c.MainKtext=p.MainKtext;c.MainWerks=p.MainWerks;c.BeberFl=p.BeberFl;c.Fing=p.Fing;c.Tele=p.Tele;c.Stattext=p.Stattext}if(d.Type===true){c.viewParameter="create"}if(d.Type===false){c.viewParameter="change";if(c.Floccategory===""||c.Floccategory===undefined){c.FlocCatEnabled=true}else{c.FlocCatEnabled=false}if(c.Strucindicator===""||c.Strucindicator===undefined){c.StrucIndEnabled=true}else{c.StrucIndEnabled=false}c.FunctionalLocEnabled=false}if(d.Swerk!==""){c.BukrsEnabled=false}else{c.MaintplantEnabled=true;c.BukrsEnabled=true}if(a&&c.Functionallocation===u&&c.Floccategory==="L"){c.lam=f;if(l.FLLAM.results.length>0){n.flLAM=l.FLLAM.results}}if(a&&c.Functionallocation===u){var g=sap.ui.getCore().getModel("flocAddressView");var h=g.getData();var F=true;var M,v;if(h.length>0){for(var L=0;L<h.length;L++){if(c.Functionallocation===h[L].Functionallocation){F=false;v=L;break}}}if(F&&c.SupFunctionallocation!==""&&c.SupFunctionallocation!==undefined){M={Functionallocation:c.Functionallocation,IsEditable:m.IsEditable};h.push(M);g.setData(h)}if(!F&&c.SupFunctionallocation!==""&&c.SupFunctionallocation!==undefined){h[v].Functionallocation=c.Functionallocation;h[v].IsEditable=c.IsEditable;g.setData(h)}c.IsEditable=m.IsEditable;c.Title=m.Titletxt?m.Titletxt:"";c.TitleCode=m.Title?m.Title:"";c.Name1=m.Name1?m.Name1:"";c.Name2=m.Name2?m.Name2:"";c.Name3=m.Name3?m.Name3:"";c.Name4=m.Name4?m.Name4:"";c.Sort1=m.Sort1?m.Sort1:"";c.Sort2=m.Sort2?m.Sort2:"";c.NameCo=m.NameCo?m.NameCo:"";c.PostCod1=m.PostCod1?m.PostCod1:"";c.City1=m.City1?m.City1:"";c.Building=m.Building?m.Building:"";c.Floor=m.Floor?m.Floor:"";c.Roomnum=m.Roomnum?m.Roomnum:"";c.Strsuppl1=m.Strsuppl1?m.Strsuppl1:"";c.Strsuppl2=m.Strsuppl2?m.Strsuppl2:"";c.Strsuppl3=m.Strsuppl3?m.Strsuppl3:"";c.AddrLocation=m.Location?m.Location:"";c.RefPosta=m.RPostafl?m.RPostafl:"";c.Landx=m.Landx?m.Landx:"";c.TimeZone=m.TimeZone?m.TimeZone:"";c.Region=m.RPostFl?m.RPostFl:"";c.RegionDesc=m.Regiotxt?m.Regiotxt:"";if(l.FLAddr.results){n.flAddr=l.FLAddr.results}}var C=l.FLAddrI.results;if(C.length>0){for(var V=0;V<C.length;V++){if(C[V].Funcloc===c.Functionallocation){C[V].AdNationEnable=false;C[V].City1iVS="None";C[V].StreetiVS="None";c.intlAddr.push(C[V])}}}if(a&&c.Functionallocation===u&&c.intlAddr.length>0){n.flIntlAddr=c.intlAddr;c.intlAddr=S}else{n.flIntlAddr=[]}var A=l.FLALTLBEL.results;if(A.length>0){for(var D=0;D<A.length;D++){if(A[D].Funcloc===c.Functionallocation){var b={Funcloc:d.Tplnr,AltAlkey:A[D].AltAlkey,Altxt:A[D].Altxt,AltStrno:A[D].AltStrno,AltTplkz:A[D].AltTplkz,Tplxt:A[D].Tplxt,Name1i:A[D].Editm,Actvs:A[D].Actvs,AltPrkey:A[D].AltPrkey,AltReuse:A[D].AltReuse,enableLblSys:false,enableAltLbl:true,enableStrInd:true,LblSysVS:"None",AltLblVS:"None",StrIndVS:"None"};c.altlbl.push(b)}}}if(l.FLClass){var N=l.FLClass.results;if(N){if(N.length>0){for(var T=0;T<N.length;T++){if(c.Functionallocation===N[T].Funcloc){N[T].ctEnable=false;N[T].classEnable=false;N[T].ClassTypeDesc=N[T].Artxt;delete N[T].Artxt;delete N[T].Changerequestid;delete N[T].Clint;delete N[T].Service;c.classItems.push(N[T])}}c.charNewButton=true;if(n.class&&n.class.getId().includes("detailFloc")===true){n.class.setModel(new t(c.classItems))}}}}if(l.FLVal){var w=l.FLVal.results;if(w){if(w.length>0){for(var I=0;I<w.length;I++){if(c.Functionallocation===w[I].Funcloc){w[I].cNameEnable=false;w[I].Textbz=w[I].Atwtb;delete w[I].Ataut;delete w[I].Ataw1;delete w[I].Atawe;delete w[I].Atcod;delete w[I].Atflb;delete w[I].Atflv;delete w[I].Atimb;delete w[I].Atsrt;delete w[I].Atvglart;delete w[I].Atzis;delete w[I].Changerequestid;delete w[I].CharName;delete w[I].Charid;delete w[I].Classtype;delete w[I].Service;delete w[I].Valcnt;w[I].slNo=I+1;w[I].flag=w[I].Class+"-"+w[I].slNo;c.characteristics.push(w[I])}}if(n.char&&n.char.getId().includes("detailFloc")===true){n.char.setModel(new t(c.characteristics))}}}}if(c.UstaEqui){s.visible=true}else{s.visible=false}r.setData(s);n.getView().getModel(n.oModelName).setData(c);var P=new t;var y=c;y.Title=y.Title?y.Title:"";y.TitleCode=y.TitleCode?y.TitleCode:"";y.Name1=y.Name1?y.Name1:"";y.Name2=y.Name2?y.Name2:"";y.Name3=y.Name3?y.Name3:"";y.Name4=y.Name4?y.Name4:"";y.Sort1=y.Sort1?y.Sort1:"";y.Sort2=y.Sort2?y.Sort2:"";y.NameCo=y.NameCo?y.NameCo:"";y.PostCod1=y.PostCod1?y.PostCod1:"";y.City1=y.City1?y.City1:"";y.Building=y.Building?y.Building:"";y.Floor=y.Floor?y.Floor:"";y.Roomnum=y.Roomnum?y.Roomnum:"";y.Strsuppl1=y.Strsuppl1?y.Strsuppl1:"";y.Strsuppl2=y.Strsuppl2?y.Strsuppl2:"";y.Strsuppl3=y.Strsuppl3?y.Strsuppl3:"";y.AddrLocation=y.AddrLocation?y.AddrLocation:"";y.RefPosta=y.RefPosta?y.RefPosta:"";y.Landx=y.Landx?y.Landx:"";y.TimeZone=y.TimeZone?y.TimeZone:"";y.Region=y.Region?y.Region:"";y.RegionDesc=y.RegionDesc?y.RegionDesc:"";if(y.Title!==""&&y.Title!==undefined||y.TitleCode!==""&&y.TitleCode!==undefined||y.Name1!==""&&y.Name1!==undefined||y.Name2!==""&&y.Name2!==undefined||y.Name3!==""&&y.Name3!==undefined||y.Name4!==""&&y.Name4!==undefined||y.Sort1!==""&&y.Sort1!==undefined||y.Sort2!==""&&y.Sort2!==undefined||y.NameCo!==""&&y.NameCo!==undefined||y.PostCod1!==""&&y.PostCod1!==undefined||y.City1!==""&&y.City1!==undefined||y.Building!==""&&y.Building!==undefined||y.Floor!==""&&y.Floor!==undefined||y.Roomnum!==""&&y.Roomnum!==undefined||y.AddrLocation!==""&&y.AddrLocation!==undefined||y.Strsuppl1!==""&&y.Strsuppl1!==undefined||y.Strsuppl2!==""&&y.Strsuppl2!==undefined||y.Strsuppl3!==""&&y.Strsuppl3!==undefined||y.TimeZone!==""&&y.TimeZone!==undefined||y.RefPosta!==""&&y.RefPosta!==undefined||y.Region!==""&&y.Region!==undefined){y.RefPostaLblReq=true;var x=n.getView().getModel("flocAddressView");var k=x.getData();k.enabled=y.IsEditable;x.setData(k)}P.setData(y);n.getView().setModel(P,n.oModelName);n.lam.setModel(P,"AIWLAM");var E=[P.getData()];var O=$.map(E,function(e){return $.extend(true,{},e)});var R=new t;R.setData(O);n.getView().setModel(R,"SUP_FLOC_DATA");var B=sap.ui.getCore().getModel("SUP_FLOC_DATA");var H=B.getData();var W=true;for(var U=0;U<H.length;U++){if(y.Functionallocation===H[U].Functionallocation){W=false}}if(W&&y.SupFunctionallocation!==""&&y.SupFunctionallocation!==undefined){H.push(O[0]);B.setData(H)}}}}s.viewBusy=false;r.setData(s);if(a){n.functionalLocation=e;n.functionalLocDesc=i;n.getView().getModel("dataOrigin").setProperty("/originDerive",l);n.openDoiView(undefined,l)}};var O=function(e){var t=[];if(JSON.parse(e.responseText).error.innererror.errordetails===undefined||JSON.parse(e.responseText).error.innererror.errordetails.length===0){t[0]=JSON.parse(e.responseText).error.message.value}else{for(var a=0;a<JSON.parse(e.responseText).error.innererror.errordetails.length;a++){t[a]=JSON.parse(e.responseText).error.innererror.errordetails[a].message}}var i=t.join("\n");s.viewBusy=false;r.setData(s);n.invokeMessage(i)};s.viewBusy=true;r.setData(s);if(h.FLAddrI.length>0){h.FLAddrI=$.map(h.FLAddrI,function(e){return $.extend(true,{},e)});for(var R=0;R<h.FLAddrI.length>0;R++){delete h.FLAddrI[R].AdNationEnable;delete h.FLAddrI[R].City1iVS;delete h.FLAddrI[R].StreetiVS}}o.create(l,h,{success:E,error:O})},onDOIDisplayPress:function(){this.doiDisplayFlag=true;var e=this.getView().getModel(this.oModelName).getData();if(!this.doiView){this.doiView=sap.ui.xmlfragment("ugieamui.mdg.eam.lib.doi.DataOrigin",this)}var a=new sap.ui.model.json.JSONModel,i;var n=this.functionalLocation,l=this.functionalLocDesc;var o={},r,s;o.install=true;o.dismantle=false;o.parent=n;o.parentDesc=l;o.currentObj=e.Functionallocation;o.currObjDesc=e.Flocdescription;i=this.getView().getModel("i18n").getProperty("doi");this.doiView.setTitle(i);this.doiView.getAggregation("beginButton").setText("OK").setEnabled(true);sap.ui.getCore().byId("currObjLbl").setText(this.getView().getModel("i18n").getProperty("FUNLOC"));s=this.getView().getModel("i18n").getProperty("instlFieldFlText");r=this.getView().getModel("i18n").getProperty("instlHdrFlText");this.doiView.getContent()[0].getContent()[0].setText(s);this.doiView.getContent()[1].getColumns()[1].getAggregation("header").setText(r);this.doiView.getContent()[1].getColumns()[5].getAggregation("header").setText(this.getView().getModel("i18n").getProperty("indMaintFL"));a.setData(o);this.getView().setModel(a,"doi");this.doiView.setModel(a,"doi");if(e.SupFunctionallocation===""){e.SupFlocdescription=""}var d=this.doiView.getContent()[1];var c=this.getView().getModel("dataOrigin").getData();var u=this.getView().getModel("dataOrigin").getData();var g=$.map(u,function(e){return $.extend(true,{},e)});d.getColumns()[3].getAggregation("header").setEnabled(false);d.getColumns()[5].getAggregation("header").setEnabled(false);g.forEach(function(e){e.locEnable=false;e.maintEnable=false});if(d.getModel()){d.getModel().setData(g)}else{var p=new t(g);d.setModel(p)}var f=sap.ui.getCore().byId("idColItems");d.bindItems("/",f);this.doiView.open()},openDoiView:function(e,a){var i=this.getView().getModel(this.oModelName).getData();if(!this.doiView){this.doiView=sap.ui.xmlfragment("ugieamui.mdg.eam.lib.doi.DataOrigin",this)}var n=this.getView().getModel("i18n").getProperty("doiFlCurrVal");var l=this.getView().getModel("i18n").getProperty("doiFlTarVal");this.doiView.mAggregations.content[1].mAggregations.columns[6].mAggregations.header.setText(n);this.doiView.mAggregations.content[1].mAggregations.columns[7].mAggregations.header.setText(l);var o=new sap.ui.model.json.JSONModel,r,s=this.functionalLocation,d=this.functionalLocDesc;var c={},u,g;if(e===""){c.install=false;c.dismantle=true;c.parent=s;c.parentDesc=d;c.currentObj=i.Functionallocation;c.currObjDesc=i.Flocdescription;this.doiView.getAggregation("beginButton").setText("Dismantle").setEnabled(true);r=this.getView().getModel("i18n").getProperty("doiDismantle");this.doiView.getContent()[1].getColumns()[2].getAggregation("header").setText(this.getView().getModel("i18n").getProperty("locationDisAft"));this.doiView.getContent()[1].getColumns()[4].getAggregation("header").setText(this.getView().getModel("i18n").getProperty("locationDisBfr"));this.doiView.setTitle(r);sap.ui.getCore().byId("currObjLbl").setText(this.getView().getModel("i18n").getProperty("FUNLOC"));g=this.getView().getModel("i18n").getProperty("instlFieldFlText");u=this.getView().getModel("i18n").getProperty("instlHdrFlText");this.doiView.getContent()[1].getColumns()[1].getAggregation("header").setText(u)}else{c.install=true;c.dismantle=false;c.parent=s;c.parentDesc=d;c.currentObj=i.Functionallocation;c.currObjDesc=i.Flocdescription;r=this.getView().getModel("i18n").getProperty("doi");this.doiView.getAggregation("beginButton").setText("Install").setEnabled(true);this.doiView.setTitle(r);sap.ui.getCore().byId("currObjLbl").setText(this.getView().getModel("i18n").getProperty("FUNLOC"));g=this.getView().getModel("i18n").getProperty("instlFieldFlText");u=this.getView().getModel("i18n").getProperty("instlHdrFlText");this.doiView.getContent()[0].getContent()[0].setText(g);this.doiView.getContent()[1].getColumns()[1].getAggregation("header").setText(u);this.doiView.getContent()[1].getColumns()[5].getAggregation("header").setText(this.getView().getModel("i18n").getProperty("indMaintFL"))}o.setData(c);this.getView().setModel(o,"doi");this.doiView.setModel(o,"doi");if(i.SupFunctionallocation===""){i.SupFlocdescription=""}var p=this.doiView.getContent()[1];var f=this.getView().getModel("dataOrigin").getData();if(a){var m=a.FLDOI.results;for(var S=0;S<m.length;S++){m[S].instLoc=true;if(m[S].hasOwnProperty("maintenance")){if(!m[S].maintenance){m[S].targetVal=m[S].SupFlVal}}else{m[S].maintenance=f[S].maintenance;if(m[S].maintenance){m[S].instLoc=false}else{m[S].instLoc=true}m[S].currentVal=f[S].currentVal}if(m[S].Property==="Maintplant"||m[S].Property==="PlntFloc"){m[S].locEnable=false;m[S].maintEnable=false}else{m[S].locEnable=true;m[S].maintEnable=true}m[S].targetVal=m[S].SupFlVal}if(i.Title!==""&&i.Title!==undefined||i.TitleCode!==""&&i.TitleCode!==undefined||i.Name1!==""&&i.Name1!==undefined||i.Name2!==""&&i.Name2!==undefined||i.Name3!==""&&i.Name3!==undefined||i.Name4!==""&&i.Name4!==undefined||i.Sort1!==""&&i.Sort1!==undefined||i.Sort2!==""&&i.Sort2!==undefined||i.NameCo!==""&&i.NameCo!==undefined||i.PostCod1!==""&&i.PostCod1!==undefined||i.City1!==""&&i.City1!==undefined||i.Building!==""&&i.Building!==undefined||i.Floor!==""&&i.Floor!==undefined||i.Roomnum!==""&&i.Roomnum!==undefined||i.AddrLocation!==""&&i.AddrLocation!==undefined||i.Strsuppl1!==""&&i.Strsuppl1!==undefined||i.Strsuppl2!==""&&i.Strsuppl2!==undefined||i.Strsuppl3!==""&&i.Strsuppl3!==undefined||i.TimeZone!==""&&i.TimeZone!==undefined||i.RefPosta!==""&&i.RefPosta!==undefined||i.Region!==""&&i.Region!==undefined){m[12].maintenance=true;m[12].instLoc=false;m[12].targetVal=i.Functionallocation;m[12].currentVal=i.Functionallocation}p.setModel(new sap.ui.model.json.JSONModel(m))}else{var h=this.getView().getModel("dataOrigin").getData();var F=$.map(h,function(e){return $.extend(true,{},e)});p.setModel(new t(F));var M=p.getModel().getData();p.getColumns()[3].getAggregation("header").setSelected(false);M.forEach(function(e){e.instLoc=false});var v=$.map(M,function(e){return $.extend(true,{},e)});v.splice(8,1);v.splice(0,1);v.forEach(function(e){e.instLoc=false});p.getModel().setData(v)}p.getColumns()[3].getAggregation("header").setEnabled(true);p.getColumns()[5].getAggregation("header").setEnabled(true);var L=sap.ui.getCore().byId("idColItems");p.bindItems("/",L);this.doiView.open();this.getView().getModel("dataOrigin").refresh()},onObjectItemSelect:function(e){var t=e.getSource();var a=e.getSource().getSelected();var i=t.getBindingContext().getObject();var n=e.getSource().getParent().getParent().getParent().getBeginButton().getText();var l=t.getId();if(l.indexOf("eq")>-1){i.instLoc=false;i.targetVal=""}else if(l.indexOf("il")>-1){if(a){if(n==="Dismantle"){i.maintenance=false;i.finalDismantle=i.SupFlVal}else{i.maintenance=false;i.targetVal=i.SupFlVal}}else{if(n==="Dismantle"){i.maintenance=false;i.finalDismantle=""}}}},onDOIActionPress:function(e){var a=this;if(this.doiDisplayFlag){e.getSource().getParent().close();this.doiDisplayFlag=false;return}if(a.viewName==="ChangeFloc"){a.onDOIActionPressChange(e);return}var i=e.getSource().getText();var n=sap.ui.getCore().getModel("AIWFLOC");var l=n.getData();var o=a.getView().getModel(a.oModelName);var r=o.getData();var s=a.getView().getModel(a.oModelName).getData().Functionallocation;var d=e.getSource().getParent().getContent()[1].getModel().getData();var c={};var u="";for(var g=0;g<l.length;g++){if(l[g].Functionallocation===s){c=l[g];u=g}}if(i==="Install"){this.isInstall=true;var p=a.flHeader;if(!d[1].maintenance){c.Location=p.StorFloc;c.Locationdesc=p.Locationdesc}if(!d[2].maintenance){c.BeberFl=p.BeberFl;c.Fing=p.Fing;c.Tele=p.Tele}if(!d[3].maintenance){c.Arbpl=p.Arbplfloc;c.Ktext=p.Workcenterdesc}if(!d[4].maintenance){c.Abckz=p.Abckzfloc;c.Abctx=p.Abctx}if(!d[6].maintenance){c.Kostl=p.KostFloc;c.Mctxt=p.Contareaname}if(!d[9].maintenance){c.Ingrp=p.Ingrp;c.Innam=p.Plannergrpdesc}if(!d[10].maintenance){c.MainArbpl=p.Gewrkfloc;c.MainKtext=p.MainWcDesc;c.MainWerks=p.MainWcPlant}if(d[0].instLoc&&p.Swerk!==""){c.Maintplant=p.Swerk;c.MaintplantDesc=p.Name1;c.Bukrs=p.Bukrsfloc;c.Butxt=p.Butxt;c.BukrsEnabled=false;c.Werks=p.PlntFloc;c.Planningplantdes=p.Planningplantdes;c.Kokrs=p.KokrFloc}c.MaintplantEnabled=true;c.Stattext=p.Stattext;if(d.length<13){var f=this.getView().getModel("dataOrigin").getData();d.splice(0,0,f[0]);d.splice(8,0,f[8]);this.getView().getModel("dataOrigin").setData(d)}if(!d[12].maintenance){var m=a.flAddr;if(m){if(m.length>0){for(var S=0;S<m.length;S++){if(c.Functionallocation===m[S].Funcloc){var h=sap.ui.getCore().getModel("flocAddressView");var F=h.getData();var M=true;var v,L;if(F.length>0){for(var C=0;C<F.length;C++){if(c.Functionallocation===F[C].Functionallocation){M=false;L=C;break}}}if(M&&c.SupFunctionallocation!==""&&c.SupFunctionallocation!==undefined){v={Functionallocation:c.Functionallocation,IsEditable:m[S].IsEditable};F.push(v);h.setData(F)}if(!M&&c.SupFunctionallocation!==""&&c.SupFunctionallocation!==undefined){F[L].Functionallocation=c.Functionallocation;F[L].IsEditable=c.IsEditable;h.setData(F)}c.IsEditable=m[S].IsEditable;c.Title=m[S].Titletxt?m[S].Titletxt:"";c.TitleCode=m[S].Title?m[S].Title:"";c.Name1=m[S].Name1?m[S].Name1:"";c.Name2=m[S].Name2?m[S].Name2:"";c.Name3=m[S].Name3?m[S].Name3:"";c.Name4=m[S].Name4?m[S].Name4:"";c.Sort1=m[S].Sort1?m[S].Sort1:"";c.Sort2=m[S].Sort2?m[S].Sort2:"";c.NameCo=m[S].NameCo?m[S].NameCo:"";c.PostCod1=m[S].PostCod1?m[S].PostCod1:"";c.City1=m[S].City1?m[S].City1:"";c.Building=m[S].Building?m[S].Building:"";c.Floor=m[S].Floor?m[S].Floor:"";c.Roomnum=m[S].Roomnum?m[S].Roomnum:"";c.Strsuppl1=m[S].Strsuppl1?m[S].Strsuppl1:"";c.Strsuppl2=m[S].Strsuppl2?m[S].Strsuppl2:"";c.Strsuppl3=m[S].Strsuppl3?m[S].Strsuppl3:"";c.AddrLocation=m[S].Location?m[S].Location:"";c.RefPosta=m[S].RPostafl?m[S].RPostafl:"";c.Landx=m[S].Landx?m[S].Landx:"";c.TimeZone=m[S].TimeZone?m[S].TimeZone:"";c.Region=m[S].RPostFl?m[S].RPostFl:"";c.RegionDesc=m[S].Regiotxt?m[S].Regiotxt:""}}}else{c.Title=c.Title?c.Title:"";c.TitleCode=c.TitleCode?c.TitleCode:"";c.Name1=c.Name1?c.Name1:"";c.Name2=c.Name2?c.Name2:"";c.Name3=c.Name3?c.Name3:"";c.Name4=c.Name4?c.Name4:"";c.Sort1=c.Sort1?c.Sort1:"";c.Sort2=c.Sort2?c.Sort2:"";c.NameCo=c.NameCo?c.NameCo:"";c.PostCod1=c.PostCod1?c.PostCod1:"";c.City1=c.City1?c.City1:"";c.Building=c.Building?c.Building:"";c.Floor=c.Floor?c.Floor:"";c.Roomnum=c.Roomnum?c.Roomnum:"";c.Strsuppl1=c.Strsuppl1?c.Strsuppl1:"";c.Strsuppl2=c.Strsuppl2?c.Strsuppl2:"";c.Strsuppl3=c.Strsuppl3?c.Strsuppl3:"";c.AddrLocation=c.AddrLocation?c.AddrLocation:"";c.RefPosta=c.RefPosta?c.RefPosta:"";c.Landx=c.Landx?c.Landx:"";c.TimeZone=c.TimeZone?c.TimeZone:"";c.Region=c.Region?c.Region:"";c.RegionDesc=c.RegionDesc?c.RegionDesc:""}c.intlAddr=a.flIntlAddr}}var V=a.flLAM;if(V){for(var A=0;A<V.length;A++){if(V[A].Funcloc===c.Functionallocation){if(c.Functionallocation===s&&c.Floccategory==="L"&&a.lamSwitch==="X"){var D=A;var b="Superior object has been changed. Do you want to copy linear data from superior object?";sap.m.MessageBox.confirm(b,{title:"Confirmation",onClose:function(e){if(e==="OK"){var t={Funcloc:V[D].Funcloc,Lrpid:V[D].Lrpid,LrpidDesc:V[D].LrpDescr,Strtptatr:V[D].Strtptatr,Endptatr:V[D].Endptatr,Length:V[D].Length,LinUnit:V[D].LinUnit,LinUnitDesc:V[D].Uomtext,Startmrkr:V[D].Startmrkr,Endmrkr:V[D].Endmrkr,Mrkdisst:V[D].Mrkdisst,Mrkdisend:V[D].Mrkdisend,MrkrUnit:V[D].MrkrUnit,LamDer:V[D].LamDer};var i=a.getView().getModel(a.oModelName);var n=i.getData();n.lam=t;i.setData(n);a.lam.setModel(i,"AIWLAM")}}});break}}}}l[u]=c;n.setData(l)}else{this.isInstall=false;this.functionalLocation="";this.functionalLocDesc="";var N=this.getView().byId("idLocation").getName();var T=this.getView().byId("idAbcInd").getName();var w=this.getView().byId("idPlntSec").getName();var I=this.getView().byId("idWorkCen").getName();var P=this.getView().byId("idCostCtr").getName();var y=this.getView().byId("idPlnGrp").getName();var x=this.getView().byId("idMainWC").getName();for(var k=0;k<d.length;k++){if(d[k].Property===N&&!d[k].instLoc){c.Location="";c.Locationdesc=""}else if(d[k].Property===T&&!d[k].instLoc){c.Abckz="";c.Abctx=""}else if(d[k].Property===w&&!d[k].instLoc){c.BeberFl="";c.Fing="";c.Tele=""}else if(d[k].Property===I&&!d[k].instLoc){c.Arbpl="";c.Ktext=""}else if(d[k].Property===P&&!d[k].instLoc){c.Kostl="";c.Kokrs=""}else if(d[k].Property===y&&!d[k].instLoc){c.Ingrp="";c.Innam=""}else if(d[k].Property===x&&!d[k].instLoc){c.MainArbpl="";c.MainWerks="";c.MainKtext=""}else if(d[k].Property==="Adrnr"){if(a.getView().getModel("SUP_FLOC_DATA")){var E=sap.ui.getCore().getModel("SUP_FLOC_DATA");var O=E.getData();var R;for(var B=0;B<O.length;B++){if(e.getSource().getModel(a.oModelName).getData().Functionallocation===O[B].Functionallocation){R=B;break}}var H=a.getView().getModel(a.oModelName);var r=H.getData();var W=a.getView().getModel("SUP_FLOC_DATA").getData()[0];if(W){r.Title="";r.TitleCode="";r.Name1="";r.Name2="";r.Name3="";r.Name4="";r.Sort1="";r.Sort2="";r.NameCo="";r.PostCod1="";r.City1="";r.Building="";r.Floor="";r.Roomnum="";r.Strsuppl1="";r.Strsuppl2="";r.Strsuppl3="";r.AddrLocation="";r.RefPosta="";r.Landx="";r.TimeZone="";r.Region="";r.RegionDesc="";r.RefPostaLblReq=false;var U=sap.ui.getCore().getModel("flocAddressView");var q=U.getData();for(var K=0;K<q.length;K++){if(e.getSource().getModel(a.oModelName).getData().Functionallocation===q[K].Functionallocation){q.splice(K,1);U.setData(q);break}}var z=a.getView().getModel("flocAddressView");var _=z.getData();_.enabled=true;z.setData(_);O.splice(R,1);E.setData(O)}}c.intlAddr=[]}}if(d[10].Property==="Adrnr"&&d[10].instLoc===true){var z=a.getView().getModel("flocAddressView");var _=z.getData();_.enabled=true;z.setData(_);sap.ui.getCore().getModel("flocAddressView").getData().forEach(function(e){if(e.Functionallocation===c.Functionallocation){e.IsEditable=true}})}c.MaintplantEnabled=true;l[u]=c;n.setData(l);this.readSystemStatus(a)}if(d.length<13){var f=this.getView().getModel("dataOrigin").getData();d.splice(0,0,f[0]);d.splice(8,0,f[8]);this.getView().getModel("dataOrigin").setData(d)}this.getView().getModel("dataOrigin").setData(d);for(var Z=0;Z<sap.ui.getCore().getModel("dataOriginMOP").getData().FL.length;Z++){if(sap.ui.getCore().getModel("dataOriginMOP").getData().FL[Z].key===s){sap.ui.getCore().getModel("dataOriginMOP").getData().FL[Z].DOI=d}}for(var j=0;j<n.getData().length;j++){if(s===n.getData()[j].Functionallocation){a.rowIndex="/"+j;var G=new t;var J=n.getProperty(a.rowIndex);J.Title=J.Title?J.Title:"";J.TitleCode=J.TitleCode?J.TitleCode:"";J.Name1=J.Name1?J.Name1:"";J.Name2=J.Name2?J.Name2:"";J.Name3=J.Name3?J.Name3:"";J.Name4=J.Name4?J.Name4:"";J.Sort1=J.Sort1?J.Sort1:"";J.Sort2=J.Sort2?J.Sort2:"";J.NameCo=J.NameCo?J.NameCo:"";J.PostCod1=J.PostCod1?J.PostCod1:"";J.City1=J.City1?J.City1:"";J.Building=J.Building?J.Building:"";J.Floor=J.Floor?J.Floor:"";J.Roomnum=J.Roomnum?J.Roomnum:"";J.Strsuppl1=J.Strsuppl1?J.Strsuppl1:"";J.Strsuppl2=J.Strsuppl2?J.Strsuppl2:"";J.Strsuppl3=J.Strsuppl3?J.Strsuppl3:"";J.AddrLocation=J.AddrLocation?J.AddrLocation:"";J.RefPosta=J.RefPosta?J.RefPosta:"";J.Landx=J.Landx?J.Landx:"";J.TimeZone=J.TimeZone?J.TimeZone:"";J.Region=J.Region?J.Region:"";J.RegionDesc=J.RegionDesc?J.RegionDesc:"";if(J.Title!==""&&J.Title!==undefined||J.TitleCode!==""&&J.TitleCode!==undefined||J.Name1!==""&&J.Name1!==undefined||J.Name2!==""&&J.Name2!==undefined||J.Name3!==""&&J.Name3!==undefined||J.Name4!==""&&J.Name4!==undefined||J.Sort1!==""&&J.Sort1!==undefined||J.Sort2!==""&&J.Sort2!==undefined||J.NameCo!==""&&J.NameCo!==undefined||J.PostCod1!==""&&J.PostCod1!==undefined||J.City1!==""&&J.City1!==undefined||J.Building!==""&&J.Building!==undefined||J.Floor!==""&&J.Floor!==undefined||J.Roomnum!==""&&J.Roomnum!==undefined||J.AddrLocation!==""&&J.AddrLocation!==undefined||J.Strsuppl1!==""&&J.Strsuppl1!==undefined||J.Strsuppl2!==""&&J.Strsuppl2!==undefined||J.Strsuppl3!==""&&J.Strsuppl3!==undefined||J.TimeZone!==""&&J.TimeZone!==undefined||J.RefPosta!==""&&J.RefPosta!==undefined||J.Region!==""&&J.Region!==undefined){J.RefPostaLblReq=true;var z=a.getView().getModel("flocAddressView");var _=z.getData();_.enabled=J.IsEditable;if(i!=="Install"&&d[12].Property==="Adrnr"&&d[12].instLoc===true){_.enabled=true}z.setData(_)}G.setData(J);a.getView().setModel(G,a.oModelName);a.getView().getModel(a.oModelName).refresh();a.lam.setModel(G,"AIWLAM");var X=[G.getData()];var W=$.map(X,function(e){return $.extend(true,{},e)});var Q=new t;Q.setData(W);a.getView().setModel(Q,"SUP_FLOC_DATA");var E=sap.ui.getCore().getModel("SUP_FLOC_DATA");var O=E.getData();var Y=true;for(var ee=0;ee<O.length;ee++){if(J.Functionallocation===O[ee].Functionallocation){Y=false}}if(Y&&J.SupFunctionallocation!==""&&J.SupFunctionallocation!==undefined){O.push(W[0]);E.setData(O)}break}}e.getSource().getParent().close();if(this.doiDisplayFlag){this.doiDisplayFlag=false}},onDOIActionPressChange:function(e){var t=this;var a=e.getSource().getText();var i=t.getView().getModel(t.oModelName);var n=i.getData();var l=t.getView().getModel(t.oModelName).getData().Functionallocation;var o=e.getSource().getParent().getContent()[1].getModel().getData();var r={};r=n;if(a==="Install"){var s=t.flHeader;if(!o[1].maintenance){r.Location=s.StorFloc;r.Locationdesc=s.Locationdesc}if(!o[4].maintenance){r.Abckz=s.Abckzfloc;r.Abctx=s.Abctx}if(!o[6].maintenance){r.Kostl=s.KostFloc;r.Mctxt=s.Contareaname}if(!o[9].maintenance){r.Ingrp=s.Ingrp;r.Innam=s.Plannergrpdesc}if(!o[10].maintenance){r.MainArbpl=s.Gewrkfloc;r.MainKtext=s.MainWcDesc;r.MainWerks=s.MainWcPlant}if(!o[2].maintenance){r.BeberFl=s.BeberFl;r.Fing=s.Fing;r.Tele=s.Tele}if(o[0].instLoc&&s.Swerk!==""){r.Maintplant=s.Swerk;r.MaintplantDesc=s.Name1;r.Bukrs=s.Bukrsfloc;r.Butxt=s.Butxt;r.BukrsEnabled=false;r.Werks=s.PlntFloc;r.Planningplantdes=s.Planningplantdes;r.Kokrs=s.KokrFloc}r.MaintplantEnabled=true;r.Stattext=s.Stattext;if(o.length<13){var d=this.getView().getModel("dataOrigin").getData();o.splice(0,0,d[0]);o.splice(8,0,d[8]);this.getView().getModel("dataOrigin").setData(o)}if(!o[12].maintenance){var c=t.flAddr;if(c){if(c.length>0){for(var u=0;u<c.length;u++){if(r.Functionallocation===c[u].Funcloc){var g=sap.ui.getCore().getModel("flocAddressView");var p=g.getData();var f=true;var m,S;if(p.length>0){for(var h=0;h<p.length;h++){if(r.Functionallocation===p[h].Functionallocation){f=false;S=h;break}}}if(f&&r.SupFunctionallocation!==""&&r.SupFunctionallocation!==undefined){m={Functionallocation:r.Functionallocation,IsEditable:c[u].IsEditable};p.push(m);g.setData(p)}if(!f&&r.SupFunctionallocation!==""&&r.SupFunctionallocation!==undefined){p[S].Functionallocation=r.Functionallocation;p[S].IsEditable=r.IsEditable;g.setData(p)}r.IsEditable=c[u].IsEditable;r.Title=c[u].Titletxt?c[u].Titletxt:"";r.TitleCode=c[u].Title?c[u].Title:"";r.Name1=c[u].Name1?c[u].Name1:"";r.Name2=c[u].Name2?c[u].Name2:"";r.Name3=c[u].Name3?c[u].Name3:"";r.Name4=c[u].Name4?c[u].Name4:"";r.Sort1=c[u].Sort1?c[u].Sort1:"";r.Sort2=c[u].Sort2?c[u].Sort2:"";r.NameCo=c[u].NameCo?c[u].NameCo:"";r.PostCod1=c[u].PostCod1?c[u].PostCod1:"";r.City1=c[u].City1?c[u].City1:"";r.Building=c[u].Building?c[u].Building:"";r.Floor=c[u].Floor?c[u].Floor:"";r.Roomnum=c[u].Roomnum?c[u].Roomnum:"";r.Strsuppl1=c[u].Strsuppl1?c[u].Strsuppl1:"";r.Strsuppl2=c[u].Strsuppl2?c[u].Strsuppl2:"";r.Strsuppl3=c[u].Strsuppl3?c[u].Strsuppl3:"";r.AddrLocation=c[u].Location?c[u].Location:"";r.RefPosta=c[u].RPostafl?c[u].RPostafl:"";r.Landx=c[u].Landx?c[u].Landx:"";r.TimeZone=c[u].TimeZone?c[u].TimeZone:"";r.Region=c[u].RPostFl?c[u].RPostFl:"";r.RegionDesc=c[u].Regiotxt?c[u].Regiotxt:""}}}else{r.Title=r.Title?r.Title:"";r.TitleCode=r.TitleCode?r.TitleCode:"";r.Name1=r.Name1?r.Name1:"";r.Name2=r.Name2?r.Name2:"";r.Name3=r.Name3?r.Name3:"";r.Name4=r.Name4?r.Name4:"";r.Sort1=r.Sort1?r.Sort1:"";r.Sort2=r.Sort2?r.Sort2:"";r.NameCo=r.NameCo?r.NameCo:"";r.PostCod1=r.PostCod1?r.PostCod1:"";r.City1=r.City1?r.City1:"";r.Building=r.Building?r.Building:"";r.Floor=r.Floor?r.Floor:"";r.Roomnum=r.Roomnum?r.Roomnum:"";r.Strsuppl1=r.Strsuppl1?r.Strsuppl1:"";r.Strsuppl2=r.Strsuppl2?r.Strsuppl2:"";r.Strsuppl3=r.Strsuppl3?r.Strsuppl3:"";r.AddrLocation=r.AddrLocation?r.AddrLocation:"";r.RefPosta=r.RefPosta?r.RefPosta:"";r.Landx=r.Landx?r.Landx:"";r.TimeZone=r.TimeZone?r.TimeZone:"";r.Region=r.Region?r.Region:"";r.RegionDesc=r.RegionDesc?r.RegionDesc:""}r.intlAddr=t.flIntlAddr}}var F=t.flLAM;if(F){for(var M=0;M<F.length;M++){if(F[M].Funcloc===r.Functionallocation){if(r.Functionallocation===l&&r.Floccategory==="L"&&t.lamSwitch==="X"){var v=M;var L="Superior object has been changed. Do you want to copy linear data from superior object?";sap.m.MessageBox.confirm(L,{title:"Confirmation",onClose:function(e){if(e==="OK"){var a={Funcloc:F[v].Funcloc,Lrpid:F[v].Lrpid,LrpidDesc:F[v].LrpDescr,Strtptatr:F[v].Strtptatr,Endptatr:F[v].Endptatr,Length:F[v].Length,LinUnit:F[v].LinUnit,LinUnitDesc:F[v].Uomtext,Startmrkr:F[v].Startmrkr,Endmrkr:F[v].Endmrkr,Mrkdisst:F[v].Mrkdisst,Mrkdisend:F[v].Mrkdisend,MrkrUnit:F[v].MrkrUnit,LamDer:F[v].LamDer};var i=t.getView().getModel(t.oModelName);var n=i.getData();n.lam=a;i.setData(n);t.lam.setModel(i,"AIWLAM")}}});break}}}}t.getView().getModel(t.oModelName).setData(r)}else{this.functionalLocation="";this.functionalLocDesc="";var C=this.getView().byId("idLocation").getName();var V=this.getView().byId("idAbcInd").getName();var A=this.getView().byId("idPlntSec").getName();var D=this.getView().byId("idWorkCen").getName();var b=this.getView().byId("idCostCtr").getName();var N=this.getView().byId("idPlnGrp").getName();var T=this.getView().byId("idMainWC").getName();for(var w=0;w<o.length;w++){if(o[w].Property===C&&!o[w].instLoc){r.Location="";r.Locationdesc=""}else if(o[w].Property===V&&!o[w].instLoc){r.Abckz="";r.Abctx=""}else if(o[w].Property===A&&!o[w].instLoc){r.BeberFl="";r.Fing="";r.Tele=""}else if(o[w].Property===D&&!o[w].instLoc){r.Arbpl="";r.Ktext=""}else if(o[w].Property===b&&!o[w].instLoc){r.Kostl="";r.Kokrs=""}else if(o[w].Property===N&&!o[w].instLoc){r.Ingrp="";r.Innam=""}else if(o[w].Property===T&&!o[w].instLoc){r.MainArbpl="";r.MainWerks="";r.MainKtext=""}else if(o[w].Property==="Adrnr"){if(t.getView().getModel("SUP_FLOC_DATA")){var I=sap.ui.getCore().getModel("SUP_FLOC_DATA");var P=I.getData();var y;for(var x=0;x<P.length;x++){if(e.getSource().getModel(t.oModelName).getData().Functionallocation===P[x].Functionallocation){y=x;break}}var k=t.getView().getModel("SUP_FLOC_DATA").getData()[0];if(k){r.Title="";r.TitleCode="";r.Name1="";r.Name2="";r.Name3="";r.Name4="";r.Sort1="";r.Sort2="";r.NameCo="";r.PostCod1="";r.City1="";r.Building="";r.Floor="";r.Roomnum="";r.Strsuppl1="";r.Strsuppl2="";r.Strsuppl3="";r.AddrLocation="";r.RefPosta="";r.Landx="";r.TimeZone="";r.Region="";r.RegionDesc="";r.RefPostaLblReq=false;var E=sap.ui.getCore().getModel("flocAddressView");var O=E.getData();for(var R=0;R<O.length;R++){if(r.Functionallocation===O[R].Functionallocation){O.splice(R,1);E.setData(O);break}}var B=t.getView().getModel("flocAddressView");var H=B.getData();H.enabled=true;B.setData(H);P.splice(y,1);I.setData(P)}}r.intlAddr=[]}}if(o[10].Property==="Adrnr"&&o[10].instLoc===true){var B=t.getView().getModel("flocAddressView");var H=B.getData();H.enabled=true;B.setData(H);sap.ui.getCore().getModel("flocAddressView").getData().forEach(function(e){if(e.Functionallocation===r.Functionallocation){e.IsEditable=true}})}r.MaintplantEnabled=true;t.getView().getModel(t.oModelName).setData(r);t.getView().getModel(t.oModelName).refresh();this.readSystemStatus(t)}if(o.length<13){var d=this.getView().getModel("dataOrigin").getData();o.splice(0,0,d[0]);o.splice(8,0,d[8]);this.getView().getModel("dataOrigin").setData(o)}this.getView().getModel("dataOrigin").setData(o);e.getSource().getParent().close();if(this.doiDisplayFlag){this.doiDisplayFlag=false}},onDonePress:function(e){var t=this;t.doneFlag=true;var i,n;var l=e.getSource().getId();if(t.viewName==="CreateFloc"||t.oModelUpdateFlag===true){t.handleValueState("Functionallocation","FunctionallocationVS",e);t.handleValueState("Flocdescription","FlocdescriptionVS",e);t.handleValueState("Floccategory","FloccategoryVS",e);t.handleValueState("Strucindicator","StrucindicatorVS",e);var o=t.getView().getModel(t.oModelName);var r=o.getData();if(r.Title!==""&&r.Title!==undefined||r.TitleCode!==""&&r.TitleCode!==undefined||r.Name1!==""&&r.Name1!==undefined||r.Name2!==""&&r.Name2!==undefined||r.Name3!==""&&r.Name3!==undefined||r.Name4!==""&&r.Name4!==undefined||r.Sort1!==""&&r.Sort1!==undefined||r.Sort2!==""&&r.Sort2!==undefined||r.NameCo!==""&&r.NameCo!==undefined||r.PostCod1!==""&&r.PostCod1!==undefined||r.City1!==""&&r.City1!==undefined||r.Building!==""&&r.Building!==undefined||r.Floor!==""&&r.Floor!==undefined||r.Roomnum!==""&&r.Roomnum!==undefined||r.AddrLocation!==""&&r.AddrLocation!==undefined||r.Strsuppl1!==""&&r.Strsuppl1!==undefined||r.Strsuppl2!==""&&r.Strsuppl2!==undefined||r.Strsuppl3!==""&&r.Strsuppl3!==undefined||r.TimeZone!==""&&r.TimeZone!==undefined||r.RefPosta!==""&&r.RefPosta!==undefined||r.Region!==""&&r.Region!==undefined){t.handleValueState("RefPosta","RefPostaVS",e);var s=this.getView().byId("idTBLIntlAddr").getItems();for(var d=0;d<s.length;d++){var c=s[d].getCells();for(var u=0;u<c.length;u++){if(c[3].getValueState()==="Error"){i=true}if(c[4].getValueState()==="Error"){n=true}}}}}if(t.doneFlag===false){var g=t.getView().getModel("i18n").getProperty("MANDMSG");t.invokeMessage(g);return}else if(i||n){var p=[];if(i){p.push("Enter valid state")}if(n){p.push("Enter valid city")}var f=p.join("\n");t.invokeMessage(f);return}else{var m=t.getView().getModel(t.oModelName);var S=m.getData();if(t.class.getModel()){var h=t.class.getModel().getData();if(h){S.classItems=[];for(var F=0;F<h.length;F++){S.classItems.push(h[F])}m.setData(S)}}if(this.chData){var M=this.chData;if(M!==null&&M!==undefined){S.characteristics=[];for(var v=0;v<M.length;v++){S.characteristics.push(M[v])}}m.setData(S)}if(this.lnrChData){var L=this.lnrChData;if(L!==null&&L!==undefined&&L.length>0){S.linearChar=[];for(var v=0;v<L.length;v++){S.linearChar.push(L[v])}}m.setData(S)}if(l.indexOf("idBtnCheck")>-1){this.validateCheck();return}this.chData=[];this.lnrChData=[];if(t.viewName==="CreateFloc"){var C=false;var V=sap.ui.getCore().getModel("dataOriginMOP").getData().FL;for(var A=0;A<V.length;A++){if(V[A].key===t.getView().getModel(t.oModelName).getData().Functionallocation){sap.ui.getCore().getModel("dataOriginMOP").getData().FL[A].DOI=t.getView().getModel("dataOrigin").getData();C=true;break}}if(!C){var D=this.rowIndex.split("/")[1];sap.ui.getCore().getModel("dataOriginMOP").getData().FL[D]={key:t.getView().getModel(t.oModelName).getData().Functionallocation,DOI:t.getView().getModel("dataOrigin").getData()}}this.dataDerivationFlow();var b=true}if(t.oModelUpdateFlag&&!t.sExistFlag){var N=sap.ui.getCore().getModel(t.oModelName).getData();t.getView().getModel(t.oModelName).getData().viewParameter="change";N.push(t.getView().getModel(t.oModelName).getData());sap.ui.getCore().getModel("dataOriginMOP").getData().FL.push({key:t.getView().getModel(t.oModelName).getData().Functionallocation,DOI:t.getView().getModel("dataOrigin").getData()})}sap.ui.getCore().getModel(t.oModelName).refresh();t.currentFragment=undefined;t.rowIndex=undefined;if(this.doiView){this.doiView.destroy();sap.ui.getCore().byId("il").destroy();sap.ui.getCore().byId("eq").destroy();sap.ui.getCore().byId("currVal").destroy();sap.ui.getCore().byId("targetVal").destroy();this.doiView=undefined}if(this.dataOriginFrag){this.dataOriginFrag.destroy();this.dataOriginFrag=undefined}if(!b){var T=a.getInstance().getPreviousHash();if(T!==undefined){history.go(-1)}else{t.getRouter().navTo("main",{},true)}}else{b=false}}},validateCheck:function(){var e=this;var t=this.getView().getModel("AIWFLOC").getData().Functionallocation;var a=sap.ui.getCore().getModel("AIWFLOC").getData();var n=sap.ui.getCore().getModel("AIWListWCModel").getData();var l=sap.ui.getCore().getModel("tempCrTypeModel").getData();var o={ChangeRequestType:l.crtype,CrDescription:l.desc,IsDraft:"C",Messages:[],FuncLoc:[],FLAddr:[],FLAddrI:[],FLALTLBEL:[],FLLAM:[],FLClass:[],FLVal:[],Equipment:[],EqAddr:[],EqAddrI:[],EqPRT:[],EqLAM:[],EqClass:[],EqVal:[],MSPoint:[],MSLAM:[],MSClass:[],MSVal:[],MPLAN:[],MPItem:[],MPLAM:[],MPOBList:[],MPCycle:[],MRBHeader:[],MRBItem:[],MRBSBIT:[],EBHeader:[],EBItem:[],EBSBIT:[],FBHeader:[],FBItem:[],FBSBIT:[],WBHeader:[],WBItem:[],WBSBIT:[],ONetwork:[],ONLAM:[],Workcenter:[],WCCost:[],GTList:[],GTOprs:[],GTComp:[],GTClass:[],GTVal:[],ETList:[],ETOprs:[],ETComp:[],ETClass:[],ETVal:[],FTList:[],FTOprs:[],FTComp:[],FTClass:[],FTVal:[],Olink:[],OLClass:[],OLVal:[],FLLAMCH:[]};if(a.length>0){for(var r=0;r<a.length;r++){var s={Tplnr:a[r].Functionallocation,Txtmi:a[r].Flocdescription,TplkzFlc:a[r].Strucindicator,Tplxt:a[r].StrucIndicatorDesc,EditMask:a[r].EditMask,Hierarchy:a[r].Hierarchy,Fltyp:a[r].Floccategory,Flttx:a[r].FlocCategoryDesc,Swerk:a[r].Maintplant,Plantname:a[r].MaintplantDesc,StorFloc:a[r].Location,Locationdesc:a[r].Locationdesc,Abckzfloc:a[r].Abckz,Abctx:a[r].Abctx,Bukrsfloc:a[r].Bukrs,Butxt:a[r].Butxt,City:a[r].City,KostFloc:a[r].Kostl,KokrFloc:a[r].Kokrs,Contareaname:a[r].Mctxt,PlntFloc:a[r].Werks,Planningplantdes:a[r].Planningplantdes,Ingrp:a[r].Ingrp,Plannergrpdesc:a[r].Innam,Arbplfloc:a[r].Arbpl,Wergwfloc:a[r].WcWerks,Gewrkfloc:a[r].MainArbpl,MainWcPlant:a[r].MainWerks,Tplma:a[r].SupFunctionallocation,Supflocdesc:a[r].SupFlocdescription,BeberFl:a[r].BeberFl,Fing:a[r].Fing,Tele:a[r].Tele,Submtiflo:a[r].ConstrType,Constdesc:a[r].ConstructionDesc,Eqart:a[r].TechnicalObjectTyp,Eartx:a[r].Description,Stattext:a[r].Stattext,StsmFloc:a[r].StsmEqui,Statproftxt:a[r].StsmEquiDesc,UstwFloc:a[r].UstwEqui,UswoFloc:a[r].UswoEqui,UstaFloc:a[r].UstaEqui,Adrnr:a[r].Adrnr,Adrnri:a[r].Adrnri,Deact:a[r].Deact,Modeldesc:a[r].Modeldesc,Modelref:a[r].Modelref,Modelrver:a[r].Modelrver,Modelext:a[r].Modelext,Modelname:a[r].Modelname,Modelver:a[r].Modelver};o.FuncLoc.push(s);var d={Funcloc:a[r].Functionallocation,Title:a[r].TitleCode,Name1:a[r].Name1,Name2:a[r].Name2,Name3:a[r].Name3,Name4:a[r].Name4,Sort1:a[r].Sort1,Sort2:a[r].Sort2,NameCo:a[r].NameCo,PostCod1:a[r].PostCod1,City1:a[r].City1,Building:a[r].Building,Floor:a[r].Floor,Roomnum:a[r].Roomnum,Strsuppl1:a[r].Strsuppl1,Strsuppl2:a[r].Strsuppl2,Strsuppl3:a[r].Strsuppl3,Location:a[r].AddrLocation,RPostafl:a[r].RefPosta,Landx:a[r].Landx,TimeZone:a[r].TimeZone,RPostFl:a[r].Region,Regiotxt:a[r].RegionDesc};o.FLAddr.push(d);var c=a[r].intlAddr;if(c){for(var u=0;u<c.length;u++){o.FLAddrI.push(c[u])}}if(a[r].altlbl){if(e.AltLblDerv==="2"&&a[r].altlbl.length>0){for(var g=0;g<a[r].altlbl.length;g++){var p={Funcloc:a[r].Functionallocation,AltAlkey:a[r].altlbl[g].AltAlkey,AltStrno:a[r].altlbl[g].AltStrno,AltTplkz:a[r].altlbl[g].AltTplkz};o.FLALTLBEL.push(p)}}}if(a[r].Floccategory==="L"&&a[r].lam){var f={Funcloc:a[r].Functionallocation,Lrpid:a[r].lam.Lrpid,Strtptatr:a[r].lam.Strtptatr,Endptatr:a[r].lam.Endptatr,Length:a[r].lam.Length,LinUnit:a[r].lam.LinUnit,Startmrkr:a[r].lam.Startmrkr,Endmrkr:a[r].lam.Endmrkr,Mrkdisst:a[r].lam.Mrkdisst,Mrkdisend:a[r].lam.Mrkdisend,MrkrUnit:a[r].lam.MrkrUnit};o.FLLAM.push(f)}var m=a[r].classItems;if(m){if(m.length>0){for(var S=0;S<m.length;S++){var h={Funcloc:a[r].Functionallocation,Classtype:m[S].Classtype,Class:m[S].Class,Clstatus1:m[S].Clstatus1};o.FLClass.push(h)}}}if(a[r].Functionallocation===t){var F=this.chData}else{var F=a[r].characteristics}if(F){if(F.length>0){for(var M=0;M<F.length;M++){var v={Funcloc:a[r].Functionallocation,Atnam:F[M].Atnam,Textbez:F[M].Textbez,Atwrt:F[M].Atwrt,Class:F[M].Class};o.FLVal.push(v)}}}if(a[r].Functionallocation===t){var L=this.lnrChData}else{var L=a[r].linearChar}if(L){if(L.length>0){var C=$.map(L,function(e){return $.extend(true,{},e)});for(var M=0;M<C.length;M++){delete C[M].linCharEnable;C[M].Funcloc=a[r].Functionallocation;o.FLLAMCH.push(C[M])}}}}}if(n.length>0){for(var V=0;V<n.length;V++){var A={Werks:n[V].plant,Arbpl:n[V].wc,Txtmi:n[V].wcDesc,Verwe:n[V].wcCat,Crveran:n[V].person,Planv:n[V].usg,Vgwts:n[V].stdVal,Crsteus:n[V].ctrlKey};if(n[V].hasOwnProperty("Type")){if(n[V].Type==="X"){A.Type="X"}}o.Workcenter.push(A);if(n[V].cost){for(var D=0;D<n[V].cost.length;D++){var b={Werks:n[V].cost[D].CrKokrs,Arbpl:n[V].wc,CrKostl:n[V].cost[D].CrKostl,Costcentxt:n[V].cost[D].Costcentxt,CrLstar:n[V].cost[D].CrLstar,Forn1:n[V].cost[D].Forn1,ActvttypeTxt:n[V].cost[D].ActvttypeTxt,Frmltxt:n[V].cost[D].Frmltxt};o.WCCost.push(b)}}}}this.getView().byId("flocPage").setBusy(true);var N=this.getView().getModel();if(o.FLAddrI.length>0){o.FLAddrI=$.map(o.FLAddrI,function(e){return $.extend(true,{},e)});for(var V=0;V<o.FLAddrI.length>0;V++){delete o.FLAddrI[V].AdNationEnable;delete o.FLAddrI[V].City1iVS;delete o.FLAddrI[V].StreetiVS}}N.create("/ChangeRequestSet",o,{success:function(t){e.getView().byId("flocPage").setBusy(false);var a=t;var n=[];for(var l=0;l<a.Messages.results.length;l++){n.push({type:i.getMessageType(a.Messages.results[l].Type),title:a.Messages.results[l].Message})}e.createMessagePopover(n,"")},error:function(t){e.getView().byId("flocPage").setBusy(false);var a=[],i=[];if(JSON.parse(t.responseText).error.innererror.errordetails===undefined||JSON.parse(t.responseText).error.innererror.errordetails.length===0){a[0]=JSON.parse(t.responseText).error.message.value}else{for(var n=0;n<JSON.parse(t.responseText).error.innererror.errordetails.length;n++){a[n]=JSON.parse(t.responseText).error.innererror.errordetails[n].message}}var l=a.join("\n");sap.m.MessageBox.show(l,{title:"Error",icon:sap.m.MessageBox.Icon.ERROR,onClose:function(){}})}})},_getMessagePopover:function(){if(!this._oMessagePopover){this._oMessagePopover=sap.ui.xmlfragment("ugieamui.mdg.eam.lib.popover.MessagePopover",this);this.getView().addDependent(this._oMessagePopover)}return this._oMessagePopover},handleMessagePopoverPress:function(e){this._getMessagePopover().openBy(e.getSource())},createMessagePopover:function(e,t){var a=[];var i,n=this._getMessagePopover();if(typeof e==="string"){a.push({type:t,title:e,message:e})}else{a=e;for(var l=0;l<a.length;l++){a[l].message=a[l].title}}sap.ui.getCore().getMessageManager().removeAllMessages();for(var l=0;l<a.length;l++){i=new c({message:a[l].message,type:a[l].type,target:"/Dummy",processor:this.getView().getModel()});sap.ui.getCore().getMessageManager().addMessages(i)}n.toggle(this.getView().byId("idMessagePopover"));this.getView().byId("idMessagePopover").setEnabled(true);this.getView().byId("idMessagePopover").setText(a.length+"")},handleAltLblAdd:function(){var e=this.getView().getModel(this.oModelName).getData();if(this.oModelName==="AIWFLOC"){var t={Funcloc:e.Functionallocation,AltAlkey:"",Altxt:"",AltStrno:"",AltTplkz:"",Tplxt:"",Name1i:"",Actvs:false,AltPrkey:false,AltReuse:false,enableLblSys:true,enableAltLbl:true,enableStrInd:true,LblSysVS:"None",AltLblVS:"None",StrIndVS:"None"}}e.altlbl.push(t);this.getView().getModel(this.oModelName).refresh()},handleAltLblDelete:function(e){var t=this;var a=e.getParameter("listItem").getBindingContext(this.oModelName).sPath;a=a.substring(a.lastIndexOf("/")+1);var i=e.getSource().getModel(this.oModelName).getData().altlbl;i.splice(a,1);this.getView().getModel(this.oModelName).refresh()},onLblSysVH:function(e){o.LblSysVH(e,this)},onStrIndAltLblVH:function(e){o.StrIndAltLblVH(e,this)},onLblSysChange:function(e){var t=this;var a=e.getSource().getValue();if(a!==""&&a!==undefined){e.getSource().setValue(a.toUpperCase());o._changeLblSys(e,t)}},onStrIndAltLblChange:function(e){var t=this;var a=e.getSource().getValue();if(a!==""&&a!==undefined){e.getSource().setValue(a.toUpperCase());o._changeStrIntAltLbl(e,t)}},onAltLblChange:function(e){var t=this;var a=e.getSource().getValue();var i=e.getSource().getBindingInfo("value").binding.getContext().sPath;var n=t.getView().getModel(t.oModelName);var l=n.getData();if(a!==""){var o=a.toUpperCase();e.getSource().setValue(o);this.validateAltLabel(i,n)}else{n.getProperty(i).AltLblVS="None";n.setData(l)}},validateAltLabel:function(e,t){var a=this;var i=this;var n=t.getProperty(e).AltStrno;var l=t.getProperty(e).AltTplkz;var o=t.getProperty(e).Tplxt;var r=t.getProperty(e).AltAlkey;var s=t.getData();if(n!==""&&l!==""){var d="/FLALTLBELSet(AltStrno='"+n+"',AltTplkz='"+l+"')";var c=a.getView().getModel();c.read(d,{success:function(a){t.getProperty(e).AltLblVS="None";if(r==="1"){var i=sap.ui.getCore().getModel("dataOriginMOP").getData().FL;for(var d=0;d<i.length;d++){if(i[d].key===s.Functionallocation){i[d].key=n;break}}s.Functionallocation=n;s.Strucindicator=l;s.StrucIndicatorDesc=o;if(s.lam){s.lam.Funcloc=n}if(s.altlbl){s.altlbl.forEach(function(e){e.Funcloc=n})}if(s.intlAddr){s.intlAddr.forEach(function(e){e.Funcloc=n})}}t.refresh()},error:function(a){var i=JSON.parse(a.responseText);var n=i.error.message.value;sap.m.MessageBox.show(n,{title:"Error",icon:sap.m.MessageBox.Icon.ERROR,onClose:function(){}});t.getProperty(e).AltLblVS="Error";t.refresh()}})}},onLblSysLiveChange:function(e){var t=this;var a=e.getSource().getValue();if(a===" "){e.getSource().setValue("")}if(a===""){var i=e.getSource().getBindingInfo("value").binding.getContext().sPath;var n=t.getView().getModel(t.oModelName);var l=n.getData();n.getProperty(i).Altxt="";n.setData(l)}e.getSource().setValueState("None")},onStrIndAltLblLiveChange:function(e){var t=this;var a=e.getSource().getValue();if(a===" "){e.getSource().setValue("")}if(a===""){var i=e.getSource().getBindingInfo("value").binding.getContext().sPath;var n=t.getView().getModel(t.oModelName);var l=n.getData();n.getProperty(i).Tplxt="";n.getProperty(i).Name1i="";n.setData(l)}e.getSource().setValueState("None")},validateLabelSystem:function(e,t){var a=this;var i=parseInt(e.split("/")[2]);var n=false;var l=t.altlbl;for(var o=0;o<l.length;o++){if(o===i){continue}if(l[o].AltAlkey===l[i].AltAlkey){n=true;sap.m.MessageBox.show("There is already an entry with the same key information",{title:"Error",icon:sap.m.MessageBox.Icon.ERROR,onClose:function(){l[i].AltAlkey="";l[i].Altxt="";l[i].LblSysVS="None";a.getView().getModel(a.oModelName).refresh()}});break}}if(!n){l[i].enableLblSys=false;l[i].LblSysVS="None";a.getView().getModel(a.oModelName).refresh()}},onDataOriginPress:function(e){var a=this;if(!this.dataOriginFrag){this.dataOriginFrag=sap.ui.xmlfragment("ugieamui.mdg.eam.lib.doi.DOIElement",this)}var i={flocVisible:true,equiVisible:true,parent:"",parentDesc:"",parentSelected:false,IndvSelected:false,currentObj:"",currentObjDesc:"",DOIindex:null};var n=new t(i);this.dataOriginFrag.setModel(n,"doiElement");var l=this.getView().getModel(this.oModelName).getData();var r=this.getView().getModel("dataOrigin").getData();i.flocVisible=true;i.equiVisible=false;var s=e.getSource(),d,c=this.dataOriginFrag.getContent()[0].getContent()[1],u=this.dataOriginFrag.getContent()[0].getContent()[2],g=this.dataOriginFrag.getContent()[0].getContent()[4],p=this.dataOriginFrag.getContent()[0].getContent()[5],f=this.dataOriginFrag.getContent()[0].getContent()[7],m=this.dataOriginFrag.getContent()[0].getContent()[8];f.mEventRegistry.valueHelpRequest=[];if(s.getId().includes("MaintenancePlant")){this.dataOriginFrag.setTitle("Data Orgin - "+this.getView().getModel("i18n").getProperty("MAINT_PLANT"));d=this.getView().byId("idMaintenancePlant").getValue();f.setShowValueHelp(true);f.attachValueHelpRequest(function(e){this.onMaintPlantVH("idMaintenancePlant",e)});if(d===""){c.setEnabled(false);u.setEnabled(false);g.setEnabled(false);p.setEnabled(false)}i.parent=r[0].SupFlVal;i.parentDesc=r[0].Txtmi;i.DOIindex=0;if(r[0].maintenance===true){i.parentSelected=false;i.IndvSelected=true}else if(r[0].instLoc===true){i.parentSelected=true;i.IndvSelected=false}}else if(s.getId().includes("Location")){this.dataOriginFrag.setTitle("Data Orgin - "+this.getView().getModel("i18n").getProperty("LOC"));d=this.getView().byId("idLocation").getValue();f.setShowValueHelp(true);f.attachValueHelpRequest(function(e){o.onDOILocationVH(a,e)});if(d===""){c.setEnabled(false);u.setEnabled(false);g.setEnabled(false);p.setEnabled(false)}i.parent=r[1].SupFlVal;i.parentDesc=r[1].Txtmi;i.DOIindex=1;if(r[1].maintenance===true){i.parentSelected=false;i.IndvSelected=true}else if(r[1].instLoc===true){i.parentSelected=true;i.IndvSelected=false}}else if(s.getId().includes("abcInd")){this.dataOriginFrag.setTitle("Data Orgin - "+this.getView().getModel("i18n").getProperty("ABC_IND"));d=this.getView().byId("idAbcInd").getValue();f.setShowValueHelp(true);f.attachValueHelpRequest(function(e){o.onDOIabcIndVH(a,e)});if(d===""){c.setEnabled(false);u.setEnabled(false);g.setEnabled(false);p.setEnabled(false)}i.parent=r[4].SupFlVal;i.parentDesc=r[4].Txtmi;i.DOIindex=4;if(r[4].maintenance===true){i.parentSelected=false;i.IndvSelected=true}else if(r[4].instLoc===true){i.parentSelected=true;i.IndvSelected=false}}else if(s.getId().includes("PlantSec")){this.dataOriginFrag.setTitle("Data Orgin - "+this.getView().getModel("i18n").getProperty("PL_SEC"));d=this.getView().byId("idPlntSec").getValue();f.setShowValueHelp(true);f.attachValueHelpRequest(function(e){o.onDOIPlantSecVH(a,e)});if(d===""){c.setEnabled(false);u.setEnabled(false);g.setEnabled(false);p.setEnabled(false)}i.parent=r[2].SupFlVal;i.parentDesc=r[2].Txtmi;i.DOIindex=2;if(r[2].maintenance===true){i.parentSelected=false;i.IndvSelected=true}else if(r[2].instLoc===true){i.parentSelected=true;i.IndvSelected=false}}else if(s.getId().includes("WorkCen")){this.dataOriginFrag.setTitle("Data Orgin - "+this.getView().getModel("i18n").getProperty("WC"));d=this.getView().byId("idWorkCen").getValue();f.setShowValueHelp(true);f.attachValueHelpRequest(function(e){o.onDOIMainwcVH(a,e)});if(d===""){c.setEnabled(false);u.setEnabled(false);g.setEnabled(false);p.setEnabled(false)}i.parent=r[3].SupFlVal;i.parentDesc=r[3].Txtmi;i.DOIindex=3;if(r[3].maintenance===true){i.parentSelected=false;i.IndvSelected=true}else if(r[3].instLoc===true){i.parentSelected=true;i.IndvSelected=false}}else if(s.getId().includes("CostCenter")){this.dataOriginFrag.setTitle("Data Orgin - "+this.getView().getModel("i18n").getProperty("CC"));d=this.getView().byId("idCostCtr").getValue();f.setShowValueHelp(true);f.attachValueHelpRequest(function(e){o.onDOICostCenterVH(a,e)});if(d===""){c.setEnabled(false);u.setEnabled(false);g.setEnabled(false);p.setEnabled(false)}i.parent=r[6].SupFlVal;i.parentDesc=r[6].Txtmi;i.DOIindex=6;if(r[6].maintenance===true){i.parentSelected=false;i.IndvSelected=true}else if(r[6].instLoc===true){i.parentSelected=true;i.IndvSelected=false}}else if(s.getId().includes("PlanPlant")){this.dataOriginFrag.setTitle("Data Orgin - "+this.getView().getModel("i18n").getProperty("PLAN_PLANT_TXT"));d=this.getView().byId("idPlnPlnt").getValue();f.setShowValueHelp(true);f.attachValueHelpRequest(function(e){o.onDOIPlanPlantVH(a,e)});if(d===""){c.setEnabled(false);u.setEnabled(false);g.setEnabled(false);p.setEnabled(false)}i.parent=r[8].SupFlVal;i.parentDesc=r[8].Txtmi;i.DOIindex=8;if(r[8].maintenance===true){i.parentSelected=false;i.IndvSelected=true}else if(r[8].instLoc===true){i.parentSelected=true;i.IndvSelected=false}}else if(s.getId().includes("PlanGrp")){this.dataOriginFrag.setTitle("Data Orgin - "+this.getView().getModel("i18n").getProperty("PL_GRP"));d=this.getView().byId("idPlnGrp").getValue();f.setShowValueHelp(true);f.attachValueHelpRequest(function(e){o.onDOIPlanrGrpVH(a,e)});if(d===""){c.setEnabled(false);u.setEnabled(false);g.setEnabled(false);p.setEnabled(false)}i.parent=r[9].SupFlVal;i.parentDesc=r[9].Txtmi;i.DOIindex=9;if(r[9].maintenance===true){i.parentSelected=false;i.IndvSelected=true}else if(r[9].instLoc===true){i.parentSelected=true;i.IndvSelected=false}}else if(s.getId().includes("MainWC")){this.dataOriginFrag.setTitle("Data Orgin - "+this.getView().getModel("i18n").getProperty("mainWorkCenter"));d=this.getView().byId("idMainWC").getValue();f.setShowValueHelp(true);f.attachValueHelpRequest(function(e){o.onDOIMainwcVH(a,e)});if(d===""){c.setEnabled(false);u.setEnabled(false);g.setEnabled(false);p.setEnabled(false)}i.parent=r[10].SupFlVal;i.parentDesc=r[10].Txtmi;i.DOIindex=10;if(r[10].maintenance===true){i.parentSelected=false;i.IndvSelected=true}else if(r[10].instLoc===true){i.parentSelected=true;i.IndvSelected=false}}if(i.parent===""){u.setEnabled(false);p.setEnabled(false)}else{u.setEnabled(true);p.setEnabled(true)}i.currentObj=d;n=new t(i);this.dataOriginFrag.setModel(n,"doiElement");this.dataOriginFrag.open()},onCheckSelect:function(e){var t=e.getSource().getId();var a=this.dataOriginFrag.getModel("doiElement");var i=a.getData();if(t.includes("IndvMaint")){i.parentSelected=false;i.IndvSelected=true}else{i.parentSelected=true;i.IndvSelected=false}this.dataOriginFrag.setModel(a,"doiElement")},onElementActionPress:function(e){var t,a,i;var n=this.dataOriginFrag.getModel("doiElement");var l=n.getData();var o=this.getView().getModel(this.oModelName).getData();var r=this.getView().getModel("dataOrigin").getData();if(l.IndvSelected){r[l.DOIindex].instLoc=false;r[l.DOIindex].maintenance=true;r[l.DOIindex].currentVal=l.currentObj;t=l.currentObj;a=l.currentObjDesc;i=l.currentObjDesc2!==undefined?l.currentObjDesc2:""}else if(l.parentSelected){r[l.DOIindex].instLoc=true;r[l.DOIindex].maintenance=false;r[l.DOIindex].currentVal=l.parent;t=l.parent;a=l.parentDesc;i=l.currentObjDesc2!==undefined?l.currentObjDesc2:""}if(l.DOIindex===1){o.Location=t;o.Locationdesc=a}if(l.DOIindex===2){o.BeberFl=t;o.Fing=a;o.Tele=i}if(l.DOIindex===3){o.Arbpl=t;o.Ktext=a}if(l.DOIindex===4){o.Abckz=t;o.Abctx=a}if(l.DOIindex===6){o.Kostl=t;o.Kokrs=a;o.Mctxt=i}if(l.DOIindex===10){o.MainArbpl=t;o.MainKtext=a;o.MainWerks=i}if(l.DOIindex===9){o.Ingrp=t;o.Innam=a}if(l.DOIindex===8){o.Werks=t;o.Planningplantdes=a}this.getView().getModel("dataOrigin").setData(r);this.getView().getModel("dataOrigin").refresh();this.getView().getModel(this.oModelName).refresh();e.getSource().getParent().close()},onElementCancelPress:function(e){e.getSource().getParent().close()},onLinkAinPress:function(e){if(!this.doiView){this.doiView=sap.ui.xmlfragment("ugieamui.mdg.eam.lib.doi.DataOrigin",this)}this.doiView.open()},handleLinearCharRowAdd:function(){this.addLinearChar(this.oModelName)},handleLinearCharRowDelete:function(e){this.deleteLinearChar(e,this.oModelName)}})});