sap.ui.define(["ugiaiwui/mdg/aiw/request/controller/BaseController","sap/ui/model/json/JSONModel","ugiaiwui/mdg/aiw/request/model/formatter","sap/ui/core/routing/History","ugiaiwui/mdg/aiw/library/js/ValueHelpProvider","sap/ui/core/message/Message","sap/m/BusyDialog","ugiaiwui/mdg/aiw/request/util/ValueHelpRequest"],function(e,t,r,a,s,n,o,l){"use strict";return e.extend("ugiaiwui.mdg.aiw.request.controller.TLPRTDetail",{formatter:r,onInit:function(){var e,r=new t({busy:true,delay:0});this.getRouter().getRoute("tlPRT").attachPatternMatched(this._onObjectMatched,this);e=this.getView().getBusyIndicatorDelay();this.setModel(r,"objectView");this.getOwnerComponent().getModel().metadataLoaded().then(function(){r.setProperty("/delay",e)});var a=sap.ui.component(sap.ui.core.Component.getOwnerIdFor(this.getView()));var s=a.getModel();s.setDefaultCountMode(sap.ui.model.odata.CountMode.None);this.getView().setModel(s);var n=a.getModel("NewModel");this.getView().setModel(n,"valueHelp");var o=a.getModel("NewModel2");this.getView().setModel(o,"valueHelp2")},onNavBack:function(){window.history.go(-1)},_onObjectMatched:function(e){var t=new sap.ui.model.json.JSONModel;var r=sap.ui.getCore().getModel("tlDetailModel");t.setData(r.getProperty(decodeURIComponent(e.getParameter("arguments").itemPath)));this.setModel(t,"prtModel");this.getView().bindElement({path:decodeURIComponent(e.getParameter("arguments").itemPath),model:"prtModel"})},onLiveChange:function(e){if(e.getSource().getValue()===" "){e.getSource().setValue("")}e.getSource().setValueState("None")},onPRTMaterialVH:function(e){var t=this;var r=t.getView().getModel("valueHelp2");var a=this.getModel("prtModel");var s=a.getData();var n=new sap.m.TableSelectDialog({title:"Material",noDataText:this.getView().getModel("i18n").getProperty("LOAD")+"...",growing:true,growingThreshold:20,columns:[new sap.m.Column({header:[new sap.m.Text({text:"{i18n>DESCRIPTION}"})]}),new sap.m.Column({demandPopin:true,minScreenWidth:"Tablet",header:[new sap.m.Text({text:"{i18n>LANGUAGE}"})]}),new sap.m.Column({demandPopin:true,minScreenWidth:"Tablet",header:[new sap.m.Text({text:"{i18n>MAT}"})]})],items:{path:"/MaterialVH_PRTSet",template:new sap.m.ColumnListItem({type:"Active",unread:false,cells:[new sap.m.Text({text:"{Maktg}"}),new sap.m.Text({text:"{Spras}"}),new sap.m.Text({text:"{Matnr}"})]})},confirm:function(e){s.PRT=e.getParameter("selectedItem").getCells()[2].getText();s.PRTDesc=e.getParameter("selectedItem").getCells()[0].getText();s.Mat=e.getParameter("selectedItem").getCells()[2].getText();s.MatDesc=e.getParameter("selectedItem").getCells()[0].getText();s.PRTVS="None";a.refresh();t.deriveMatPlant(s.PRT)},liveChange:function(e){var t=e.getParameter("value").toUpperCase();t=t.replace(/^[ ]+|[ ]+$/g,"");var r=n.getItems();for(var a=0;a<r.length;a++){if(t.length>0){var s=r[a].getBindingContext().getProperty("Maktg");var o=r[a].getBindingContext().getProperty("Matnr");if(s.toUpperCase().indexOf(t)===-1&&o.toUpperCase().indexOf(t)===-1){r[a].setVisible(false)}else{r[a].setVisible(true)}}else{r[a].setVisible(true)}}}});var r=this.getView().getModel("valueHelp");n.setModel(r);n.setModel(t.getView().getModel("i18n"),"i18n");n.open()},onPRTMaterialChange:function(e){var t=this;var r=e.getParameters().newValue;var a=this.getModel("prtModel");var s=a.getData();var n=this.getView().getModel("valueHelp");var o=r.toUpperCase();var l="/MaterialVH_PRTSet";var i=new sap.ui.model.Filter("Matnr","EQ",o);var n=this.getView().getModel("valueHelp");n.read(l,{filters:[i],success:function(e){if(e.results.length>0){s.PRT=e.results[0].Matnr;s.PRTDesc=e.results[0].Maktg;s.Mat=e.results[0].Matnr;s.MatDesc=e.results[0].Maktg;s.PRTVS="None";a.refresh();t.deriveMatPlant(s.Mat)}else{s.PRT="";s.PRTDesc="";s.MatDesc="";s.PRTVS="Error";a.refresh()}},error:function(e){var t=JSON.parse(e.responseText);var r=t.error.message.value;s.PRTVS="Error";a.refresh()}})},deriveMatPlant:function(e){var t=this;var r=this.getModel("prtModel");var a=r.getData();var s="/MatPlantSet";var n=new sap.ui.model.Filter("Matnr","EQ",e);var o=this.getView().getModel("valueHelp2");o.read(s,{filters:[n],success:function(e){if(e.results.length>0){a.Plant=e.results[0].Werks;a.PlantVS="None";r.refresh();t.derivePRTdata()}else{a.PlantVS="Error";r.refresh()}},error:function(e){var t=JSON.parse(e.responseText);var s=t.error.message.value;a.PlantVS="Error";r.refresh()}})},derivePRTdata:function(){var e=this;var t=this.getModel("prtModel");var r=t.getData();var a="/TLPRTDeriveSet";var s=[];if(r.ItmCat==="M"){s.push(new sap.ui.model.Filter("Matnr","EQ",r.Mat));s.push(new sap.ui.model.Filter("Fhwrk","EQ",r.Plant));s.push(new sap.ui.model.Filter("Fhmar","EQ",r.ItmCat))}else if(r.ItmCat==="D"){s.push(new sap.ui.model.Filter("Doknr","EQ",r.Mat));s.push(new sap.ui.model.Filter("Dokar","EQ",r.docType));s.push(new sap.ui.model.Filter("Dokvr","EQ",r.docPart));s.push(new sap.ui.model.Filter("Doktl","EQ",r.docVersion));s.push(new sap.ui.model.Filter("Fhmar","EQ",r.ItmCat))}else if(r.ItmCat==="O"){s.push(new sap.ui.model.Filter("Doknr","EQ",r.Mat));s.push(new sap.ui.model.Filter("Fhmar","EQ","S"))}var n=this.getView().getModel("valueHelp2");n.read(a,{filters:s,success:function(e){if(e.results.length>0){r.Qty=e.results[0].Mgvgw;r.UOM=e.results[0].Mgeinh;r.QtyFrmla=e.results[0].Mgform;r.PRTCtrl=e.results[0].Steuf;r.PRTCtrlDesc=e.results[0].Stftxt;r.QtyVS="None";r.UOMVS="None";r.QtyFrmlaVS="None";r.PRTCtrlVS="None";r.StdUsgVal=e.results[0].Ewvgw;r.StdUsgUOM=e.results[0].Eweinh;r.UsgValFrmla=e.results[0].Ewform;r.StdUsgValVS="None";r.StdUsgUOMVS="None";r.UsgValFrmlaVS="None";t.refresh()}},error:function(e){var t=JSON.parse(e.responseText);var r=t.error.message.value}})},onPRTEquipmentVH:function(e){var t=this;var r=t.getView().getModel("valueHelp2");var a=this.getModel("prtModel");var s=a.getData();var n=new sap.m.SelectDialog({title:"{i18n>EQUI_TXT}",noDataText:"{i18n>LOAD}"+"...",confirm:function(e){s.PRT=e.getParameters().selectedItem.getProperty("title");s.PRTDesc=e.getParameters().selectedItem.getProperty("description");s.Equi=e.getParameters().selectedItem.getProperty("title");s.EquiDesc=e.getParameters().selectedItem.getProperty("description");s.PRTVS="None";a.refresh()},search:function(e){var t=e.getParameter("value");e.getSource().getBinding("items").filter(!t?[]:[new sap.ui.model.Filter([new sap.ui.model.Filter("Equnr",sap.ui.model.FilterOperator.Contains,t),new sap.ui.model.Filter("Eqktu",sap.ui.model.FilterOperator.Contains,t)],false)])}});var o="/EquipPRTSet";r.read(o,{success:function(e,t){var r=sap.ui.getCore().getModel("AIWEQUI").getData();if(r.length>0){for(var a=0;a<r.length;a++){if(r[a].Equnr){var s={Equnr:r[a].Equnr,Eqktu:r[a].Eqktx};e.results.unshift(s)}}}if(e.results.length>0){var o=new sap.m.StandardListItem({title:"{Equnr}",description:"{Eqktu}",active:true});var l=new sap.ui.model.json.JSONModel;l.setData(e);l.isSizeLimit=e.results.length;l.setSizeLimit(e.results.length);n.setModel(l);n.setGrowingThreshold(e.results.length);n.bindAggregation("items","/results",o)}else{n.setNoDataText(n.getModel("i18n").getProperty("NO_DATA"))}}});n.open()},onPRTEquipmentChange:function(e){var t=this;var r=e.getParameters().newValue;var a=r.toUpperCase();var s=this.getModel("prtModel");var n=s.getData();var o=sap.ui.getCore().getModel("AIWEQUI").getData();if(o.length>0){for(var l=0;l<o.length;l++){if(o[l].Equnr===a){n.PRT=o[l].Equnr;n.PRTDesc=o[l].Eqktx;n.Equi=o[l].Equnr;n.EquiDesc=o[l].Eqktx;n.PRTVS="None";s.refresh();return}}}var i="/EquipPRTSet";var u=new sap.ui.model.Filter("Equnr","EQ",a);var m=this.getView().getModel("valueHelp2");m.read(i,{filters:[u],success:function(e){if(e.results.length>0){n.PRT=e.results[0].Equnr;n.PRTDesc=e.results[0].Eqktu;n.Equi=e.results[0].Equnr;n.EquiDesc=e.results[0].Eqktu;n.PRTVS="None";s.refresh()}else{n.PRT="";n.PRTDesc="";n.EquiDesc="";n.PRTVS="Error";s.refresh()}},error:function(e){var t=JSON.parse(e.responseText);var r=t.error.message.value;n.PRTVS="Error";s.refresh()}})},onPRTDocumentVH:function(e){var t=this;var r=t.getView().getModel("valueHelp2");var a=this.getModel("prtModel");var n=a.getData();var o={title:t.getView().getModel("i18n").getProperty("DOC"),noDataText:t.getView().getModel("i18n").getProperty("LOAD")+"...",columns:[new sap.m.Column({header:[new sap.m.Text({text:"{i18n>DOC}"})]}),new sap.m.Column({demandPopin:true,minScreenWidth:"Tablet",header:[new sap.m.Text({text:"{i18n>DOC_TYP}"})]}),new sap.m.Column({demandPopin:true,minScreenWidth:"Tablet",header:[new sap.m.Text({text:"{i18n>DOC_PART}"})]}),new sap.m.Column({demandPopin:true,minScreenWidth:"Tablet",header:[new sap.m.Text({text:"{i18n>DOC_VER}"})]}),new sap.m.Column({demandPopin:true,minScreenWidth:"Tablet",header:[new sap.m.Text({text:"{i18n>DESCRIPTION}"})]}),new sap.m.Column({demandPopin:true,minScreenWidth:"Tablet",header:[new sap.m.Text({text:"Doc.Type Desc."})]})],items:{path:"/DocPrtSet",template:new sap.m.ColumnListItem({type:"Active",unread:false,cells:[new sap.m.Text({text:"{Doknr}"}),new sap.m.Text({text:"{Dokar}"}),new sap.m.Text({text:"{Doktl}"}),new sap.m.Text({text:"{Dokvr}"}),new sap.m.Text({text:"{Dktxt}"}),new sap.m.Text({text:"{dartxt}"})]})},confirm:function(e){n.doc=e.getParameter("selectedItem").getCells()[0].getText();n.docDesc=e.getParameter("selectedItem").getCells()[4].getText();n.docType=e.getParameter("selectedItem").getCells()[1].getText();n.docTypeDesc=e.getParameter("selectedItem").getCells()[5].getText();n.docPart=e.getParameter("selectedItem").getCells()[2].getText();n.docVersion=e.getParameter("selectedItem").getCells()[3].getText();n.PRT=n.doc+"-"+n.docType+"-"+n.docPart+"-"+n.docVersion;n.PRTDesc="";n.PRTVS="None";a.refresh();t.derivePRTdata()}};var l="/DocPrtSet";var i=[];var u=t.getView().getModel("valueHelp2");var m=[new sap.m.Text({text:"{Doknr}"}),new sap.m.Text({text:"{Dokar}"}),new sap.m.Text({text:"{Doktl}"}),new sap.m.Text({text:"{Dokvr}"}),new sap.m.Text({text:"{Dktxt}"}),new sap.m.Text({text:"{dartxt}"})];var p=s.getValueHelp(u,l,m,i,o,"Doknr","Dktxt");p.open();p.setModel(t.getView().getModel("i18n"),"i18n")},onPRTDocumentChange:function(e){var t=this;var r=e.getParameters().newValue;var a=this.getModel("prtModel");var s=a.getData();var n=this.getView().getModel("valueHelp2");var o=r.toUpperCase();var l="/DocPrtSet";var i=new sap.ui.model.Filter("Doknr","EQ",o);var n=this.getView().getModel("valueHelp2");n.read(l,{filters:[i],success:function(e){if(e.results.length>0){s.doc=e.results[0].Matnr;s.docDesc=e.results[0].Maktg;s.docType=e.results[0].Dokar;s.docTypeDesc=e.results[0].dartxt;s.docPart=e.results[0].Doktl;s.docVersion=e.results[0].Dokvr;s.PRT=s.doc+"-"+s.docType+"-"+s.docPart+"-"+s.docVersion;s.PRTVS="None";a.refresh();t.derivePRTdata()}else{s.PRT="";s.PRTDesc="";s.PRTVS="Error";s.docType="";s.docTypeDesc="";s.docPart="";s.docVersion="";a.refresh()}},error:function(e){var t=JSON.parse(e.responseText);var r=t.error.message.value;s.PRT="";s.PRTVS="Error";s.docType="";s.docTypeDesc="";s.docPart="";s.docVersion="";a.refresh()}})},onPRTOthersVH:function(e){var t=this;var r=this.getModel("prtModel");var a=r.getData();var n={title:"Prod. Resource Tools",noDataText:t.getView().getModel("i18n").getProperty("LOAD")+"...",columns:[new sap.m.Column({header:[new sap.m.Text({text:"PRT"})]}),new sap.m.Column({demandPopin:true,minScreenWidth:"Tablet",header:[new sap.m.Text({text:"Description"})]}),new sap.m.Column({demandPopin:true,minScreenWidth:"Tablet",header:[new sap.m.Text({text:"Grouping Key 1"})]}),new sap.m.Column({demandPopin:true,minScreenWidth:"Tablet",header:[new sap.m.Text({text:"Grouping Key 2"})]})],items:{path:"/OtherPRTSet",template:new sap.m.ColumnListItem({type:"Active",unread:false,cells:[new sap.m.Text({text:"{Sfhnr}"}),new sap.m.Text({text:"{KtextUp}"}),new sap.m.Text({text:"{Fgru1}"}),new sap.m.Text({text:"{Fgru2}"})]})},confirm:function(e){a.PRT=e.getParameter("selectedItem").getCells()[0].getText();a.PRTDesc=e.getParameter("selectedItem").getCells()[1].getText();a.Othr=e.getParameter("selectedItem").getCells()[0].getText();a.OthrDesc=e.getParameter("selectedItem").getCells()[1].getText();a.PRTVS="None";r.refresh();t.derivePRTdata()}};var o="/OtherPRTSet";var l=[];var i=t.getView().getModel("valueHelp2");var u=[new sap.m.Text({text:"{Sfhnr}"}),new sap.m.Text({text:"{KtextUp}"}),new sap.m.Text({text:"{Fgru1}"}),new sap.m.Text({text:"{Fgru2}"})];var m=s.getValueHelp(i,o,u,l,n,"Sfhnr","KtextUp");m.open();m.setModel(t.getView().getModel("i18n"),"i18n")},onPRTOthersChange:function(e){var t=this;var r=e.getParameters().newValue;var a=this.getModel("prtModel");var s=a.getData();var n=this.getView().getModel("valueHelp2");var o=r.toUpperCase();var l="/OtherPRTSet";var i=new sap.ui.model.Filter("Sfhnr","EQ",o);var n=this.getView().getModel("valueHelp2");n.read(l,{filters:[i],success:function(e){if(e.results.length>0){s.PRT=e.results[0].Sfhnr;s.PRTDesc=e.results[0].KtextUp;s.Othr=e.results[0].Sfhnr;s.OthrDesc=e.results[0].KtextUp;s.PRTVS="None";a.refresh();t.derivePRTdata()}else{s.PRT="";s.PRTDesc="";s.OthrDesc="";s.PRTVS="Error";a.refresh()}},error:function(e){var t=JSON.parse(e.responseText);var r=t.error.message.value;s.PRTVS="Error";a.refresh()}})},onPRTMSPTVH:function(e){var t=this;var r=t.getView().getModel("valueHelp2");var a=this.getModel("prtModel");var s=a.getData();var n=new sap.m.TableSelectDialog({title:"Measuring Point",noDataText:t.getView().getModel("i18n").getProperty("LOAD")+"...",columns:[new sap.m.Column({header:[new sap.m.Text({text:"Measuring Point"})]}),new sap.m.Column({demandPopin:true,minScreenWidth:"Tablet",header:[new sap.m.Text({text:"Meas. Description"})]}),new sap.m.Column({demandPopin:true,minScreenWidth:"Tablet",header:[new sap.m.Text({text:"Equipment"})]}),new sap.m.Column({demandPopin:true,minScreenWidth:"Tablet",header:[new sap.m.Text({text:"Functional Location"})]}),new sap.m.Column({demandPopin:true,minScreenWidth:"Tablet",header:[new sap.m.Text({text:"Description"})]})],items:{path:"/DocPrtSet",template:new sap.m.ColumnListItem({type:"Active",unread:false,cells:[new sap.m.Text({text:"{Point}"}),new sap.m.Text({text:"{Pttxt}"}),new sap.m.Text({text:"{Equnr}"}),new sap.m.Text({text:"{Tplnr}"}),new sap.m.Text({text:"{Descr}"})]})},confirm:function(e){s.PRT=e.getParameter("selectedItem").getCells()[0].getText();s.PRTDesc=e.getParameter("selectedItem").getCells()[1].getText();s.Mspt=e.getParameter("selectedItem").getCells()[0].getText();s.MsptDesc=e.getParameter("selectedItem").getCells()[1].getText();s.PRTVS="None";a.refresh()}});var o="";var l="";var i=sap.ui.getCore().getModel("tlDetailModel").getData();for(var u in i.lOperation){if(i.lOperation[u].Vornr===s.Vornr){o=i.lOperation[u].equi;l=i.lOperation[u].floc;break}}var m="/MsptPrtVHSet";var p=[new sap.ui.model.Filter("Tplnr","EQ",l),new sap.ui.model.Filter("Equnr","EQ",o)];var g=t.getView().getModel("valueHelp2");g.read(m,{filters:p,success:function(e,t){var r=sap.ui.getCore().getModel("AIWMSPT").getData();if(r.length>0){for(var a=0;a<r.length;a++){if(r[a].Mspoint){var s={Point:r[a].Mspoint,Pttxt:r[a].Pttxt};if(r[a].ObtypMs==="IEQ"){s.Equnr=r[a].Equnr;s.Descr=r[a].Eqktx;s.Tplnr=""}else if(r[a].ObtypMs==="IFL"){s.Equnr="";s.Descr=r[a].Pltxt;s.Tplnr=r[a].Tplnr}e.results.unshift(s)}}}if(e.results.length>0){var o=new sap.m.ColumnListItem({type:"Active",unread:false,cells:[new sap.m.Text({text:"{Point}"}),new sap.m.Text({text:"{Pttxt}"}),new sap.m.Text({text:"{Equnr}"}),new sap.m.Text({text:"{Tplnr}"}),new sap.m.Text({text:"{Descr}"})]});var l=new sap.ui.model.json.JSONModel;l.setData(e);l.isSizeLimit=e.results.length;l.setSizeLimit(e.results.length);n.setModel(l);n.setGrowingThreshold(e.results.length);n.bindAggregation("items","/results",o)}else{n.setNoDataText(n.getModel("i18n").getProperty("NO_DATA"))}}});n.open()},onPRTMSPTChange:function(e){var t=this;var r=e.getParameters().newValue;var a=this.getModel("prtModel");var s=a.getData();var n=this.getView().getModel("valueHelp2");var o=r.toUpperCase();var l=sap.ui.getCore().getModel("AIWMSPT").getData();if(l.length>0){for(var i=0;i<l.length;i++){if(l[i].Mspoint===o){s.PRT=l[i].Mspoint;s.PRTDesc=l[i].Pttxt;s.Mspt=l[i].Mspoint;s.MsptDesc=l[i].Pttxt;s.PRTVS="None";a.refresh();return}}}var u="/MsptPrtVHSet";var m=[new sap.ui.model.Filter("Tplnr","EQ",oprFloc),new sap.ui.model.Filter("Equnr","EQ",oprEqui),new sap.ui.model.Filter("Point","EQ",o)];var n=this.getView().getModel("valueHelp2");n.read(u,{filters:m,success:function(e){if(e.results.length>0){s.PRT=e.results[0].Point;s.PRTDesc=e.results[0].Pttxt;s.Mspt=e.results[0].Point;s.MsptDesc=e.results[0].Pttxt;s.PRTVS="None";a.refresh()}else{s.PRT="";s.PRTDesc="";s.MsptDesc="";s.PRTVS="Error";a.refresh()}},error:function(e){var t=JSON.parse(e.responseText);var r=t.error.message.value;s.PRTVS="Error";a.refresh()}})},onPRTCtrlVH:function(e){var t=this;var r=t.getView().getModel("valueHelp2");var a=this.getModel("prtModel");var n=a.getData();var o={title:"Control Key",noDataText:"{i18n>LOAD}"+"...",columns:[new sap.m.Column({header:[new sap.m.Text({text:"PRT Control Profile"})]}),new sap.m.Column({demandPopin:true,minScreenWidth:"Tablet",header:[new sap.m.Text({text:"Schedule"})]}),new sap.m.Column({demandPopin:true,minScreenWidth:"Tablet",header:[new sap.m.Text({text:"Calculate"})]}),new sap.m.Column({demandPopin:true,minScreenWidth:"Tablet",header:[new sap.m.Text({text:"Control"})]}),new sap.m.Column({demandPopin:true,minScreenWidth:"Tablet",header:[new sap.m.Text({text:"Print"})]}),new sap.m.Column({demandPopin:true,minScreenWidth:"Tablet",header:[new sap.m.Text({text:"Expand"})]}),new sap.m.Column({demandPopin:true,minScreenWidth:"Tablet",header:[new sap.m.Text({text:"Ctrl Key Text"})]})],items:{path:"/PrtCtlProfSet",template:new sap.m.ColumnListItem({type:"Active",unread:false,cells:[new sap.m.Text({text:"{Steuf}"}),new sap.m.Text({text:"{path:'Xterm', formatter:'.formatter.truetoX'}"}),new sap.m.Text({text:"{path:'Xkalk', formatter:'.formatter.truetoX'}"}),new sap.m.Text({text:"{path:'Xrueck', formatter:'.formatter.truetoX'}"}),new sap.m.Text({text:"{path:'Xdruck', formatter:'.formatter.truetoX'}"}),new sap.m.Text({text:"{path:'Xexpand', formatter:'.formatter.truetoX'}"}),new sap.m.Text({text:"{Stftxt}"})]})},confirm:function(e){n.PRTCtrl=e.getParameter("selectedItem").getCells()[0].getText();n.PRTCtrlDesc=e.getParameter("selectedItem").getCells()[6].getText();n.PRTCtrlVS="None";a.refresh()}};var l="/PrtCtlProfSet";var i=[];var u=[new sap.m.Text({text:"{Steuf}"}),new sap.m.Text({text:"{path:'Xterm', formatter:'.formatter.truetoX'}"}),new sap.m.Text({text:"{path:'Xkalk', formatter:'.formatter.truetoX'}"}),new sap.m.Text({text:"{path:'Xrueck', formatter:'.formatter.truetoX'}"}),new sap.m.Text({text:"{path:'Xdruck', formatter:'.formatter.truetoX'}"}),new sap.m.Text({text:"{path:'Xexpand', formatter:'.formatter.truetoX'}"}),new sap.m.Text({text:"{Stftxt}"})];var m=s.getValueHelp(r,l,u,i,o,"Steuf","Stftxt");m.open();m.setModel(t.getView().getModel("i18n"),"i18n")},onPRTCtrlChange:function(e){var t=this;var r=e.getParameters().newValue;var a=this.getModel("prtModel");var s=a.getData();var n=this.getView().getModel("valueHelp2");var o=r.toUpperCase();var l=[new sap.ui.model.Filter("Steuf","EQ",o)];n.read("/PrtCtlProfSet",{filters:l,success:function(e){if(e.results.length>0){s.PRTCtrl=e.results[0].Steuf;s.PRTCtrlDesc=e.results[0].Stftxt;s.PRTCtrlVS="None";a.refresh()}else{s.PRTCtrlVS="Error";a.refresh()}},error:function(e){s.PRTCtrlVS="Error";a.refresh()}})},onPRTQtyChange:function(e){var t=e.getSource();var r=t.getValue();t.setValueState("None");if(r===""){t.setValueState("Error")}else if(parseInt(r)<=0){t.setValueState("Error")}},onPRTUOMVH:function(e){l.UOMVH(e,this)},onPRTUOMChange:function(e){l._UOMchange(e,this)},onStdUsgUOMVH:function(e){l.UOMVH(e,this)},onStdUsgUOMChange:function(e){l._UOMchange(e,this)},onQtyFrmlaVH:function(e){this.FormulaVH(e,"QtyFrmla","QtyFrmlaVS")},onUsgValFrmlaVH:function(e){this.FormulaVH(e,"UsgValFrmla","UsgValFrmlaVS")},FormulaVH:function(e,t,r){var a=this;var n=this.getModel("prtModel");var o=n.getData();var l={title:"Formula",noDataText:a.getView().getModel("i18n").getProperty("LOAD")+"...",items:{path:"/TLPrtFormulaVHSet",template:new sap.m.StandardListItem({title:"{Ident}",description:"{Txt}"})},confirm:function(e){o[t]=e.getParameters().selectedItem.getProperty("title");o[r]="None";n.refresh()}};var i="/TLPrtFormulaVHSet";var u=a.getView().getModel("valueHelp2");var m=s.getSelectDialog(u,i,[],l,"Ident","Txt");m.open()},onQtyFrmlaChange:function(e){this.FormulaChange(e,"QtyFrmla","QtyFrmlaVS")},onUsgValFrmlaChange:function(e){this.FormulaChange(e,"UsgValFrmla","UsgValFrmlaVS")},FormulaChange:function(e,t,r){var a=this;var s=e.getParameters().newValue;var n=this.getModel("prtModel");var o=n.getData();var l=this.getView().getModel("valueHelp2");var i=s.toUpperCase();var u=[new sap.ui.model.Filter("Ident","EQ",i)];l.read("/TLPrtFormulaVHSet",{filters:u,success:function(e){if(e.results.length>0){o[t]=e.results[0].Ident;o[r]="None";n.refresh()}else{o[r]="Error";n.refresh()}},error:function(e){o[r]="Error";n.refresh()}})},onPRTDonePress:function(){var e=this;var t=this.getModel("prtModel");var r=t.getData();if(r.PRT===""||r.PRTVS==="Error"){var a="";if(r.ItmCat==="M"){a="Enter Material"}else if(r.ItmCat==="E"){a="Enter Equipment"}else if(r.ItmCat==="P"){a="Enter Measuring Point"}else if(r.ItmCat==="D"){a="Enter Document"}else if(r.ItmCat==="O"){a="Enter PRT"}this.createMessagePopover(a,"Error");return}window.history.go(-1)},_getMessagePopover:function(){if(!this._oMessagePopover){this._oMessagePopover=sap.ui.xmlfragment("ugieamui.mdg.eam.lib.popover.MessagePopover",this);this.getView().addDependent(this._oMessagePopover)}return this._oMessagePopover},handleMessagePopoverPress:function(e){this._getMessagePopover().openBy(e.getSource())},createMessagePopover:function(e,t){var r=[];var a,s=this._getMessagePopover();if(typeof e==="string"){r.push({type:t,title:e,message:e})}else if(Array.isArray(e)){r=e;for(var o=0;o<r.length;o++){r[o].message=r[o].title}}sap.ui.getCore().getMessageManager().removeAllMessages();for(var o=0;o<r.length;o++){a=new n({message:r[o].message,type:r[o].type,target:"/Dummy",processor:this.getView().getModel()});sap.ui.getCore().getMessageManager().addMessages(a)}s.toggle(this.getView().byId("idMessagePopover"));this.getView().byId("idMessagePopover").setEnabled(true);this.getView().byId("idMessagePopover").setText(r.length+"")}})});