sap.ui.define(["ugiaiwui/mdg/aiw/request/controller/BaseController","sap/ui/model/json/JSONModel","sap/ui/core/routing/History","ugiaiwui/mdg/aiw/request/model/formatter","sap/ui/model/Filter","sap/ui/model/FilterOperator","ugiaiwui/mdg/aiw/request/util/ValueHelpRequest","ugiaiwui/mdg/aiw/library/js/ValueHelpProvider","sap/m/BusyDialog","ugieamui/mdg/eam/lib/util/Utilities","sap/ui/core/message/Message"],function(e,t,a,i,r,n,s,l,o,d,u){"use strict";return e.extend("ugiaiwui.mdg.aiw.request.controller.DetailEquipment",{formatter:i,detailFlag:true,oAttach:[],inputId:null,_oCatalog:null,_oResourceBundle:null,oFileUpload:"",eqCatSelectDialog:undefined,techObjSelectDialog:undefined,mPlantSelectDialog:undefined,ccSelectDialog:undefined,flSelectDialog:undefined,ctSelectDialog:undefined,contTypSelectDialog:undefined,cntrySelectDialog:undefined,isItemPress:"",classType:"",_class:"",defaultCharArr:[],charValueArr:[],lArray:[],singleVal:"",charValue:"",cPath:"",sPath:"",resultArr:[],system:false,submitBtn:false,onInit:function(){this._oView=this.getView();this._oComponent=sap.ui.component(sap.ui.core.Component.getOwnerIdFor(this.getView()));this.getRouter().getRoute("detailEqui").attachPatternMatched(this._onRouteMatched,this);var e=this._oComponent.getManifestEntry("sap.app").dataSources.MDG_EAM_EQUIPMENT_SRV.uri;var a=new sap.ui.model.odata.v2.ODataModel(e,{json:true,useBatch:false,loadMetadataAsync:true,refreshAfterChange:false,defaultCountMode:sap.ui.model.odata.CountMode.None});this.getView().setModel(a,"ainModel");var i=this._oComponent.getModel();i.setDefaultCountMode(sap.ui.model.odata.CountMode.None);this.getView().setModel(i);var r=this._oComponent.getModel("NewModel");this.getView().setModel(r,"valueHelp");var n=this._oComponent.getModel("NewModel2");this.getView().setModel(n,"valueHelp2");this.oAttach=[];this.resultArr=[];this.oModelUpdateFlag=false;this.oModelName="AIWEQUI";var s=this.getView().createId("clsFrag");var l=this.getView().createId("charFrag");var d=this.getView().createId("linearcharFrag");var u=this.getView().createId("lamFrag");this.class=sap.ui.core.Fragment.byId(s,"assignmentTab");this.char=sap.ui.core.Fragment.byId(l,"characteristicsTab");this.linearChar=sap.ui.core.Fragment.byId(d,"idTblLinearChar");this.lam=sap.ui.core.Fragment.byId(u,"lamSimpleForm");var p=this.getView().createId("lamAprvFrag");this.lamAprvSF=sap.ui.core.Fragment.byId(p,"lamSimpleForm");var g={titleName:this.getOwnerComponent().getModel("i18n").getProperty("createEquiTitle"),visible:false,enabled:true};var c={createVisible:true,approveVisible:false,approveVisibleLin:false};this.getView().setModel(new t({enabled:true}),"equiAddressView");this.getView().setModel(new t(g),"mainView");this.getView().setModel(new t(c),"ApproveModel");this.readAddressTitle();var f=sap.ui.getCore().getModel("PRTVisibleEnableModel");this.getView().setModel(f,"PRTVisibleEnableModel");this.isLam();this.readAddressVersion(this);this.BusyDialog=new o;this.readDOIList();var m=new sap.ui.model.json.JSONModel;m.setData([]);this.getView().setModel(m,"dataOrigin");this.getClassType(this);var S=sap.ui.getCore().getMessageManager();this.getView().setModel(S.getMessageModel(),"message");S.registerObject(this.getView(),true)},readDOIList:function(){var e=this.getView().getModel("valueHelp2");var t=this;var a=[new sap.ui.model.Filter("Entity","EQ","EQUI")];e.read("/DOIListSet",{filters:a,success:function(e){var a=new sap.ui.model.json.JSONModel;var i=e.results;var r=[];for(var n=0;n<i.length;n++){var s=new Object;var l=e.results[n].Property;s["SupFlVal"]="";s["instLoc"]=false;s["maintenance"]=false;s["Label"]=e.results[n].Label;s["property"]=e.results[n].Property;s["currentVal"]="";s["doiIcon"]=true;s[e.results[n].Property]="";if(e.results[n].Property==="Maintplant"){s["locEnable"]=false;s["maintEnable"]=false}else{s["locEnable"]=true;s["maintEnable"]=true}r.push(s)}t.DOIarrayEQ=r},error:function(e){}})},_superOrdEquiDesc:function(e,t){var a=this;var i=e.getValue();var r=this.getView().getModel(this.oModelName).getData();var n=new sap.ui.model.Filter("Equnr","EQ",i);var s=this.getView().getModel("valueHelp");s.read("/EquipmentNumberSet",{filters:[n],success:function(e,t){r.SuperordinateEquipDesc=e.results[0].Eqktx;r.SuperordinateEquipVS="None";a.getView().getModel(a.oModelName).setData(r)},error:function(e){r.SuperordinateEquipDesc="";r.SuperordinateEquipVS="Error";a.getView().getModel(a.oModelName).setData(r)}})},onDOICancelPress:function(e){if(this.doiDisplayFlag){e.getSource().getParent().close();this.doiDisplayFlag=false;return}var t=this.getView().getModel(this.oModelName).getData();var a=e.getSource().getParent().getBeginButton().getText();var i=e.getSource().getParent().getContent()[0].getContent()[0].getText();if(a!=="Dismantle"){if(i.indexOf("Superior Equipment")>-1){if(this.isInstall){this.getView().byId("superOrdEq").setValue(this.prevValue);if(this.prevValue){this._superOrdEquiDesc(this.getView().byId("superOrdEq"),"prev")}}else{t.SuperordinateEquip="";t.SuperordinateEquipDesc="";t.Tplnr="";t.Pltxt=""}}else{if(this.isInstall){t.Tplnr=this.functionalLocation;t.Pltxt=this.functionalLocDesc}else{t.Tplnr="";t.Pltxt=""}}t.TplnrEnabled=true;t.TplnrVS="None";t.SuperordinateEquipVS="None";t.SuperordinateEquipEnabled=true;if(t.SuperordinateEquip===""){t.SuperordinateEquipDesc="";this.superiorEquipment="";this.superiorEqDesc=""}else if(t.Tplnr===""){t.Pltxt="";this.functionalLocation="";this.functionalLocDesc=""}}else{var r=e.getSource().getText();if(i.indexOf("Superior Equipment")>-1){if(r==="Cancel"){t.SuperordinateEquip=this.superiorEquipment;t.SuperordinateEquipDesc=this.superiorEqDesc;t.Tplnr=this.functionalLocation;t.Pltxt=this.functionalLocDesc}else{t.SuperordinateEquip="";t.SuperordinateEquipDesc="";t.Tplnr="";t.Pltxt=""}}else{if(r==="Cancel"){t.Tplnr=this.functionalLocation;t.Pltxt=this.functionalLocDesc}else{t.Tplnr="";t.Pltxt=""}}}this.getView().getModel(this.oModelName).setData(t);e.getSource().getParent().close()},onObjectSelect:function(e){var t=e.getSource().getText();var a="";var i=e.getParameter("selected"),r;var n=e.getSource().getParent().getParent();var s=n.getItems();var l=e.getSource().getParent().getParent().getParent().getBeginButton().getText();if(t==="IL"){a=e.getSource().getParent().getParent().getColumns()[5].getAggregation("header");r=a.getSelected();if(i){a.setSelected(false)}s.forEach(function(e){var t=e.getCells()[3];var a=e.getCells()[5];var r=e.getBindingContext().getObject();if(i){if(l==="Dismantle"){t.setSelected(i);r.finalDismantle=r.SupFlVal}else{t.setSelected(i);a.setSelected(false);r.targetVal=r.SupFlVal}}else{if(l==="Dismantle"){t.setSelected(i);r.finalDismantle=""}}})}else if(t==="EQ"){a=e.getSource().getParent().getParent().getColumns()[3].getAggregation("header");r=a.getSelected();if(i){a.setSelected(false)}s.forEach(function(e){var t=e.getCells()[5];var a=e.getCells()[3];var r=e.getBindingContext().getObject();if(i){t.setSelected(i);a.setSelected(false);r.targetVal=""}})}},isLam:function(){var e=this;var t=this.getView().getModel("valueHelp");t.read("/LAM_switchSet('')",{success:function(t,a){e.lamSwitch=t.lam_switch;var i=e.getView().getModel(e.oModelName);if(e.viewName==="Approve"){e.lam.setVisible(false);e.lamAprvSF.setModel(i,"AIWLAM");e.linearChar.setVisible(false)}else if(i.getData().EquipmentCatogory==="L"&&e.lamSwitch==="X"){e.lam.setVisible(true);e.lam.setModel(i,"AIWLAM");e.linearChar.setVisible(true)}else{e.lam.setVisible(false);e.linearChar.setVisible(false)}},error:function(e){}})},_onRouteMatched:function(e){var a=this;var i=e.getParameter("name");if(i==="detailEqui"){var r=sap.ui.getCore().getModel("ClassAttachRequest");var n=r.getData();if(n.attachEquiFlag){this.attachRequest();n.attachEquiFlag=false;r.setData(n)}this.rowIndex=decodeURIComponent(e.getParameter("arguments").Path);this.viewName=e.getParameter("arguments").ViewName;this.oModelUpdateFlag=false;var s=[],l=[],o=[],d;var u=true;var p=false;var g=sap.ui.getCore().getModel("equiAddressView");var c=g.getData();var f=this.getView().getModel("equiAddressView");var m=this.getView().getModel("mainView");var S=this.getView().getModel("ApproveModel");var h=m.getData();var E=f.getData();var M=S.getData();var D=new t;var v;h.enabled=true;h.visible=false;var C=this.getView().getModel("PRTVisibleEnableModel");var A=C.getData();var T=sap.ui.getCore().getModel("dataOriginMOP");var q=T.getData();var b=sap.ui.getCore().getModel("ainMOP");var P=b.getData();var V=this.getView().createId("ainSection");if(sap.ui.getCore().getModel("refreshModel")!==undefined){var L=sap.ui.getCore().getModel("refreshModel");L.setProperty("/refreshSearch",false)}this.sCrStatus=e.getParameter("arguments").CrStatus;if(this.viewName==="CreateEqui"){D.setData(sap.ui.getCore().getModel(this.oModelName).getProperty(this.rowIndex));this.getView().setModel(D,this.oModelName);if(D.getData().Maintplant!==""&&D.getData().MaintplantVS!=="Error"){this.SOPMaintPlant=D.getData().Maintplant}else{this.SOPMaintPlant=""}for(var N=0;N<q.EQ.length;N++){if(D.getData().Equnr===q.EQ[N].key){var F=new sap.ui.model.json.JSONModel;F.setData(q.EQ[N].DOI);a.getView().setModel(F,"dataOrigin");this.superiorEquipment=D.getData().SuperordinateEquip;this.superiorEqDesc=D.getData().SuperordinateEquipDesc;this.functionalLocation=D.getData().Tplnr;this.functionalLocDesc=D.getData().Pltxt;break}}var I=false;for(var N=0;N<P.length;N++){if(D.getData().Equnr===P[N].key){var F=new sap.ui.model.json.JSONModel;F.setData(P[N].AIN);a.getView().setModel(F,"ain");I=true;break}}if(!I){this.setAinInitialData()}sap.ui.core.Fragment.byId(V,"idAINSectionForm").setVisible(true);if(D.getData().viewParameter==="change"){if(D.getData().EquipmentCatogory===""||D.getData().EquipmentCatogory===undefined){D.getData().EquipCatEnabled=true}else{D.getData().EquipCatEnabled=false}if(D.getData().Maintplant===""||D.getData().Maintplant===undefined){D.getData().MaintplantEnabled=true}else{D.getData().MaintplantEnabled=false}if(D.getData().Bukrs===""||D.getData().Bukrs===undefined){D.getData().BukrsEnabled=true}else{D.getData().BukrsEnabled=false}if(D.getData().Tplnr===""||D.getData().Tplnr===undefined){D.getData().TplnrEnabled=true}else{D.getData().TplnrEnabled=false}D.getData().EqunrEnabled=false;h.titleName=this.getOwnerComponent().getModel("i18n").getProperty("changeEqui")}else{D.getData().EqunrEnabled=true;D.getData().EquipCatEnabled=true;D.getData().MaintplantEnabled=true;h.titleName=this.getOwnerComponent().getModel("i18n").getProperty("createEqui")}if(D.getData().Fhmkz){A.PRTVisible=true;A.PRTEnable=true}else{A.PRTVisible=false;A.PRTEnable=false}C.setData(A);if(D.getData().EquipmentCatogory==="L"&&a.lamSwitch==="X"){this.lam.setVisible(true);this.lam.setModel(D,"AIWLAM")}else{this.lam.setVisible(false)}s=D.getData().classItems;this.chData=D.getData().characteristics;if(this.chData.length>0){if(s.length>0){for(var w=0;w<this.chData.length;w++){if(s[0].Class===this.chData[w].Class){l.push(this.chData[w])}}}}this.lnrChData=$.map(D.getData().linearChar,function(e){return $.extend(true,{},e)});if(this.lnrChData.length>0){for(var x=0;x<this.lnrChData.length;x++){if(l[0].Atnam===this.lnrChData[x].Charid){o.push(this.lnrChData[x])}}}d=D.getData().charNewButton;p=D.getData().linearCharAddEnable;v=D.getData().UstaEqui;this.setObjectAddress(this.oModelName);this.readSystemStatus(this);if(D.getData().SuperordinateEquip!==""&&D.getData().SuperordinateEquip!==undefined||D.getData().Tplnr!==""&&D.getData().Tplnr!==undefined){D.getData().MaintplantEnabled=false}else{D.getData().MaintplantEnabled=true}E.enabled=true;if(c.length>0){for(var k=0;k<c.length;k++){if(D.getData().Equnr===c[k].Equnr){E.enabled=c[k].IsEditable;break}}}if(E.enabled===false){this.getView().byId("idTBLIntlAddr").setMode("None")}else{this.getView().byId("idTBLIntlAddr").setMode("Delete")}var y=sap.ui.getCore().getModel("SUP_EQUI_DATA");if(y.getData()&&y.getData().length>0){var R;for(var O=0;O<y.getData().length;O++){if(D.getData().Equnr===y.getData()[O].Equnr){R="/"+O;break}}var B=[y.getProperty(R)];var W=$.map(B,function(e){return $.extend(true,{},e)});var U=new t;U.setData(W);this.getView().setModel(U,"SUP_EQUI_DATA")}else{this.getView().setModel(new t,"SUP_EQUI_DATA")}if(D.getData().Ppeguid!==""&&D.getData().Ppeguid!==null){a.getIPPEConfig(D.getData().Ppeguid)}}if(this.viewName==="ChangeEqui"){var K=e.getParameter("arguments").CrStatus;var z=e.getParameter("arguments").Equi;h.titleName=this.getOwnerComponent().getModel("i18n").getProperty("changeEqui");if(K==="true"){u=false;d=false;p=false;h.enabled=false;E.enabled=false}this.readSystemStatus(this);this.sExistFlag=false;var H;var Z=sap.ui.getCore().getModel(this.oModelName).getData();if(Z.length>0){for(var _=0;_<Z.length;_++){if(Z[_].Equnr===z){H=_;this.sExistFlag=true;break}}}if(this.sExistFlag){if(c.length>0){for(var j=0;j<c.length;j++){if(Z[H].Equnr===c[j].Equnr){E.enabled=c[j].IsEditable;break}}}if(E.enabled===false){this.getView().byId("idTBLIntlAddr").setMode("None")}else{this.getView().byId("idTBLIntlAddr").setMode("Delete")}s=Z[H].classItems;this.chData=Z[H].characteristics;if(this.chData.length>0){if(s.length>0){for(var w=0;w<this.chData.length;w++){if(s[0].Class===this.chData[w].Class){l.push(this.chData[w])}}}}this.lnrChData=$.map(D.getData().linearChar,function(e){return $.extend(true,{},e)});if(this.lnrChData.length>0){for(var x=0;x<this.lnrChData.length;x++){if(l[0].Atnam===this.lnrChData[x].Charid){o.push(this.lnrChData[x])}}}d=Z[H].charNewButton;v=Z[H].UstaEqui;Z[H].EqunrEnabled=false;Z[H].EquipCatEnabled=false;Z[H].MaintplantEnabled=false;Z[H].BukrsEnabled=false;Z[H].TplnrEnabled=false;Z[H].SuperordinateEquipEnabled=false;this.getView().setModel(new t(Z[H]),this.oModelName);this.setObjectAddress(this.oModelName);this.readSystem(this);if(Z[H].Fhmkz&&K==="true"){A.PRTVisible=true;A.PRTEnable=false}else if(Z[H].Fhmkz&&K==="false"){A.PRTVisible=true;A.PRTEnable=true}else{A.PRTVisible=false;A.PRTEnable=false}C.setData(A);if(Z[H].EquipmentCatogory==="L"&&a.lamSwitch==="X"){this.lam.setVisible(true);this.lam.setModel(new t(Z[H]),"AIWLAM")}else{this.lam.setVisible(false)}var Q=sap.ui.getCore().getModel("dataOriginMOP").getData().EQ;for(var N=0;N<Q.length;N++){if(Q[N].key===Z[H].Equnr){this.getView().getModel("dataOrigin").setData(Q[N].DOI);this.superiorEquipment=Z[H].SuperordinateEquip;this.superiorEqDesc=Z[H].SuperordinateEquipDesc;this.functionalLocation=Z[H].Tplnr;this.functionalLocDesc=Z[H].Pltxt}}var I=false;for(var N=0;N<P.length;N++){if(Z[H].Equnr===P[N].key){var F=new sap.ui.model.json.JSONModel;F.setData(P[N].AIN);a.getView().setModel(F,"ain");I=true;break}}if(!I){this.setAinInitialData()}if(Z[H].Maintplant!==""&&Z[H].MaintplantVS!=="Error"){this.SOPMaintPlant=Z[H].Maintplant}else{this.SOPMaintPlant=""}}else{this.readEquipmentData(z,K)}sap.ui.core.Fragment.byId(V,"idAINSectionForm").setVisible(true)}if(this.viewName==="Approve"){D.setData(sap.ui.getCore().getModel(this.oModelName).getProperty(this.rowIndex));D.getData().EqunrEnabled=false;D.getData().EquipCatEnabled=false;D.getData().MaintplantEnabled=false;D.getData().BukrsEnabled=false;D.getData().TplnrEnabled=false;D.getData().SuperordinateEquipEnabled=false;v=D.getData().UstaEqui;this.getView().setModel(D,this.oModelName);if(D.getData().Ppeguid!==""&&D.getData().Ppeguid!==null){a.getIPPEConfig(D.getData().Ppeguid)}var I=false;for(var N=0;N<P.length;N++){if(D.getData().Equnr===P[N].key){var F=new sap.ui.model.json.JSONModel;F.setData(P[N].AIN);a.getView().setModel(F,"ain");I=true;break}}if(!I){var G={moreInfo:false,linkVisible:false,deLinkVisible:false};var J=new sap.ui.model.json.JSONModel(G);this.getView().setModel(J,"ain");sap.ui.getCore().setModel(J,"ain")}sap.ui.core.Fragment.byId(V,"idAINSectionForm").setVisible(false);var X=new t;var Y=sap.ui.getCore().getModel("AIWAPPROVE").getProperty("/AIWEQUI"+this.rowIndex);X.setData(Y);this.getView().setModel(X,"AIWAPPROVE");h.titleName=this.getOwnerComponent().getModel("i18n").getProperty("approveEqui");h.enabled=false;E.enabled=false;M.createVisible=false;M.approveVisible=true;M.approveVisibleLin=false;this.readSystem(this);if(D.getData().Fhmkz){A.PRTVisible=true;A.PRTEnable=false}else{A.PRTVisible=false;A.PRTEnable=false}C.setData(A);this.lam.setVisible(M.createVisible);this.lamAprvSF.setModel(D,"AIWLAM")}if(v){h.visible=true}var ee=this.getView().createId("clsFrag");var te=sap.ui.core.Fragment.byId(ee,"newHeader");te.setEnabled(u);var ae=this.getView().createId("linearcharFrag");var ie=sap.ui.core.Fragment.byId(ae,"idBtnAddLinChar");ie.setEnabled(p);this.class.setModel(new t(s));this.char.setModel(new t(l));this.linearChar.setModel(new t(o));this.class.setVisible(M.createVisible);this.char.setVisible(M.createVisible);this.linearChar.setVisible(M.createVisible);if(D.getData().EquipmentCatogory==="L"&&this.lamSwitch==="X"&&this.viewName!=="Approve"){this.linearChar.setVisible(true)}else{this.linearChar.setVisible(false)}if(this.viewName==="Approve"){this.getView().byId("idPanelDFPS").setVisible(false);var re=this.getView().createId("lamAprvFrag");var ne=sap.ui.core.Fragment.byId(re,"idPanelLinDataAprv");if(this.lamSwitch==="X"){ne.setVisible(true);M.approveVisibleLin=true}else{ne.setVisible(false);M.approveVisibleLin=false}}else{this.getView().byId("idPanelDFPS").setVisible(true)}f.setData(E);m.setData(h);S.setData(M)}else{return}},onInactiveSelect:function(e){var t=e.getSource().getModel(this.oModelName).getData();t.Deact=e.getSource().getSelected();this.readStatusProf(t.EquipmentCatogory,this)},oAcqnDateChange:function(e){var t=e.getParameter("value");if(t===""||t===undefined){e.getSource().setValue("")}else{var a=this.getView().getModel("AIWEQUI");var i=a.getData();i.Ansdt=t;a.setData(i);e.getSource().setValue(t)}},onAcquisitionChange:function(e){var t=e.getSource().getValue();if(t===""||t===undefined){e.getSource().setValue("0.000")}else{if(t.indexOf(".")>-1){var a=t.substr(0,t.indexOf(".")+1);var i=t.substr(t.indexOf(".")+1);if(i.length>=4){i=i.substr(0,3)}else{while(i.length<3){i=i.concat("0")}}e.getSource().setValue(a.concat(i))}else{t=t+".000";e.getSource().setValue(t)}}},onAfterRendering:function(){var e=this;if(sap.m.Input.prototype.onAfterRendering){$(document).on("focusin","input",function(){$(this).data("val",$(this).val())}).on("change","input",function(){if(this.id.indexOf("superOrdEq")>-1){e.prevValue=$(this).data("val");e.currentValue=$(this).val()}else if(this.id.indexOf("FunctionalLocation")>-1){e.prevFlocValue=$(this).data("val");e.currentFlocValue=$(this).val()}})}},onEquiPermitSelect:function(e){var t=this;var a=e.getParameter("listItem").getBindingContext(t.oModelName).getPath();a=parseInt(a.substring(a.lastIndexOf("/")+1));var i=this.getView().getModel(t.oModelName);if(i!==undefined){var r=i.getData();for(var n=0;n<r.Permits.length;n++){if(a===n){r.PmtLtext=r.Permits[n].PmtLtext;i.setData(r);break}}}},attachModelEventHandlers:function(e){e.attachPropertyChange(this.handlePropertyChanged,this)},handlePropertyChanged:function(){this.oModelUpdateFlag=true},readClassCharacteristics:function(){var e=new t;e.setData(sap.ui.getCore().getModel(this.oModelName).getProperty(this.rowIndex).classItems);this.getView().setModel(e,"classItems")},valueHelpFunSelect:function(e){var t=e.getSource().getBindingInfo("value").binding.sPath;if(t.indexOf("/Equnr")!==-1){s.valueHelpFunEquipment(e,this)}else if(t.indexOf("/EquipmentCatogory")!==-1){s.valueHelpFunEquipCat(e.getSource().getModel(this.oModelName).getData(),this)}else if(t.indexOf("/Waers")!==-1){s.valueHelpFunCurrency(e.getSource().getModel(this.oModelName).getData(),this)}else if(t.indexOf("/StsmEqui")!==-1){s.valueHelpFunStatProf(e.getSource().getModel(this.oModelName).getData(),this)}else if(t.indexOf("/UstwEqui")!==-1){s.valueHelpFunStatus(e.getSource().getModel(this.oModelName).getData(),this)}else if(t.indexOf("/UswoEqui")!==-1){s.valueHelpFunStatusWO(e.getSource().getModel(this.oModelName).getData(),this)}else if(t.indexOf("/TechnicalObjectTyp")!==-1){s.valueHelpFunTechObj(e.getSource().getModel(this.oModelName).getData(),this)}else if(t.indexOf("/Maintplant")!==-1){s.valueHelpFunMaintPlant(e.getSource().getModel(this.oModelName).getData(),this,e)}else if(t.indexOf("/Location")!==-1){s.valueHelpFunLocation(e.getSource().getModel(this.oModelName).getData(),this,e)}else if(t.indexOf("/Abckz")!==-1){s.valueHelpFunAbcInd(e.getSource().getModel(this.oModelName).getData(),this,e)}else if(t.indexOf("/Arbpl")!==-1){s.valueHelpFunWc(e.getSource().getModel(this.oModelName).getData(),this,e)}else if(t.indexOf("/Bukrs")!==-1){s.valueHelpFunCompCode(e.getSource().getModel(this.oModelName).getData(),this)}else if(t.indexOf("/Kostl")!==-1){s.valueHelpFunCostCenter(e.getSource().getModel(this.oModelName).getData(),this,e)}else if(t.indexOf("/Werks")!==-1){s.valueHelpFunPlanPlant(e.getSource().getModel(this.oModelName).getData(),this,e)}else if(t.indexOf("/Ingrp")!==-1){s.valueHelpFunPlGrp(e.getSource().getModel(this.oModelName).getData(),this,e)}else if(t.indexOf("/MainArbpl")!==-1){s.valueHelpFunMainWc(e.getSource().getModel(this.oModelName).getData(),this,e)}else if(t.indexOf("/Tplnr")!==-1){s.valueHelpFunFloc(e,this)}else if(t.indexOf("/SuperordinateEquip")!==-1){s.valueHelpFunSuperOrdEq(e,this)}else if(t.indexOf("/ConstrType")!==-1){s.valueHelpFunConstType(this)}else if(t.indexOf("/RefPosta")!==-1){s.valueHelpFunCntry(e,this)}else if(t.indexOf("/Langucode")!==-1){s.valueHelpFunLang(e.getSource().getModel(this.oModelName).getData(),this)}else if(t.indexOf("/BeberFl")!==-1){s.valueHelpFunPlantSec(e.getSource().getModel(this.oModelName).getData(),this,e)}else if(t.indexOf("/Title")!==-1){s.valueHelpFunTitle(e.getSource().getModel(this.oModelName).getData(),this)}else if(t.indexOf("/TimeZone")!==-1){s.valueHelpFunTimeZone(e,this)}else if(t.indexOf("/Region")!==-1){s.valueHelpFunRegion(e,this)}else if(t.indexOf("/PlanvPrt")!==-1){s.onTaskListUsageVH(e.getSource().getModel(this.oModelName).getData(),this)}else if(t.indexOf("/KtschPrt")!==-1){s.onStdTextKeyVH(e.getSource().getModel(this.oModelName).getData(),this)}else if(t.indexOf("/Ewformprt")!==-1){s.onUsgValFormulaVH(e.getSource().getModel(this.oModelName).getData(),this)}else if(t.indexOf("/SteufPrt")!==-1){s.onControlKeyVH(e.getSource().getModel(this.oModelName).getData(),this)}},onTLUSGChange:function(e){var t=this;var a=e.getSource().getValue();if(a===""||a===undefined){e.getSource().setValue("");e.getSource().getModel(t.oModelName).getData().PlanvPrt=""}else{e.getSource().setValue(a.toUpperCase());s._changeTLUSG(e,t)}},onStdTxtKeyChange:function(e){var t=this;var a=e.getSource().getValue();if(a===""||a===undefined){e.getSource().setValue("");e.getSource().getModel(t.oModelName).getData().KtschPrt=""}else{e.getSource().setValue(a.toUpperCase());s._changeStdTxtKey(e,t)}},onUsgValFormulaChange:function(e){var t=this;var a=e.getSource().getValue();if(a===""||a===undefined){e.getSource().setValue("");e.getSource().getModel(t.oModelName).getData().Ewformprt=""}else{e.getSource().setValue(a.toUpperCase());s._changeUsgValFormula(e,t)}},onControlKeyChange:function(e){var t=this;var a=e.getSource().getValue();if(a===""||a===undefined){e.getSource().setValue("");e.getSource().getModel(t.oModelName).getData().SteufPrt=""}else{e.getSource().setValue(a.toUpperCase());s._changeControlKey(e,t)}},equipCatChange:function(e){var t=this;var a=e.getSource().getModel(t.oModelName).getData().EquipmentCatogory;if(a===""||a===undefined){e.getSource().getModel(t.oModelName).getData().EquipmentCatogory="";e.getSource().getModel(t.oModelName).getData().EquipCatgDescription=""}e.getSource().setValueState("None")},onCurrencyChange:function(e){var t=this;var a=e.getSource().getModel(t.oModelName).getData().Waers;if(a===""||a===undefined){e.getSource().getModel(t.oModelName).getData().Waers=""}else{e.getSource().getModel(t.oModelName).getData().Waers=a.toUpperCase();s._changeCurrency(e.getSource().getModel(t.oModelName).getData(),t)}},superOrdEqChange:function(e){var t=this;var a=e.getSource().getModel(t.oModelName).getData().SuperordinateEquip;if(a===""||a===undefined){e.getSource().getModel(t.oModelName).getData().SuperordinateEquip="";e.getSource().getModel(t.oModelName).getData().SuperordinateEquipDesc="";t.readSystemStatus(t)}e.getSource().setValueState("None")},onSuperOrdEqChange:function(e){var t=this;var a=e.getSource().getValue();if(a===""||a===undefined){this.openDoiView(a);e.getSource().setValue("");e.getSource().getModel(t.oModelName).getData().SuperordinateEquipDesc="";e.getSource().getModel(t.oModelName).getData().Stattext="AVLB"}else{e.getSource().setValue(a.toUpperCase());var i=false;var r=a.toUpperCase();var n=sap.ui.getCore().getModel(t.oModelName);var l=n.getData();for(var o=0;o<l.length;o++){if(r===l[o].Equnr){e.getSource().getModel(t.oModelName).getData().SuperordinateEquipDesc=l[o].Eqktx;i=true;break}}if(i){t.fetchData("AIWEQUI")}else{s._changeSuperOrdEqui(e,t)}}},fetchSupFlocEquiData:function(e,a,r,n){var s=this;var l="/ChangeRequestSet";var o=s.getView().getModel();var d=[];var u={};var p={};var g={};var c={};var f=[];var m={ChangeRequestType:"AIWEAM0P",CrDescription:"",Reason:"01",DeriveData:true,FuncLoc:[],FLAddr:[],FLAddrI:[],FLLAM:[],FLClass:[],FLVal:[],FLALTLBEL:[],Equipment:[],EqAddr:[],EqAddrI:[],EqPRT:[],EqLAM:[],EqClass:[],EqVal:[],MSPoint:[],MSLAM:[],MSClass:[],MSVal:[],MPLAN:[],MPItem:[],MPLAM:[],MPOBList:[],MPCycle:[],MRBHeader:[],MRBItem:[],MRBSBIT:[],EBHeader:[],EBItem:[],EBSBIT:[],FBHeader:[],FBItem:[],FBSBIT:[],WBHeader:[],WBItem:[],WBSBIT:[],ONetwork:[],ONLAM:[],Workcenter:[],WCCost:[],GTList:[],GTOprs:[],GTComp:[],GTClass:[],GTVal:[],ETList:[],ETOprs:[],ETComp:[],ETClass:[],ETVal:[],FTList:[],FTOprs:[],FTComp:[],FTClass:[],FTVal:[],Olink:[],OLClass:[],OLVal:[],Messages:[],Equi_DOI:[],FLDOI:[],FLLAMCH:[],EqLAMCH:[],EqDFPS:[]};var S=sap.ui.getCore().getModel("AIWFLOC");var h=sap.ui.getCore().getModel("AIWEQUI");var E=s.getView().getModel(s.oModelName);var M;if(s.oModelName==="AIWEQUI"){M=E.getData().Equnr}var D=sap.ui.getCore().getModel("AIWEQUI").getData();var v=sap.ui.getCore().getModel("AIWFLOC").getData();if(v.length>0){for(var C=0;C<v.length;C++){var A={Tplnr:v[C].Functionallocation,Txtmi:v[C].Flocdescription,TplkzFlc:v[C].Strucindicator,Tplxt:v[C].StrucIndicatorDesc,EditMask:v[C].EditMask,Hierarchy:v[C].Hierarchy,Fltyp:v[C].Floccategory,Flttx:v[C].FlocCategoryDesc,Swerk:v[C].Maintplant,Plantname:v[C].MaintplantDesc,StorFloc:v[C].Location,Locationdesc:v[C].Locationdesc,Abckzfloc:v[C].Abckz,Abctx:v[C].Abctx,Bukrsfloc:v[C].Bukrs,Butxt:v[C].Butxt,City:v[C].City,KostFloc:v[C].Kostl,KokrFloc:v[C].Kokrs,Contareaname:v[C].Mctxt,PlntFloc:v[C].Werks,Planningplantdes:v[C].Planningplantdes,Ingrp:v[C].Ingrp,Plannergrpdesc:v[C].Innam,Arbplfloc:v[C].Arbpl,Workcenterdesc:v[C].Ktext,Wergwfloc:v[C].WcWerks,Gewrkfloc:v[C].MainArbpl,MainWcDesc:v[C].MainKtext,MainWcPlant:v[C].MainWerks,Tplma:v[C].SupFunctionallocation,Supflocdesc:v[C].SupFlocdescription,BeberFl:v[C].BeberFl,Fing:v[C].Fing,Tele:v[C].Tele,Submtiflo:v[C].ConstrType,Constdesc:v[C].ConstructionDesc,Eqart:v[C].TechnicalObjectTyp,Eartx:v[C].Description,Stattext:v[C].Stattext,StsmFloc:v[C].StsmEqui,Statproftxt:v[C].StsmEquiDesc,UstwFloc:v[C].UstwEqui,UswoFloc:v[C].UswoEqui,UstaFloc:v[C].UstaEqui,IsMenu:v[C].menuAction,Adrnr:v[C].Adrnr,Adrnri:v[C].Adrnri,Modeldesc:v[C].Modeldesc,Modelref:v[C].Modelref,Modelrver:v[C].Modelrver,Modelext:v[C].Modelext,Modelname:v[C].Modelname,Modelver:v[C].Modelver};var T=sap.ui.getCore().getModel("dataOriginMOP").getData().FL;if(T&&T.length>0){var q=T[C].DOI;A.Swerki=q[0].instLoc?"H":q[0].maintenance?"D":"";A.Storti=q[1].instLoc?"H":q[1].maintenance?"D":"";A.Beberi=q[2].instLoc?"H":q[2].maintenance?"D":"";A.Ppsidi=q[3].instLoc?"H":q[3].maintenance?"D":"";A.Abckzi=q[4].instLoc?"H":q[4].maintenance?"D":"";A.Bukrsi=q[5].instLoc?"H":q[5].maintenance?"D":"";A.Kostli=q[6].instLoc?"H":q[6].maintenance?"D":"";A.Kokrsi=q[7].instLoc?"H":q[7].maintenance?"D":"";A.Iwerki=q[8].instLoc?"H":q[8].maintenance?"D":"";A.Ingrpi=q[9].instLoc?"H":q[9].maintenance?"D":"";A.Lgwidi=q[10].instLoc?"H":q[10].maintenance?"D":"";A.Adrnri=q[12].instLoc?"H":q[12].maintenance?"D":""}if(v[C].viewParameter==="create"){A.Type=true}m.FuncLoc.push(A);if(v[C].Title!==""&&v[C].Title!==undefined||v[C].TitleCode!==""&&v[C].TitleCode!==undefined||v[C].Name1!==""&&v[C].Name1!==undefined||v[C].Name2!==""&&v[C].Name2!==undefined||v[C].Name3!==""&&v[C].Name3!==undefined||v[C].Name4!==""&&v[C].Name4!==undefined||v[C].Sort1!==""&&v[C].Sort1!==undefined||v[C].Sort2!==""&&v[C].Sort2!==undefined||v[C].NameCo!==""&&v[C].NameCo!==undefined||v[C].PostCod1!==""&&v[C].PostCod1!==undefined||v[C].City1!==""&&v[C].City1!==undefined||v[C].Building!==""&&v[C].Building!==undefined||v[C].Floor!==""&&v[C].Floor!==undefined||v[C].Roomnum!==""&&v[C].Roomnum!==undefined||v[C].AddrLocation!==""&&v[C].AddrLocation!==undefined||v[C].Strsuppl1!==""&&v[C].Strsuppl1!==undefined||v[C].Strsuppl2!==""&&v[C].Strsuppl2!==undefined||v[C].Strsuppl3!==""&&v[C].Strsuppl3!==undefined||v[C].TimeZone!==""&&v[C].TimeZone!==undefined||v[C].RefPosta!==""&&v[C].RefPosta!==undefined||v[C].Region!==""&&v[C].Region!==undefined){var b={Funcloc:v[C].Functionallocation,Title:v[C].TitleCode,Name1:v[C].Name1,Name2:v[C].Name2,Name3:v[C].Name3,Name4:v[C].Name4,Sort1:v[C].Sort1,Sort2:v[C].Sort2,NameCo:v[C].NameCo,PostCod1:v[C].PostCod1,City1:v[C].City1,Building:v[C].Building,Floor:v[C].Floor,Roomnum:v[C].Roomnum,Strsuppl1:v[C].Strsuppl1,Strsuppl2:v[C].Strsuppl2,Strsuppl3:v[C].Strsuppl3,Location:v[C].AddrLocation,RPostafl:v[C].RefPosta,Landx:v[C].Landx,TimeZone:v[C].TimeZone,RPostFl:v[C].Region,Regiotxt:v[C].RegionDesc};m.FLAddr.push(b)}var P=v[C].intlAddr;if(P.length>0){for(var V=0;V<P.length;V++){m.FLAddrI.push(P[V])}}if(s.AltLblDerv==="2"&&v[C].altlbl.length>0){for(var L=0;L<v[C].altlbl.length;L++){var N={Funcloc:v[C].Functionallocation,AltAlkey:v[C].altlbl[L].AltAlkey,AltStrno:v[C].altlbl[L].AltStrno,AltTplkz:v[C].altlbl[L].AltTplkz};m.FLALTLBEL.push(N)}}if(v[C].lam!==undefined){var F={Funcloc:v[C].Functionallocation,Lrpid:v[C].lam.Lrpid,Strtptatr:v[C].lam.Strtptatr,Endptatr:v[C].lam.Endptatr,Length:v[C].lam.Length,LinUnit:v[C].lam.LinUnit,Startmrkr:v[C].lam.Startmrkr,Endmrkr:v[C].lam.Endmrkr,Mrkdisst:v[C].lam.Mrkdisst,Mrkdisend:v[C].lam.Mrkdisend,MrkrUnit:v[C].lam.MrkrUnit,LamDer:v[C].lam.LamDer};m.FLLAM.push(F)}var I=v[C].classItems;if(I){if(I.length>0){for(var w=0;w<I.length;w++){var x={Funcloc:v[C].Functionallocation,Classtype:I[w].Classtype,Class:I[w].Class,Clstatus1:I[w].Clstatus1,Artxt:I[w].ClassTypeDesc};m.FLClass.push(x)}}}var k=v[C].characteristics;if(k){if(k.length>0){for(var y=0;y<k.length;y++){var R={Funcloc:v[C].Functionallocation,Atnam:k[y].Atnam,Textbez:k[y].Textbez,Atwrt:k[y].Atwrt,Class:k[y].Class};m.FLVal.push(R)}}}var O=v[C].linearChar;if(O){if(O.length>0){var B=$.map(O,function(e){return $.extend(true,{},e)});for(var y=0;y<B.length;y++){delete B[y].linCharEnable;B[y].Funcloc=v[C].Functionallocation;m.FLLAMCH.push(B[y])}}}}}if(D.length>0){for(var W=0;W<D.length;W++){var U={Herst:D[W].Herst,Equnr:D[W].Equnr,Txtmi:D[W].Eqktx,Swerk:D[W].Maintplant,Name1:D[W].MaintplantDesc,TplnEilo:D[W].Tplnr,Flocdescription:D[W].Pltxt,Eqtyp:D[W].EquipmentCatogory,Etytx:D[W].EquipCatgDescription,Eqart:D[W].TechnicalObjectTyp,Eartx:D[W].Description,Typbz:D[W].Typbz,SubmEeqz:D[W].ConstrType,Constdesc:D[W].ConstructionDesc,BukrEilo:D[W].Bukrs,Butxt:D[W].Butxt,HequEeqz:D[W].SuperordinateEquip,SuperordEqDes:D[W].SuperordinateEquipDesc,TidnEeqz:D[W].TechIdNum,KostEilo:D[W].Kostl,KokrEilo:D[W].Kokrs,Contareaname:D[W].Mctxt,StorEilo:D[W].Location,Locationdesc:D[W].Locationdesc,AbckEilo:D[W].Abckz,Abctx:D[W].Abctx,PplaEeqz:D[W].Werks,Planningplantdes:D[W].Planningplantdes,IngrEeqz:D[W].Ingrp,Plannergrpdesc:D[W].Innam,Serge:D[W].Serge,MapaEeqz:D[W].MapaEeqz,Stattext:D[W].Stattext,StsmEqui:D[W].StsmEqui,Statproftxt:D[W].StsmEquiDesc,UstwEqui:D[W].UstwEqui,UswoEqui:D[W].UswoEqui,UstaEqui:D[W].UstaEqui,Answt:D[W].Answt,Ansdt:s._formatDate(D[W].Ansdt),Waers:D[W].Waers,ArbpEilo:D[W].Arbpl,Workcenterdesc:D[W].Ktext,WorkCenterPlant:D[W].WcWerks,ArbpEeqz:D[W].MainArbpl,MainWcDesc:D[W].MainKtext,MainWcPlant:D[W].MainWerks,BebeEilo:D[W].BeberFl,Fing:D[W].Fing,Tele:D[W].Tele,HeqnEeqz:D[W].EquipPosition,IsMenu:D[W].menuAction,Adrnr:D[W].Adrnr,Adrnri:D[W].Adrnri,Fhmkz:D[W].Fhmkz,Funcid:D[W].Funcid,Frcfit:D[W].Frcfit,Frcrmv:D[W].Frcrmv};if(D[W].Equnr===M){p=D[W]}var K=sap.ui.getCore().getModel("dataOriginMOP").getData().EQ;if(K&&K.length>0){var q=K[W].DOI;U.Swerki=q[0].instLoc?"R":q[0].maintenance?"D":"";U.Storti=q[1].instLoc?"R":q[1].maintenance?"D":"";U.Beberi=q[2].instLoc?"R":q[2].maintenance?"D":"";U.Ppsidi=q[3].instLoc?"R":q[3].maintenance?"D":"";U.Abckzi=q[4].instLoc?"R":q[4].maintenance?"D":"";U.Kostli=q[5].instLoc?"R":q[5].maintenance?"D":"";U.Iwerki=q[6].instLoc?"R":q[6].maintenance?"D":"";U.Ingrpi=q[7].instLoc?"R":q[7].maintenance?"D":"";U.Gewrki=q[8].instLoc?"R":q[8].maintenance?"D":"";U.Adrnri=q[10].instLoc?"R":q[10].maintenance?"D":""}if(D[W].Equnr===M){U.IsDOI=true;var q=this.getView().getModel("dataOrigin").getData();if(q&&q.length>0){U.Swerki=q[0].instLoc?"R":q[0].maintenance?"D":"";U.Storti=q[1].instLoc?"R":q[1].maintenance?"D":"";U.Beberi=q[2].instLoc?"R":q[2].maintenance?"D":"";U.Ppsidi=q[3].instLoc?"R":q[3].maintenance?"D":"";U.Abckzi=q[4].instLoc?"R":q[4].maintenance?"D":"";U.Kostli=q[5].instLoc?"R":q[5].maintenance?"D":"";U.Iwerki=q[6].instLoc?"R":q[6].maintenance?"D":"";U.Ingrpi=q[7].instLoc?"R":q[7].maintenance?"D":"";U.Gewrki=q[8].instLoc?"R":q[8].maintenance?"D":"";U.Adrnri=q[10].instLoc?"R":q[10].maintenance?"D":""}}if(D[W].viewParameter==="create"){U.Type=true}m.Equipment.push(U);if(D[W].Title!==""&&D[W].Title!==undefined||D[W].TitleCode!==""&&D[W].TitleCode!==undefined||D[W].Name1!==""&&D[W].Name1!==undefined||D[W].Name2!==""&&D[W].Name2!==undefined||D[W].Name3!==""&&D[W].Name3!==undefined||D[W].Name4!==""&&D[W].Name4!==undefined||D[W].Sort1!==""&&D[W].Sort1!==undefined||D[W].Sort2!==""&&D[W].Sort2!==undefined||D[W].NameCo!==""&&D[W].NameCo!==undefined||D[W].PostCod1!==""&&D[W].PostCod1!==undefined||D[W].City1!==""&&D[W].City1!==undefined||D[W].Building!==""&&D[W].Building!==undefined||D[W].Floor!==""&&D[W].Floor!==undefined||D[W].Roomnum!==""&&D[W].Roomnum!==undefined||D[W].AddrLocation!==""&&D[W].AddrLocation!==undefined||D[W].Strsuppl1!==""&&D[W].Strsuppl1!==undefined||D[W].Strsuppl2!==""&&D[W].Strsuppl2!==undefined||D[W].Strsuppl3!==""&&D[W].Strsuppl3!==undefined||D[W].TimeZone!==""&&D[W].TimeZone!==undefined||D[W].RefPosta!==""&&D[W].RefPosta!==undefined||D[W].Region!==""&&D[W].Region!==undefined){var z={Equi:D[W].Equnr,Title:D[W].TitleCode,Name1:D[W].Name1,Name2:D[W].Name2,Name3:D[W].Name3,Name4:D[W].Name4,Sort1:D[W].Sort1,Sort2:D[W].Sort2,NameCo:D[W].NameCo,PostCod1:D[W].PostCod1,City1:D[W].City1,Building:D[W].Building,Floor:D[W].Floor,Roomnum:D[W].Roomnum,Strsuppl1:D[W].Strsuppl1,Strsuppl2:D[W].Strsuppl2,Strsuppl3:D[W].Strsuppl3,Location:D[W].AddrLocation,RefPosta:D[W].RefPosta,Landx:D[W].Landx,TimeZone:D[W].TimeZone,RfePost:D[W].Region,Regiotxt:D[W].RegionDesc};m.EqAddr.push(z);if(D[W].Equnr===M){c=z}}var P=D[W].intlAddr;if(P.length>0){for(var V=0;V<P.length;V++){m.EqAddrI.push(P[V])}if(D[W].Equnr===M){f=m.EqAddrI}}var H={Equi:D[W].Equnr,PlanvPrt:D[W].PlanvPrt,SteufPrt:D[W].SteufPrt,KtschPrt:D[W].KtschPrt,Ewformprt:D[W].Ewformprt,SteufRef:D[W].SteufRef,KtschRef:D[W].KtschRef,EwformRef:D[W].EwformRef};m.EqPRT.push(H);if(D[W].lam!==undefined){var Z={Equi:D[W].Equnr,Lrpid:D[W].lam.Lrpid,Strtptatr:D[W].lam.Strtptatr,Endptatr:D[W].lam.Endptatr,Length:D[W].lam.Length,LinUnit:D[W].lam.LinUnit,Startmrkr:D[W].lam.Startmrkr,Endmrkr:D[W].lam.Endmrkr,Mrkdisst:D[W].lam.Mrkdisst,Mrkdisend:D[W].lam.Mrkdisend,MrkrUnit:D[W].lam.MrkrUnit,LamDer:D[W].lam.LamDer};if(D[W].Equnr===M&&s.lamSwitch==="X"){g=Z;Z.LamDer="D"}m.EqLAM.push(Z)}if(D[W].dfps){var _={Equi:D[W].Equnr,DeviceId:D[W].dfps.Tailno,Topsiteid:D[W].dfps.Area,Topsitede:D[W].dfps.AreaDesc,AreaPro:D[W].dfps.AreaPrfl,SiteId:D[W].dfps.Site,SiteDesc:D[W].dfps.SiteDesc,SitePro:D[W].dfps.SitePrfl,MpoId:D[W].dfps.MPO,MpoDescr:D[W].dfps.MPODesc,RicId:D[W].dfps.RIC,RicDescr:D[W].dfps.RICDesc,ModelId:D[W].dfps.ModelId,ModelDes:D[W].dfps.ModelIdDesc,Foreignob:i.truetoX(D[W].dfps.ForeignEq),TecState:D[W].dfps.TechSts,DepState:D[W].dfps.OperSts,DfpsRmrk:D[W].dfps.Remark};m.EqDFPS.push(_)}var j=D[W].classItems;if(j){if(j.length>0){for(var Q=0;Q<j.length;Q++){var G={Equi:D[W].Equnr,Classtype:j[Q].Classtype,Class:j[Q].Class,Clstatus1:j[Q].Clstatus1,Artxt:j[Q].ClassTypeDesc};m.EqClass.push(G)}}}var J=D[W].characteristics;if(J){if(J.length>0){for(var X=0;X<J.length;X++){var Y={Equi:D[W].Equnr,Atnam:J[X].Atnam,Textbez:J[X].Textbez,Atwrt:J[X].Atwrt,Class:J[X].Class};m.EqVal.push(Y)}}}var O=D[W].linearChar;if(O){if(O.length>0){var B=$.map(O,function(e){return $.extend(true,{},e)});for(var y=0;y<B.length;y++){delete B[y].linCharEnable;B[y].Equi=D[W].Equnr;m.EqLAMCH.push(B[y])}}}}}var ee=s.getView().getModel("mainView");var te=ee.getData();te.tableBusy=true;ee.setData(te);var ae=function(n){s.BusyDialog.close();if(n.Messages.results.length>0){var l=[];for(var o=0;o<n.Messages.results.length;o++){l.push({type:i.getMessageType(n.Messages.results[o].Type),title:n.Messages.results[o].Message})}s.createMessagePopover(l,"");te.tableBusy=false;ee.setData(te);if(s.getView().getModel(s.oModelName).getData().Maintplant===""){s.getView().getModel(s.oModelName).getData().Tplnr="";s.getView().getModel(s.oModelName).getData().Pltxt="";s.getView().getModel(s.oModelName).getData().SuperordinateEquip="";s.getView().getModel(s.oModelName).getData().SuperordinateEquipDesc="";s.getView().getModel(s.oModelName).refresh()}else{if(s.isInstall&&E.getData().SuperordinateEquip!==""){s.getView().getModel(s.oModelName).getData().SuperordinateEquip=s.superiorEquipment;s.getView().getModel(s.oModelName).getData().SuperordinateEquipDesc=s.superiorEqDesc;s.getView().getModel(s.oModelName).getData().Tplnr=s.functionalLocation;s.getView().getModel(s.oModelName).getData().Pltxt=s.functionalLocDesc}else{s.getView().getModel(s.oModelName).getData().SuperordinateEquip="";s.getView().getModel(s.oModelName).getData().SuperordinateEquipDesc="";s.getView().getModel(s.oModelName).getData().Tplnr="";s.getView().getModel(s.oModelName).getData().Pltxt=""}if(s.isInstall&&E.getData().Tplnr!==""){s.getView().getModel(s.oModelName).getData().Tplnr=this.functionalLocation;s.getView().getModel(s.oModelName).getData().Pltxt=this.functionalLocDesc}else{s.getView().getModel(s.oModelName).getData().Tplnr="";s.getView().getModel(s.oModelName).getData().Pltxt=""}}return}if(n.FuncLoc){if(n.FuncLoc.results.length>0){d=[];if(n.FuncLoc.results.length>0){for(var u=0;u<n.FuncLoc.results.length;u++){var m=n.FuncLoc.results[u];var v={intlAddr:[],altlbl:[],classItems:[],characteristics:[],linearChar:[],FunctionallocationVS:"None",FunctionallocationVST:"",FlocdescriptionVS:"None",FlocdescriptionVST:"",StrucindicatorVS:"None",StrucindicatorVST:"",FloccategoryVS:"None",FloccategoryVST:"",SupFunctionallocationVS:"None",SupFunctionallocationVST:"",MaintplantVS:"None",MaintplantVST:"",StsmEquiVS:"None",StsmEquiVST:"",UstwEquiVS:"None",UstwEquiVST:"",UswoEquiVS:"None",UswoEquiVST:"",TechnicalObjectTypVS:"None",TechnicalObjectTypVST:"",LocationVS:"None",LocationVST:"",AbckzVS:"None",AbckzVST:"",MainArbplVS:"None",MainArbplVST:"",BeberFlVS:"None",BeberFlVST:"",BukrsVS:"None",BukrsVST:"",KostlVS:"None",KostlVST:"",WerksVS:"None",WerksVST:"",IngrpVS:"None",IngrpVST:"",ArbplVS:"None",ArbplVST:"",ConstrTypeVS:"None",ConstrTypeVST:"",RefPostaVS:"None",RefPostaVST:"",LangucodeVS:"None",LangucodeVST:"",TimeZoneVS:"None",TimeZoneVST:"",TplnrEnabled:true,FunctionalLocEnabled:true,FlocCatEnabled:true,StrucIndEnabled:true,MaintplantEnabled:true,BukrsEnabled:true};v.Functionallocation=m.Tplnr;v.Flocdescription=m.Txtmi;v.EditMask=m.EditMask;v.Hierarchy=m.Hierarchy;v.Floccategory=m.Fltyp;v.FlocCategoryDesc=m.Flttx;v.Strucindicator=m.TplkzFlc;v.StrucIndicatorDesc=m.Tplxt;v.SupFunctionallocation=m.Tplma;v.SupFlocdescription=m.Supflocdesc;v.Stattext=m.Stattext;v.StsmEqui=m.StsmFloc;v.StsmEquiDesc=m.Statproftxt;v.UstwEqui=m.UstwFloc;v.UswoEqui=m.UswoFloc;v.UstaEqui=m.UstaFloc;v.TechnicalObjectTyp=m.Eqart;v.Description=m.Eartx;v.Maintplant=m.Swerk;v.MaintplantDesc=m.Plantname;v.Location=m.StorFloc;v.Locationdesc=m.Locationdesc;v.BeberFl=m.BeberFl;v.Fing=m.Fing;v.Tele=m.Tele;v.Arbpl=m.Arbplfloc;v.Ktext=m.Workcenterdesc;v.WcWerks=m.Wergwfloc;v.MainArbpl=m.Gewrkfloc;v.MainKtext=m.MainWcDesc;v.MainWerks=m.MainWcPlant;v.Abckz=m.Abckzfloc;v.Abctx=m.Abctx;v.Bukrs=m.Bukrsfloc;v.Butxt=m.Butxt;v.City=m.City;v.Kostl=m.KostFloc;v.Kokrs=m.KokrFloc;v.Mctxt=m.Contareaname;v.Werks=m.PlntFloc;v.Planningplantdes=m.Planningplantdes;v.Ingrp=m.Ingrp;v.Innam=m.Plannergrpdesc;v.ConstrType=m.Submtiflo;v.ConstructionDesc=m.Constdes;v.menuAction=m.IsMenu;v.Adrnr=m.Adrnr;v.Adrnri=m.Adrnri;v.Modeldesc=m.Modeldesc;v.Modelref=m.Modelref;v.Modelrver=m.Modelrver;v.Modelext=m.Modelext;v.Modelname=m.Modelname;v.Modelver=m.Modelver;if(m.Type===true){v.viewParameter="create"}if(m.Type===false){v.viewParameter="change";if(v.Floccategory===""||v.Floccategory===undefined){v.FlocCatEnabled=true}else{v.FlocCatEnabled=false}if(v.Strucindicator===""||v.Strucindicator===undefined){v.StrucIndEnabled=true}else{v.StrucIndEnabled=false}v.FunctionalLocEnabled=false}if(m.Swerk!==""){v.MaintplantEnabled=false;v.BukrsEnabled=false}else{v.MaintplantEnabled=true;v.BukrsEnabled=true}if(n.FLLAM.results.length>0){var C=n.FLLAM.results;for(var A=0;A<C.length;A++){if(C[A].Funcloc===v.Functionallocation){var T={Funcloc:C[A].Funcloc,Lrpid:C[A].Lrpid,LrpidDesc:C[A].LrpDescr,Strtptatr:C[A].Strtptatr,Endptatr:C[A].Endptatr,Length:C[A].Length,LinUnit:C[A].LinUnit,LinUnitDesc:C[A].Uomtext,Startmrkr:C[A].Startmrkr,Endmrkr:C[A].Endmrkr,Mrkdisst:C[A].Mrkdisst,Mrkdisend:C[A].Mrkdisend,MrkrUnit:C[A].MrkrUnit,LamDer:C[A].LamDer};v.lam=T;break}}}if(n.FLAddr){if(n.FLAddr.results){var q=n.FLAddr.results;if(q){if(q.length>0){for(var b=0;b<q.length;b++){if(v.Functionallocation===q[b].Funcloc){var P=sap.ui.getCore().getModel("flocAddressView");var V=P.getData();var L=true;var N,F;if(V.length>0){for(var I=0;I<V.length;I++){if(v.Functionallocation===V[I].Functionallocation){L=false;F=I;break}}}if(L&&v.SupFunctionallocation!==""&&v.SupFunctionallocation!==undefined){N={Functionallocation:v.Functionallocation,IsEditable:q[b].IsEditable};V.push(N);P.setData(V)}if(!L&&v.SupFunctionallocation!==""&&v.SupFunctionallocation!==undefined){V[F].Functionallocation=v.Functionallocation;V[F].IsEditable=q[b].IsEditable;P.setData(V)}v.Title=q[b].Titletxt?q[b].Titletxt:"";v.TitleCode=q[b].Title?q[b].Title:"";v.Name1=q[b].Name1?q[b].Name1:"";v.Name2=q[b].Name2?q[b].Name2:"";v.Name3=q[b].Name3?q[b].Name3:"";v.Name4=q[b].Name4?q[b].Name4:"";v.Sort1=q[b].Sort1?q[b].Sort1:"";v.Sort2=q[b].Sort2?q[b].Sort2:"";v.NameCo=q[b].NameCo?q[b].NameCo:"";v.PostCod1=q[b].PostCod1?q[b].PostCod1:"";v.City1=q[b].City1?q[b].City1:"";v.Building=q[b].Building?q[b].Building:"";v.Floor=q[b].Floor?q[b].Floor:"";v.Roomnum=q[b].Roomnum?q[b].Roomnum:"";v.Strsuppl1=q[b].Strsuppl1?q[b].Strsuppl1:"";v.Strsuppl2=q[b].Strsuppl2?q[b].Strsuppl2:"";v.Strsuppl3=q[b].Strsuppl3?q[b].Strsuppl3:"";v.AddrLocation=q[b].Location?q[b].Location:"";v.RefPosta=q[b].RPostafl?q[b].RPostafl:"";v.Landx=q[b].Landx?q[b].Landx:"";v.TimeZone=q[b].TimeZone?q[b].TimeZone:"";v.Region=q[b].RPostFl?q[b].RPostFl:"";v.ReigonDesc=q[b].Regiotxt?q[b].Regiotxt:""}}}else{v.Title=v.Title?v.Title:"";v.TitleCode=v.TitleCode?v.TitleCode:"";v.Name1=v.Name1?v.Name1:"";v.Name2=v.Name2?v.Name2:"";v.Name3=v.Name3?v.Name3:"";v.Name4=v.Name4?v.Name4:"";v.Sort1=v.Sort1?v.Sort1:"";v.Sort2=v.Sort2?v.Sort2:"";v.NameCo=v.NameCo?v.NameCo:"";v.PostCod1=v.PostCod1?v.PostCod1:"";v.City1=v.City1?v.City1:"";v.Building=v.Building?v.Building:"";v.Floor=v.Floor?v.Floor:"";v.Roomnum=v.Roomnum?v.Roomnum:"";v.Strsuppl1=v.Strsuppl1?v.Strsuppl1:"";v.Strsuppl2=v.Strsuppl2?v.Strsuppl2:"";v.Strsuppl3=v.Strsuppl3?v.Strsuppl3:"";v.AddrLocation=v.AddrLocation?v.AddrLocation:"";v.RefPosta=v.RefPosta?v.RefPosta:"";v.Landx=v.Landx?v.Landx:"";v.TimeZone=v.TimeZone?v.TimeZone:"";v.Region=v.Region?v.Region:"";v.RegionDesc=v.RegionDesc?v.RegionDesc:""}}}}var w=n.FLAddrI.results;if(w.length>0){for(var x=0;x<w.length;x++){if(w[x].Funcloc===v.Functionallocation){w[x].AdNationEnable=false;w[x].City1iVS="None";w[x].StreetiVS="None";v.intlAddr.push(w[x])}}}var k=n.FLALTLBEL.results;if(k.length>0){for(var y=0;y<k.length;y++){if(k[y].Funcloc===v.Functionallocation){var R={Funcloc:sTplnr,AltAlkey:k[y].AltAlkey,Altxt:k[y].Altxt,AltStrno:k[y].AltStrno,AltTplkz:k[y].AltTplkz,Tplxt:k[y].Tplxt,Name1i:k[y].Editm,Actvs:k[y].Actvs,AltPrkey:k[y].AltPrkey,AltReuse:k[y].AltReuse,enableLblSys:false,enableAltLbl:true,enableStrInd:true,LblSysVS:"None",AltLblVS:"None",StrIndVS:"None"};v.altlbl.push(R)}}}if(n.FLClass){var O=n.FLClass.results;if(O){if(O.length>0){for(var B=0;B<O.length;B++){if(v.Functionallocation===O[B].Funcloc){O[B].ctEnable=false;O[B].classEnable=false;O[B].ClassTypeDesc=O[B].Artxt;delete O[B].Artxt;delete O[B].Changerequestid;delete O[B].Clint;delete O[B].Service;v.classItems.push(O[B])}}v.charNewButton=true;if(s.class&&s.class.getId().includes("detailFloc")===true){s.class.setModel(new t(v.classItems))}}}}if(n.FLVal){var W=n.FLVal.results;if(W){if(W.length>0){for(var U=0;U<W.length;U++){if(v.Functionallocation===W[U].Funcloc){W[U].cNameEnable=false;W[U].Textbz=W[U].Atwtb;delete W[U].Ataut;delete W[U].Ataw1;delete W[U].Atawe;delete W[U].Atcod;delete W[U].Atflb;delete W[U].Atflv;delete W[U].Atimb;delete W[U].Atsrt;delete W[U].Atvglart;delete W[U].Atzis;delete W[U].Changerequestid;delete W[U].CharName;delete W[U].Charid;delete W[U].Classtype;delete W[U].Service;delete W[U].Valcnt;W[U].slNo=U+1;W[U].flag=W[U].Class+"-"+W[U].slNo;v.characteristics.push(W[U])}}if(s.char&&s.char.getId().includes("detailFloc")===true){s.char.setModel(new t(v.characteristics))}}}}if(n.FLLAMCH){var K=n.FLLAMCH.results;if(K){if(K.length>0){for(var z=0;z<K.length;z++){if(v.Functionallocation===K[z].Funcloc){K[z].linCharEnable=true;v.linearChar.push(K[z])}}}}}if(v.UstaEqui){te.visible=true}else{te.visible=false}ee.setData(ee);d.push(v)}S.setData(d)}}}if(n.Equipment.results.length>0){d=[];for(var H=0;H<n.Equipment.results.length;H++){var v=n.Equipment.results[H];var Z={intlAddr:[],classItems:[],characteristics:[],linearChar:[],charNewButton:false,attachmentCount:"0",Guids:"",EqunrEnabled:true,EquipCatEnabled:true,MaintplantEnabled:true,BukrsEnabled:true,EqunrVS:"None",EqunrVST:"",EqktxVS:"None",EqktxVST:"",EquipmentCatogoryVS:"None",EquipmentCatogoryVST:"",MaintplantVS:"None",MaintplantVST:"",TplnrVS:"None",TplnrVST:"",SuperordinateEquipVS:"None",SuperordinateEquipVST:"",StsmEquiVS:"None",StsmEquiVST:"",UstwEquiVS:"None",UstwEquiVST:"",UswoEquiVS:"None",UswoEquiVST:"",TechnicalObjectTypVS:"None",TechnicalObjectTypVST:"",LocationVS:"None",LocationVSTL:"",AbckzVS:"None",AbckzVST:"",ArbplVS:"None",ArbplVST:"",BukrsVS:"None",BukrsVST:"",KostlVS:"None",KostlVST:"",WerksVS:"None",WerksVST:"",IngrpVS:"None",IngrpVST:"",ConstrTypeVS:"None",ConstrTypeVST:"",RefPostaVS:"None",RefPostaVST:"",MainArbplVS:"None",MainArbplVST:"",LangucodeVS:"None",LangucodeVST:"",TimeZoneVS:"None",TimeZoneVST:"",ConstrTypeMaxL:0,charValueMaxL:0,dfps:{Tailno:"",TailnoVS:"None",Area:"",AreaDesc:"",AreaPrfl:"",Site:"",SiteDesc:"",SiteVS:"None",SitePrfl:"",MPO:"",MPODesc:"",RIC:"",RICDesc:"",ModelId:"",ModelIdDesc:"",ModelIdVS:"None",ForeignEq:false,TechSts:"",OperSts:"0001",Remark:"",dfpsCrtEnabled:true,dfpsDltEnabled:false,dfpsEnabled:false,TailnoReq:false}};Z.Equnr=v.Equnr;Z.Eqktx=v.Txtmi;Z.EquipmentCatogory=v.Eqtyp;Z.EquipCatgDescription=v.Etytx;Z.Maintplant=v.Swerk;Z.MaintplantDesc=v.Name1;Z.SuperordinateEquip=v.HequEeqz;Z.SuperordinateEquipDesc=v.SuperordEqDes;Z.Bukrs=v.BukrEilo;Z.Butxt=v.Butxt;Z.Location=v.StorEilo;Z.Locationdesc=v.Locationdesc;Z.Abckz=v.AbckEilo;Z.Abctx=v.Abctx;Z.Kostl=v.KostEilo;Z.Kokrs=v.KokrEilo;Z.Mctxt=v.Contareaname;Z.Answt=v.Answt;Z.Ansdt=i.getDateFormat(v.Ansdt);Z.Waers=v.Waers;Z.Werks=v.PplaEeqz;Z.Planningplantdes=v.Planningplantdes;Z.Ingrp=v.IngrEeqz;Z.Innam=v.Plannergrpdesc;Z.Arbpl=v.ArbpEilo;Z.Ktext=v.Workcenterdesc;Z.WcWerks=v.WorkCenterPlant;Z.MainArbpl=v.ArbpEeqz;Z.MainKtext=v.MainWcDesc;Z.MainWerks=v.MainWcPlant;Z.BeberFl=v.BebeEilo;Z.Fing=v.Fing;Z.Tele=v.Tele;Z.Herst=v.Herst;Z.TechnicalObjectTyp=v.Eqart;Z.Description=v.Eartx;Z.Typbz=v.Typbz;Z.ConstrType=v.SubmEeqz;Z.ConstructionDesc=v.Constdesc;Z.TechIdNum=v.TidnEeqz;Z.Serge=v.Serge;Z.MapaEeqz=v.MapaEeqz;Z.EquipPosition=v.HeqnEeqz;Z.Stattext=v.Stattext;Z.StsmEqui=v.StsmEqui;Z.StsmEquiDesc=v.Statproftxt;Z.UstwEqui=v.UstwEqui;Z.UswoEqui=v.UswoEqui;Z.UstaEqui=v.UstaEqui;Z.menuAction=v.IsMenu;Z.Adrnr=v.Adrnr;Z.Adrnri=v.Adrnri;Z.Fhmkz=v.Fhmkz;Z.Funcid=v.Funcid;Z.Frcfit=v.Frcfit;Z.Frcrmv=v.Frcrmv;if(Z.Equnr===M){s.equiHeader=n.Equipment.results[H];Z.Maintplant=p.Maintplant;Z.MaintplantDesc=p.MaintplantDesc;Z.Bukrs=p.Bukrs;Z.Butxt=p.Butxt;Z.Location=p.Location;Z.Locationdesc=p.Locationdesc;Z.Abckz=p.Abckz;Z.Abctx=p.Abctx;Z.Kostl=p.Kostl;Z.Kokrs=p.Kokrs;Z.Mctxt=p.Mctxt;Z.Werks=p.Werks;Z.Planningplantdes=p.Planningplantdes;Z.Ingrp=p.Ingrp;Z.Innam=p.Innam;Z.MainArbpl=p.MainArbpl;Z.MainKtext=p.MainKtext;Z.MainWerks=p.MainWerks;Z.BeberFl=p.BeberFl;Z.Fing=p.Fing;Z.Tele=p.Tele;Z.Stattext=p.Stattext}if(n.EqPRT){var _=n.EqPRT.results[H];if(_){Z.PlanvPrt=_.PlanvPrt;Z.SteufPrt=_.SteufPrt;Z.KtschPrt=_.KtschPrt;Z.Ewformprt=_.Ewformprt;Z.PlanvPrtText=D[H].PlanvPrtText;Z.SteufPrtText=D[H].SteufPrtText;Z.KtschPrtText=D[H].KtschPrtText;Z.EwformprtText=D[H].EwformprtText;Z.SteufRef=_.SteufRef;Z.KtschRef=_.KtschRef;Z.EwformRef=_.EwformRef}else{Z.PlanvPrt="";Z.SteufPrt="";Z.KtschPrt="";Z.Ewformprt="";Z.PlanvPrtText="";Z.SteufPrtText="";Z.KtschPrtText="";Z.EwformprtText="";Z.SteufRef=false;Z.KtschRef=false;Z.EwformRef=false}}if(n.EqLAM.results.length>0){var j=n.EqLAM.results;for(var A=0;A<j.length;A++){if(j[A].Equi===v.Equnr){var Q={Equi:j[A].Equi,Lrpid:j[A].Lrpid,LrpidDesc:j[A].LrpDescr,Strtptatr:j[A].Strtptatr,Endptatr:j[A].Endptatr,Length:j[A].Length,LinUnit:j[A].LinUnit,LinUnitDesc:j[A].Uomtext,Startmrkr:j[A].Startmrkr,Endmrkr:j[A].Endmrkr,Mrkdisst:j[A].Mrkdisst,Mrkdisend:j[A].Mrkdisend,MrkrUnit:j[A].MrkrUnit};Z.lam=Q;break}}}if(Z.Equnr===M&&Z.EquipmentCatogory==="L"&&s.lamSwitch==="X"){Z.lam=g;if(n.EqLAM.results.length>0){s.equiLAM=n.EqLAM.results}}if(v.Type===true){Z.viewParameter="create"}if(v.Type===false){Z.viewParameter="change";Z.EqunrEnabled=false;if(Z.EquipmentCatogory===""||Z.EquipmentCatogory===undefined){Z.EquipCatEnabled=true}else{Z.EquipCatEnabled=false}if(Z.Maintplant===""||Z.Maintplant===undefined){Z.MaintplantEnabled=true}else{Z.MaintplantEnabled=false}if(Z.Tplnr===""||Z.Tplnr===undefined){Z.TplnrEnabled=true}else{Z.TplnrEnabled=false}}if(v.Swerk!==""){Z.BukrsEnabled=false}else{Z.BukrsEnabled=true}if(v.Eqtyp!=="P"){Z.Tplnr=v.TplnEilo;Z.Pltxt=v.Flocdescription;Z.TplnrEnabled=true}else{Z.Tplnr="";Z.Pltxt="";Z.TplnrEnabled=false}if(Z.SuperordinateEquip!==""&&Z.SuperordinateEquip!==undefined){Z.TplnrEnabled=false;Z.SuperordinateEquipEnabled=true}else if(Z.Tplnr!==""&&Z.Tplnr!==undefined){Z.TplnrEnabled=true;Z.SuperordinateEquipEnabled=false}if(Z.SuperordinateEquip!==""&&Z.SuperordinateEquip!==undefined||Z.Tplnr!==""&&Z.Tplnr!==undefined){Z.MaintplantEnabled=true}else{Z.MaintplantEnabled=true}if(n.EqAddr){if(n.EqAddr.results){var q=n.EqAddr.results;if(q){if(q.length>0){for(var G=0;G<q.length;G++){if(Z.Equnr===q[G].Equi){var J=sap.ui.getCore().getModel("equiAddressView");var X=J.getData();var Y=true;var ae,ie;if(X.length>0){for(var re=0;re<X.length;re++){if(v.Equnr===X[re].Equnr){Y=false;ie=re;break}}}if(Y===true){if(Z.SuperordinateEquip!==""&&Z.SuperordinateEquip!==undefined||Z.Tplnr!==""&&Z.Tplnr!==undefined){ae={Equnr:v.Equnr,Tplnr:Z.Tplnr,IsEditable:q[G].IsEditable};X.push(ae);J.setData(X)}}if(Y===false){if(Z.SuperordinateEquip!==""&&Z.SuperordinateEquip!==undefined||Z.Tplnr!==""&&Z.Tplnr!==undefined){X[ie].Equnr=v.Equnr;X[ie].Tplnr=v.Tplnr;X[ie].IsEditable=q[G].IsEditable;J.setData(X)}}Z.IsEditable=q[G].IsEditable;Z.Title=q[G].Titletxt?q[G].Titletxt:"";Z.TitleCode=q[G].Title?q[G].Title:"";Z.Name1=q[G].Name1?q[G].Name1:"";Z.Name2=q[G].Name2?q[G].Name2:"";Z.Name3=q[G].Name3?q[G].Name3:"";Z.Name4=q[G].Name4?q[G].Name4:"";Z.Sort1=q[G].Sort1?q[G].Sort1:"";Z.Sort2=q[G].Sort2?q[G].Sort2:"";Z.NameCo=q[G].NameCo?q[G].NameCo:"";Z.PostCod1=q[G].PostCod1?q[G].PostCod1:"";Z.City1=q[G].City1?q[G].City1:"";Z.Building=q[G].Building?q[G].Building:"";Z.Floor=q[G].Floor?q[G].Floor:"";Z.Roomnum=q[G].Roomnum?q[G].Roomnum:"";Z.AddrLocation=q[G].Location?q[G].Location:"";Z.Strsuppl1=q[G].Strsuppl1?q[G].Strsuppl1:"";Z.Strsuppl2=q[G].Strsuppl2?q[G].Strsuppl2:"";Z.Strsuppl3=q[G].Strsuppl3?q[G].Strsuppl3:"";Z.RefPosta=q[G].RefPosta?q[G].RefPosta:"";Z.Landx=q[G].Landx?q[G].Landx:"";Z.TimeZone=q[G].TimeZone?q[G].TimeZone:"";Z.Region=q[G].RfePost?q[G].RfePost:"";Z.RegionDesc=q[G].Regiotxt?q[G].Regiotxt:""}}}else{Z.Title=Z.Title?Z.Title:"";Z.TitleCode=Z.TitleCode?Z.TitleCode:"";Z.Name1=Z.Name1?Z.Name1:"";Z.Name2=Z.Name2?Z.Name2:"";Z.Name3=Z.Name3?Z.Name3:"";Z.Name4=Z.Name4?Z.Name4:"";Z.Sort1=Z.Sort1?Z.Sort1:"";Z.Sort2=Z.Sort2?Z.Sort2:"";Z.NameCo=Z.NameCo?Z.NameCo:"";Z.PostCod1=Z.PostCod1?Z.PostCod1:"";Z.City1=Z.City1?Z.City1:"";Z.Building=Z.Building?Z.Building:"";Z.Floor=Z.Floor?Z.Floor:"";Z.Roomnum=Z.Roomnum?Z.Roomnum:"";Z.Strsuppl1=Z.Strsuppl1?Z.Strsuppl1:"";Z.Strsuppl2=Z.Strsuppl2?Z.Strsuppl2:"";Z.Strsuppl3=Z.Strsuppl3?Z.Strsuppl3:"";Z.AddrLocation=Z.AddrLocation?Z.AddrLocation:"";Z.RefPosta=Z.RefPosta?Z.RefPosta:"";Z.Landx=Z.Landx?Z.Landx:"";Z.TimeZone=Z.TimeZone?Z.TimeZone:"";Z.Region=Z.Region?Z.Region:"";Z.RegionDesc=Z.RegionDesc?Z.RegionDesc:""}}}}if(Z.Equnr===M){var J=sap.ui.getCore().getModel("equiAddressView");var X=J.getData();var Y=true;var ae,ie;if(X.length>0){for(var re=0;re<X.length;re++){if(Z.Equnr===X[re].Equnr){Y=false;ie=re;break}}}if(Y===true){if(Z.SuperordinateEquip!==""&&Z.SuperordinateEquip!==undefined||Z.Tplnr!==""&&Z.Tplnr!==undefined){ae={Equnr:Z.Equnr,Tplnr:Z.Tplnr,IsEditable:c.IsEditable};X.push(ae);J.setData(X)}}if(Y===false){if(Z.SuperordinateEquip!==""&&Z.SuperordinateEquip!==undefined||Z.Tplnr!==""&&Z.Tplnr!==undefined){X[ie].Equnr=Z.Equnr;X[ie].Tplnr=Z.Tplnr;X[ie].IsEditable=Z.IsEditable;J.setData(X)}}Z.IsEditable=c.IsEditable;Z.Title=c.Titletxt?c.Titletxt:"";Z.TitleCode=c.Title?c.Title:"";Z.Name1=c.Name1?c.Name1:"";Z.Name2=c.Name2?c.Name2:"";Z.Name3=c.Name3?c.Name3:"";Z.Name4=c.Name4?c.Name4:"";Z.Sort1=c.Sort1?c.Sort1:"";Z.Sort2=c.Sort2?c.Sort2:"";Z.NameCo=c.NameCo?c.NameCo:"";Z.PostCod1=c.PostCod1?c.PostCod1:"";Z.City1=c.City1?c.City1:"";Z.Building=c.Building?c.Building:"";Z.Floor=c.Floor?c.Floor:"";Z.Roomnum=c.Roomnum?c.Roomnum:"";Z.AddrLocation=c.Location?c.Location:"";Z.Strsuppl1=c.Strsuppl1?c.Strsuppl1:"";Z.Strsuppl2=c.Strsuppl2?c.Strsuppl2:"";Z.Strsuppl3=c.Strsuppl3?c.Strsuppl3:"";Z.RefPosta=c.RefPosta?c.RefPosta:"";Z.Landx=c.Landx?c.Landx:"";Z.TimeZone=c.TimeZone?c.TimeZone:"";Z.Region=c.RfePost?c.RfePost:"";Z.RegionDesc=c.Regiotxt?c.Regiotxt:"";if(n.EqAddr.results){s.equiAddr=n.EqAddr.results}}var w=n.EqAddrI.results;if(w.length>0){for(var x=0;x<w.length;x++){if(w[x].Equi===Z.Equnr){w[x].AdNationEnable=false;w[x].City1iVS="None";w[x].StreetiVS="None";Z.intlAddr.push(w[x])}}}if(Z.Equnr===M&&Z.intlAddr.length>0){s.equiIntlAddr=Z.intlAddr;Z.intlAddr=f}else{s.equiIntlAddr=[]}if(n.EqDFPS){if(n.EqDFPS.results){var ne=n.EqDFPS.results;if(ne){if(ne.length>0){for(var se=0;se<ne.length;se++){if(Z.Equnr===ne[se].Equi){Z.dfps.Equnr=ne[se].Equi;Z.dfps.MeOwner=ne[se].MeOwner;Z.dfps.MeUser=ne[se].MeUser;Z.dfps.Tailno=ne[se].DeviceId;Z.dfps.Area=ne[se].Topsiteid;Z.dfps.AreaDesc=ne[se].Topsitede;Z.dfps.AreaPrfl=ne[se].AreaPro;Z.dfps.Site=ne[se].SiteId;Z.dfps.SiteDesc=ne[se].SiteDesc;Z.dfps.SitePrfl=ne[se].SitePro;Z.dfps.MPO=ne[se].MpoId;Z.dfps.MPODesc=ne[se].MpoDescr;Z.dfps.RIC=ne[se].RicId;Z.dfps.RICDesc=ne[se].RicDescr;Z.dfps.ModelId=ne[se].ModelId;Z.dfps.ModelIdDesc=ne[se].ModelDes;Z.dfps.ForeignEq=i.XtoTrue(ne[se].Foreignob);Z.dfps.TechSts=ne[se].TecState;Z.dfps.OperSts=ne[se].DepState;Z.dfps.Remark=ne[se].DfpsRmrk;if(ne[se].DeviceId!==""){Z.dfps.dfpsCrtEnabled=false;Z.dfps.dfpsDltEnabled=true;Z.dfps.dfpsEnabled=true;Z.dfps.TailnoReq=true}}}}}}}if(n.EqClass){var O=n.EqClass.results;if(O){if(O.length>0){for(var le=0;le<O.length;le++){if(Z.Equnr===O[le].Equi){O[le].ctEnable=false;O[le].classEnable=false;O[le].ClassTypeDesc=O[le].Artxt;delete O[le].Artxt;delete O[le].Changerequestid;delete O[le].Clint;delete O[le].Service;Z.classItems.push(O[le])}}Z.charNewButton=true;if(s.class&&s.class.getId().includes("detailEqui")===true){s.class.setModel(new t(Z.classItems))}}}}if(n.EqVal){var W=n.EqVal.results;if(W){if(W.length>0){for(var oe=0;oe<W.length;oe++){if(Z.Equnr===W[oe].Equi){W[oe].cNameEnable=false;W[oe].Textbz=W[oe].Atwtb;delete W[oe].Ataut;delete W[oe].Ataw1;delete W[oe].Atawe;delete W[oe].Atcod;delete W[oe].Atflb;delete W[oe].Atflv;delete W[oe].Atimb;delete W[oe].Atsrt;delete W[oe].Atvglart;delete W[oe].Atzis;delete W[oe].Changerequestid;delete W[oe].CharName;delete W[oe].Charid;delete W[oe].Classtype;delete W[oe].Service;delete W[oe].Valcnt;W[oe].slNo=oe+1;W[oe].flag=W[oe].Class+"-"+W[oe].slNo;Z.characteristics.push(W[oe])}}if(s.char&&s.char.getId().includes("detailEqui")===true){s.char.setModel(new t(Z.characteristics))}}}}if(n.EqLAMCH){var K=n.EqLAMCH.results;if(K){if(K.length>0){for(var z=0;z<K.length;z++){if(Z.Equnr===K[z].Equi){K[z].linCharEnable=true;Z.linearChar.push(K[z])}}}}}if(Z.UstaEqui){te.visible=true}else{te.visible=false}ee.setData(te);d.push(Z)}h.setData(d);for(var de=0;de<h.getData().length;de++){if(M===h.getData()[de].Equnr){s.rowIndex="/"+de;var ue=new t;var pe=h.getProperty(s.rowIndex);pe.Title=pe.Title?pe.Title:"";pe.TitleCode=pe.TitleCode?pe.TitleCode:"";pe.Name1=pe.Name1?pe.Name1:"";pe.Name2=pe.Name2?pe.Name2:"";pe.Name3=pe.Name3?pe.Name3:"";pe.Name4=pe.Name4?pe.Name4:"";pe.Sort1=pe.Sort1?pe.Sort1:"";pe.Sort2=pe.Sort2?pe.Sort2:"";pe.NameCo=pe.NameCo?pe.NameCo:"";pe.PostCod1=pe.PostCod1?pe.PostCod1:"";pe.City1=pe.City1?pe.City1:"";pe.Building=pe.Building?pe.Building:"";pe.Floor=pe.Floor?pe.Floor:"";pe.Roomnum=pe.Roomnum?pe.Roomnum:"";pe.Strsuppl1=pe.Strsuppl1?pe.Strsuppl1:"";pe.Strsuppl2=pe.Strsuppl2?pe.Strsuppl2:"";pe.Strsuppl3=pe.Strsuppl3?pe.Strsuppl3:"";pe.AddrLocation=pe.AddrLocation?pe.AddrLocation:"";pe.RefPosta=pe.RefPosta?pe.RefPosta:"";pe.Landx=pe.Landx?pe.Landx:"";pe.TimeZone=pe.TimeZone?pe.TimeZone:"";pe.Region=pe.Region?pe.Region:"";pe.RegionDesc=pe.RegionDesc?pe.RegionDesc:"";if(pe.Title!==""&&pe.Title!==undefined||pe.TitleCode!==""&&pe.TitleCode!==undefined||pe.Name1!==""&&pe.Name1!==undefined||pe.Name2!==""&&pe.Name2!==undefined||pe.Name3!==""&&pe.Name3!==undefined||pe.Name4!==""&&pe.Name4!==undefined||pe.Sort1!==""&&pe.Sort1!==undefined||pe.Sort2!==""&&pe.Sort2!==undefined||pe.NameCo!==""&&pe.NameCo!==undefined||pe.PostCod1!==""&&pe.PostCod1!==undefined||pe.City1!==""&&pe.City1!==undefined||pe.Building!==""&&pe.Building!==undefined||pe.Floor!==""&&pe.Floor!==undefined||pe.Roomnum!==""&&pe.Roomnum!==undefined||pe.AddrLocation!==""&&pe.AddrLocation!==undefined||pe.Strsuppl1!==""&&pe.Strsuppl1!==undefined||pe.Strsuppl2!==""&&pe.Strsuppl2!==undefined||pe.Strsuppl3!==""&&pe.Strsuppl3!==undefined||pe.TimeZone!==""&&pe.TimeZone!==undefined||pe.RefPosta!==""&&pe.RefPosta!==undefined||pe.Region!==""&&pe.Region!==undefined){pe.RefPostaLblReq=true;var ge=s.getView().getModel("equiAddressView");var ce=ge.getData();ce.enabled=pe.IsEditable;ge.setData(ce)}ue.setData(pe);s.getView().setModel(ue,s.oModelName);s.lam.setModel(ue,"AIWLAM");var fe=[ue.getData()];var me=$.map(fe,function(e){return $.extend(true,{},e)});var Se=new t;Se.setData(me);s.getView().setModel(Se,"SUP_EQUI_DATA");var he=sap.ui.getCore().getModel("SUP_EQUI_DATA");var Ee=he.getData();var Me=true;for(var De=0;De<Ee.length;De++){if(pe.Equnr===Ee[De].Equnr){Me=false}}if(Me===true){if(pe.SuperordinateEquip!==""&&pe.SuperordinateEquip!==undefined||pe.Tplnr!==""&&pe.Tplnr!==undefined){Ee.push(me[0]);he.setData(Ee)}}te.tableBusy=false;ee.setData(te);break}}var ve=sap.ui.getCore().getModel("dataOriginMOP").getData().EQ;for(var Ce=0;Ce<n.Equipment.results.length;Ce++){var m=n.Equipment.results[Ce];for(var x=0;x<ve.length;x++){if(m.Equnr===ve[x].key){var Ae=ve[x].DOI;if(m.Swerki===""){Ae[0].maintenance=false;Ae[0].instLoc=false;Ae[0].SupFlVal="";Ae[0].currentVal="";Ae[0].targetVal=""}else if(m.Swerki==="D"){Ae[0].maintenance=true;Ae[0].instLoc=false;Ae[0].SupFlVal="";Ae[0].currentVal=m.Swerk;Ae[0].targetVal=m.Swerk}else{Ae[0].maintenance=false;Ae[0].instLoc=true;Ae[0].SupFlVal=m.Swerk;Ae[0].currentVal="";Ae[0].targetVal=m.Swerk}if(m.Storti===""){Ae[1].maintenance=false;Ae[1].instLoc=false;Ae[1].SupFlVal="";Ae[1].currentVal="";Ae[1].targetVal=""}else if(m.Storti==="D"){Ae[1].maintenance=true;Ae[1].instLoc=false;Ae[1].SupFlVal="";Ae[1].currentVal=m.StorEilo;Ae[1].targetVal=m.StorEilo}else{Ae[1].maintenance=false;Ae[1].instLoc=true;Ae[1].SupFlVal=m.StorEilo;Ae[1].currentVal="";Ae[1].targetVal=m.StorEilo}if(m.Beberi===""){Ae[2].maintenance=false;Ae[2].instLoc=false;Ae[2].SupFlVal="";Ae[2].currentVal="";Ae[2].targetVal=""}else if(m.Beberi==="D"){Ae[2].maintenance=true;Ae[2].instLoc=false;Ae[2].SupFlVal="";Ae[2].currentVal=m.BebeEilo;Ae[2].targetVal=m.BebeEilo}else{Ae[2].maintenance=false;Ae[2].instLoc=true;Ae[2].SupFlVal=m.BebeEilo;Ae[2].currentVal="";Ae[2].targetVal=m.BebeEilo}if(m.Ppsidi===""){Ae[3].maintenance=false;Ae[3].instLoc=false;Ae[3].SupFlVal="";Ae[3].currentVal="";Ae[3].targetVal=""}else if(m.Ppsidi==="D"){Ae[3].maintenance=true;Ae[3].instLoc=false;Ae[3].SupFlVal="";Ae[3].currentVal=m.ArbpEilo;Ae[3].targetVal=m.ArbpEilo}else{Ae[3].maintenance=false;Ae[3].instLoc=true;Ae[3].SupFlVal=m.ArbpEilo;Ae[3].currentVal="";Ae[3].targetVal=m.ArbpEilo}if(m.Abckzi===""){Ae[4].maintenance=false;Ae[4].instLoc=false;Ae[4].SupFlVal="";Ae[4].currentVal="";Ae[4].targetVal=""}else if(m.Abckzi==="D"){Ae[4].maintenance=true;Ae[4].instLoc=false;Ae[4].SupFlVal="";Ae[4].currentVal=m.AbckEilo;Ae[4].targetVal=m.AbckEilo}else{Ae[4].maintenance=false;Ae[4].instLoc=true;Ae[4].SupFlVal=m.AbckEilo;Ae[4].currentVal="";Ae[4].targetVal=m.AbckEilo}if(m.Kostli===""){Ae[5].maintenance=false;Ae[5].instLoc=false;Ae[5].SupFlVal="";Ae[5].currentVal="";Ae[5].targetVal=""}else if(m.Kostli==="D"){Ae[5].maintenance=true;Ae[5].instLoc=false;Ae[5].SupFlVal="";Ae[5].currentVal=m.KostEilo;Ae[5].targetVal=m.KostEilo}else{Ae[5].maintenance=false;Ae[5].instLoc=true;Ae[5].SupFlVal=m.KostEilo;Ae[5].currentVal="";Ae[5].targetVal=m.KostEilo}if(m.Iwerki===""){Ae[6].maintenance=false;Ae[6].instLoc=false;Ae[6].SupFlVal="";Ae[6].currentVal="";Ae[6].targetVal=""}else if(m.Iwerki==="D"){Ae[6].maintenance=true;Ae[6].instLoc=false;Ae[6].SupFlVal="";Ae[6].currentVal=m.PplaEeqz;Ae[6].targetVal=m.PplaEeqz}else{Ae[6].maintenance=false;Ae[6].instLoc=true;Ae[6].SupFlVal=m.PplaEeqz;Ae[6].currentVal="";Ae[6].targetVal=m.PplaEeqz}if(m.Ingrpi===""){Ae[7].maintenance=false;Ae[7].instLoc=false;Ae[7].SupFlVal="";Ae[7].currentVal="";Ae[7].targetVal=""}else if(m.Ingrpi==="D"){Ae[7].maintenance=true;Ae[7].instLoc=false;Ae[7].SupFlVal="";Ae[7].currentVal=m.IngrEeqz;Ae[7].targetVal=m.IngrEeqz}else{Ae[7].maintenance=false;Ae[7].instLoc=true;Ae[7].SupFlVal=m.IngrEeqz;Ae[7].currentVal="";Ae[7].targetVal=m.IngrEeqz}if(m.Gewrki===""){Ae[8].maintenance=false;Ae[8].instLoc=false;Ae[8].SupFlVal="";Ae[8].currentVal="";Ae[8].targetVal=""}else if(m.Gewrki==="D"){Ae[8].maintenance=true;Ae[8].instLoc=false;Ae[8].SupFlVal="";Ae[8].currentVal=m.ArbpEeqz;Ae[8].targetVal=m.ArbpEeqz}else{Ae[8].maintenance=false;Ae[8].instLoc=true;Ae[8].SupFlVal=m.ArbpEeqz;Ae[8].currentVal="";Ae[8].targetVal=m.ArbpEeqz}if(m.Adrnri===""){Ae[10].maintenance=false;Ae[10].instLoc=false;Ae[10].SupFlVal="";Ae[10].currentVal="";Ae[10].targetVal=""}else if(m.Adrnri==="D"){Ae[10].maintenance=true;Ae[10].instLoc=false;Ae[10].SupFlVal="";Ae[10].currentVal=m.Adrnr;Ae[10].targetVal=m.Adrnr}else{Ae[10].maintenance=false;Ae[10].instLoc=true;Ae[10].SupFlVal=m.Adrnr;Ae[10].currentVal="";Ae[10].targetVal=m.Adrnr}}}}for(var x=0;x<ve.length;x++){if(ve[x].key===M){s.getView().getModel("dataOrigin").setData(ve[x].DOI)}}}te.tableBusy=false;ee.setData(te);if(e!==""&&a==="EQ"){s.superiorEquipment=e;s.superiorEqDesc=r}else if(e!==""&&a==="FL"){s.functionalLocation=e;s.functionalLocDesc=r}s.getView().getModel("dataOrigin").setProperty("/originDerive",n);s.openDoiView(undefined,n)};var ie=function(e){s.BusyDialog.close();var t=[];if(JSON.parse(e.responseText).error.innererror.errordetails===undefined||JSON.parse(e.responseText).error.innererror.errordetails.length===0){t[0]=JSON.parse(e.responseText).error.message.value}else{for(var a=0;a<JSON.parse(e.responseText).error.innererror.errordetails.length;a++){t[a]=JSON.parse(e.responseText).error.innererror.errordetails[a].message}}var i=t.join("\n");te.tableBusy=false;ee.setData(te);MessageBox.show(i,{title:"Error",icon:sap.m.MessageBox.Icon.ERROR,onClose:function(){}})};if(m.FLAddrI.length>0){m.FLAddrI=$.map(m.FLAddrI,function(e){return $.extend(true,{},e)});for(var re=0;re<m.FLAddrI.length>0;re++){delete m.FLAddrI[re].AdNationEnable;delete m.FLAddrI[re].City1iVS;delete m.FLAddrI[re].StreetiVS}}if(m.EqAddrI.length>0){m.EqAddrI=$.map(m.EqAddrI,function(e){return $.extend(true,{},e)});for(var re=0;re<m.EqAddrI.length>0;re++){delete m.EqAddrI[re].AdNationEnable;delete m.EqAddrI[re].City1iVS;delete m.EqAddrI[re].StreetiVS}}s.BusyDialog.open();o.create(l,m,{success:ae,error:ie})},fetchSupFlocEquiDataChange:function(e,a,r,n){var s=this;var l="/ChangeRequestSet";var o=s.getView().getModel();var d=[];var u={};var p={};var g={};var c={};var f=[];var m={};var S={ChangeRequestType:"AIWEAM0P",CrDescription:"",Reason:"01",DeriveData:true,FuncLoc:[],FLAddr:[],FLAddrI:[],FLLAM:[],FLClass:[],FLVal:[],FLALTLBEL:[],Equipment:[],EqAddr:[],EqAddrI:[],EqPRT:[],EqLAM:[],EqClass:[],EqVal:[],MSPoint:[],MSLAM:[],MSClass:[],MSVal:[],MPLAN:[],MPItem:[],MPLAM:[],MPOBList:[],MPCycle:[],MRBHeader:[],MRBItem:[],MRBSBIT:[],EBHeader:[],EBItem:[],EBSBIT:[],FBHeader:[],FBItem:[],FBSBIT:[],WBHeader:[],WBItem:[],WBSBIT:[],ONetwork:[],ONLAM:[],Workcenter:[],WCCost:[],GTList:[],GTOprs:[],GTComp:[],GTClass:[],GTVal:[],ETList:[],ETOprs:[],ETComp:[],ETClass:[],ETVal:[],FTList:[],FTOprs:[],FTComp:[],FTClass:[],FTVal:[],Olink:[],OLClass:[],OLVal:[],Messages:[],Equi_DOI:[],FLDOI:[],FLLAMCH:[],EqLAMCH:[],EqDFPS:[]};var h=sap.ui.getCore().getModel("AIWFLOC");var E=sap.ui.getCore().getModel("AIWEQUI");var M=s.getView().getModel(s.oModelName);var D;if(s.oModelName==="AIWEQUI"){D=M.getData().Equnr}var v=sap.ui.getCore().getModel("AIWEQUI").getData();var C=sap.ui.getCore().getModel("AIWFLOC").getData();if(C.length>0){for(var A=0;A<C.length;A++){var T={Tplnr:C[A].Functionallocation,Txtmi:C[A].Flocdescription,TplkzFlc:C[A].Strucindicator,Tplxt:C[A].StrucIndicatorDesc,EditMask:C[A].EditMask,Hierarchy:C[A].Hierarchy,Fltyp:C[A].Floccategory,Flttx:C[A].FlocCategoryDesc,Swerk:C[A].Maintplant,Plantname:C[A].MaintplantDesc,StorFloc:C[A].Location,Locationdesc:C[A].Locationdesc,Abckzfloc:C[A].Abckz,Abctx:C[A].Abctx,Bukrsfloc:C[A].Bukrs,Butxt:C[A].Butxt,City:C[A].City,KostFloc:C[A].Kostl,KokrFloc:C[A].Kokrs,Contareaname:C[A].Mctxt,PlntFloc:C[A].Werks,Planningplantdes:C[A].Planningplantdes,Ingrp:C[A].Ingrp,Plannergrpdesc:C[A].Innam,Arbplfloc:C[A].Arbpl,Workcenterdesc:C[A].Ktext,Wergwfloc:C[A].WcWerks,Gewrkfloc:C[A].MainArbpl,MainWcDesc:C[A].MainKtext,MainWcPlant:C[A].MainWerks,Tplma:C[A].SupFunctionallocation,Supflocdesc:C[A].SupFlocdescription,BeberFl:C[A].BeberFl,Fing:C[A].Fing,Tele:C[A].Tele,Submtiflo:C[A].ConstrType,Constdesc:C[A].ConstructionDesc,Eqart:C[A].TechnicalObjectTyp,Eartx:C[A].Description,Stattext:C[A].Stattext,StsmFloc:C[A].StsmEqui,Statproftxt:C[A].StsmEquiDesc,UstwFloc:C[A].UstwEqui,UswoFloc:C[A].UswoEqui,UstaFloc:C[A].UstaEqui,IsMenu:C[A].menuAction,Adrnr:C[A].Adrnr,Adrnri:C[A].Adrnri};var q=sap.ui.getCore().getModel("dataOriginMOP").getData().FL;if(q&&q.length>0){var b=q[A].DOI;T.Swerki=b[0].instLoc?"H":b[0].maintenance?"D":"";T.Storti=b[1].instLoc?"H":b[1].maintenance?"D":"";T.Beberi=b[2].instLoc?"H":b[2].maintenance?"D":"";T.Ppsidi=b[3].instLoc?"H":b[3].maintenance?"D":"";T.Abckzi=b[4].instLoc?"H":b[4].maintenance?"D":"";T.Bukrsi=b[5].instLoc?"H":b[5].maintenance?"D":"";T.Kostli=b[6].instLoc?"H":b[6].maintenance?"D":"";T.Kokrsi=b[7].instLoc?"H":b[7].maintenance?"D":"";T.Iwerki=b[8].instLoc?"H":b[8].maintenance?"D":"";T.Ingrpi=b[9].instLoc?"H":b[9].maintenance?"D":"";T.Lgwidi=b[10].instLoc?"H":b[10].maintenance?"D":"";T.Adrnri=b[12].instLoc?"H":b[12].maintenance?"D":""}if(C[A].viewParameter==="create"){T.Type=true}S.FuncLoc.push(T);if(C[A].Title!==""&&C[A].Title!==undefined||C[A].TitleCode!==""&&C[A].TitleCode!==undefined||C[A].Name1!==""&&C[A].Name1!==undefined||C[A].Name2!==""&&C[A].Name2!==undefined||C[A].Name3!==""&&C[A].Name3!==undefined||C[A].Name4!==""&&C[A].Name4!==undefined||C[A].Sort1!==""&&C[A].Sort1!==undefined||C[A].Sort2!==""&&C[A].Sort2!==undefined||C[A].NameCo!==""&&C[A].NameCo!==undefined||C[A].PostCod1!==""&&C[A].PostCod1!==undefined||C[A].City1!==""&&C[A].City1!==undefined||C[A].Building!==""&&C[A].Building!==undefined||C[A].Floor!==""&&C[A].Floor!==undefined||C[A].Roomnum!==""&&C[A].Roomnum!==undefined||C[A].AddrLocation!==""&&C[A].AddrLocation!==undefined||C[A].Strsuppl1!==""&&C[A].Strsuppl1!==undefined||C[A].Strsuppl2!==""&&C[A].Strsuppl2!==undefined||C[A].Strsuppl3!==""&&C[A].Strsuppl3!==undefined||C[A].TimeZone!==""&&C[A].TimeZone!==undefined||C[A].RefPosta!==""&&C[A].RefPosta!==undefined||C[A].Region!==""&&C[A].Region!==undefined){var P={Funcloc:C[A].Functionallocation,Title:C[A].TitleCode,Name1:C[A].Name1,Name2:C[A].Name2,Name3:C[A].Name3,Name4:C[A].Name4,Sort1:C[A].Sort1,Sort2:C[A].Sort2,NameCo:C[A].NameCo,PostCod1:C[A].PostCod1,City1:C[A].City1,Building:C[A].Building,Floor:C[A].Floor,Roomnum:C[A].Roomnum,Strsuppl1:C[A].Strsuppl1,Strsuppl2:C[A].Strsuppl2,Strsuppl3:C[A].Strsuppl3,Location:C[A].AddrLocation,RPostafl:C[A].RefPosta,Landx:C[A].Landx,TimeZone:C[A].TimeZone,RPostFl:C[A].Region,Regiotxt:C[A].RegionDesc};S.FLAddr.push(P)}var V=C[A].intlAddr;if(V.length>0){for(var L=0;L<V.length;L++){S.FLAddrI.push(V[L])}}if(s.AltLblDerv==="2"&&C[A].altlbl.length>0){for(var N=0;N<C[A].altlbl.length;N++){var F={Funcloc:C[A].Functionallocation,AltAlkey:C[A].altlbl[N].AltAlkey,AltStrno:C[A].altlbl[N].AltStrno,AltTplkz:C[A].altlbl[N].AltTplkz};S.FLALTLBEL.push(F)}}var I={Funcloc:C[A].Functionallocation,Lrpid:C[A].lam.Lrpid,Strtptatr:C[A].lam.Strtptatr,Endptatr:C[A].lam.Endptatr,Length:C[A].lam.Length,LinUnit:C[A].lam.LinUnit,Startmrkr:C[A].lam.Startmrkr,Endmrkr:C[A].lam.Endmrkr,Mrkdisst:C[A].lam.Mrkdisst,Mrkdisend:C[A].lam.Mrkdisend,MrkrUnit:C[A].lam.MrkrUnit,LamDer:C[A].lam.LamDer};S.FLLAM.push(I);var w=C[A].classItems;if(w){if(w.length>0){for(var x=0;x<w.length;x++){var k={Funcloc:C[A].Functionallocation,Classtype:w[x].Classtype,Class:w[x].Class,Clstatus1:w[x].Clstatus1,Artxt:w[x].ClassTypeDesc};S.FLClass.push(k)}}}var y=C[A].characteristics;if(y){if(y.length>0){for(var R=0;R<y.length;R++){var O={Funcloc:C[A].Functionallocation,Atnam:y[R].Atnam,Textbez:y[R].Textbez,Atwrt:y[R].Atwrt,Class:y[R].Class};S.FLVal.push(O)}}}var B=C[A].linearChar;if(B){if(B.length>0){var W=$.map(B,function(e){return $.extend(true,{},e)});for(var R=0;R<W.length;R++){delete W[R].linCharEnable;W[R].Funcloc=C[A].Functionallocation;S.FLLAMCH.push(W[R])}}}}}if(v.length>0){for(var U=0;U<v.length;U++){var K={Herst:v[U].Herst,Equnr:v[U].Equnr,Txtmi:v[U].Eqktx,Swerk:v[U].Maintplant,Name1:v[U].MaintplantDesc,TplnEilo:v[U].Tplnr,Flocdescription:v[U].Pltxt,Eqtyp:v[U].EquipmentCatogory,Etytx:v[U].EquipCatgDescription,Eqart:v[U].TechnicalObjectTyp,Eartx:v[U].Description,Typbz:v[U].Typbz,SubmEeqz:v[U].ConstrType,Constdesc:v[U].ConstructionDesc,BukrEilo:v[U].Bukrs,Butxt:v[U].Butxt,HequEeqz:v[U].SuperordinateEquip,SuperordEqDes:v[U].SuperordinateEquipDesc,TidnEeqz:v[U].TechIdNum,KostEilo:v[U].Kostl,KokrEilo:v[U].Kokrs,Contareaname:v[U].Mctxt,StorEilo:v[U].Location,Locationdesc:v[U].Locationdesc,AbckEilo:v[U].Abckz,Abctx:v[U].Abctx,PplaEeqz:v[U].Werks,Planningplantdes:v[U].Planningplantdes,IngrEeqz:v[U].Ingrp,Plannergrpdesc:v[U].Innam,Serge:v[U].Serge,MapaEeqz:v[U].MapaEeqz,Stattext:v[U].Stattext,StsmEqui:v[U].StsmEqui,Statproftxt:v[U].StsmEquiDesc,UstwEqui:v[U].UstwEqui,UswoEqui:v[U].UswoEqui,UstaEqui:v[U].UstaEqui,Answt:v[U].Answt,Ansdt:s._formatDate(v[U].Ansdt),Waers:v[U].Waers,ArbpEilo:v[U].Arbpl,Workcenterdesc:v[U].Ktext,WorkCenterPlant:v[U].WcWerks,ArbpEeqz:v[U].MainArbpl,MainWcDesc:v[U].MainKtext,MainWcPlant:v[U].MainWerks,BebeEilo:v[U].BeberFl,Fing:v[U].Fing,Tele:v[U].Tele,HeqnEeqz:v[U].EquipPosition,IsMenu:v[U].menuAction,Adrnr:v[U].Adrnr,Adrnri:v[U].Adrnri,Fhmkz:v[U].Fhmkz,Funcid:v[U].Funcid,Frcfit:v[U].Frcfit,Frcrmv:v[U].Frcrmv};var z=sap.ui.getCore().getModel("dataOriginMOP").getData().EQ;if(z&&z.length>0){var b=z[U].DOI;K.Swerki=b[0].instLoc?"R":b[0].maintenance?"D":"";K.Storti=b[1].instLoc?"R":b[1].maintenance?"D":"";K.Beberi=b[2].instLoc?"R":b[2].maintenance?"D":"";K.Ppsidi=b[3].instLoc?"R":b[3].maintenance?"D":"";K.Abckzi=b[4].instLoc?"R":b[4].maintenance?"D":"";K.Kostli=b[5].instLoc?"R":b[5].maintenance?"D":"";K.Iwerki=b[6].instLoc?"R":b[6].maintenance?"D":"";K.Ingrpi=b[7].instLoc?"R":b[7].maintenance?"D":"";K.Gewrki=b[8].instLoc?"R":b[8].maintenance?"D":"";K.Adrnri=b[10].instLoc?"R":b[10].maintenance?"D":""}if(v[U].viewParameter==="create"){K.Type=true}S.Equipment.push(K);if(v[U].Title!==""&&v[U].Title!==undefined||v[U].TitleCode!==""&&v[U].TitleCode!==undefined||v[U].Name1!==""&&v[U].Name1!==undefined||v[U].Name2!==""&&v[U].Name2!==undefined||v[U].Name3!==""&&v[U].Name3!==undefined||v[U].Name4!==""&&v[U].Name4!==undefined||v[U].Sort1!==""&&v[U].Sort1!==undefined||v[U].Sort2!==""&&v[U].Sort2!==undefined||v[U].NameCo!==""&&v[U].NameCo!==undefined||v[U].PostCod1!==""&&v[U].PostCod1!==undefined||v[U].City1!==""&&v[U].City1!==undefined||v[U].Building!==""&&v[U].Building!==undefined||v[U].Floor!==""&&v[U].Floor!==undefined||v[U].Roomnum!==""&&v[U].Roomnum!==undefined||v[U].AddrLocation!==""&&v[U].AddrLocation!==undefined||v[U].Strsuppl1!==""&&v[U].Strsuppl1!==undefined||v[U].Strsuppl2!==""&&v[U].Strsuppl2!==undefined||v[U].Strsuppl3!==""&&v[U].Strsuppl3!==undefined||v[U].TimeZone!==""&&v[U].TimeZone!==undefined||v[U].RefPosta!==""&&v[U].RefPosta!==undefined||v[U].Region!==""&&v[U].Region!==undefined){var H={Equi:v[U].Equnr,Title:v[U].TitleCode,Name1:v[U].Name1,Name2:v[U].Name2,Name3:v[U].Name3,Name4:v[U].Name4,Sort1:v[U].Sort1,Sort2:v[U].Sort2,NameCo:v[U].NameCo,PostCod1:v[U].PostCod1,City1:v[U].City1,Building:v[U].Building,Floor:v[U].Floor,Roomnum:v[U].Roomnum,Strsuppl1:v[U].Strsuppl1,Strsuppl2:v[U].Strsuppl2,Strsuppl3:v[U].Strsuppl3,Location:v[U].AddrLocation,RefPosta:v[U].RefPosta,Landx:v[U].Landx,TimeZone:v[U].TimeZone,RfePost:v[U].Region,Regiotxt:v[U].RegionDesc};S.EqAddr.push(H)}var V=v[U].intlAddr;if(V.length>0){for(var L=0;L<V.length;L++){S.EqAddrI.push(V[L])}}var Z={Equi:v[U].Equnr,PlanvPrt:v[U].PlanvPrt,SteufPrt:v[U].SteufPrt,KtschPrt:v[U].KtschPrt,Ewformprt:v[U].Ewformprt,SteufRef:v[U].SteufRef,KtschRef:v[U].KtschRef,EwformRef:v[U].EwformRef};S.EqPRT.push(Z);var _={Equi:v[U].Equnr,Lrpid:v[U].lam.Lrpid,Strtptatr:v[U].lam.Strtptatr,Endptatr:v[U].lam.Endptatr,Length:v[U].lam.Length,LinUnit:v[U].lam.LinUnit,Startmrkr:v[U].lam.Startmrkr,Endmrkr:v[U].lam.Endmrkr,Mrkdisst:v[U].lam.Mrkdisst,Mrkdisend:v[U].lam.Mrkdisend,MrkrUnit:v[U].lam.MrkrUnit,LamDer:v[U].lam.LamDer};S.EqLAM.push(_);if(v[U].dfps){var j={Equi:v[U].Equnr,DeviceId:v[U].dfps.Tailno,Topsiteid:v[U].dfps.Area,Topsitede:v[U].dfps.AreaDesc,AreaPro:v[U].dfps.AreaPrfl,SiteId:v[U].dfps.Site,SiteDesc:v[U].dfps.SiteDesc,SitePro:v[U].dfps.SitePrfl,MpoId:v[U].dfps.MPO,MpoDescr:v[U].dfps.MPODesc,RicId:v[U].dfps.RIC,RicDescr:v[U].dfps.RICDesc,ModelId:v[U].dfps.ModelId,ModelDes:v[U].dfps.ModelIdDesc,Foreignob:i.truetoX(v[U].dfps.ForeignEq),TecState:v[U].dfps.TechSts,DepState:v[U].dfps.OperSts,DfpsRmrk:v[U].dfps.Remark};S.EqDFPS.push(j)}var Q=v[U].classItems;if(Q){if(Q.length>0){for(var G=0;G<Q.length;G++){var J={Equi:v[U].Equnr,Classtype:Q[G].Classtype,Class:Q[G].Class,Clstatus1:Q[G].Clstatus1,Artxt:Q[G].ClassTypeDesc};S.EqClass.push(J)}}}var X=v[U].characteristics;if(X){if(X.length>0){for(var Y=0;Y<X.length;Y++){var ee={Equi:v[U].Equnr,Atnam:X[Y].Atnam,Textbez:X[Y].Textbez,Atwrt:X[Y].Atwrt,Class:X[Y].Class};S.EqVal.push(ee)}}}var B=v[U].linearChar;if(B){if(B.length>0){var W=$.map(B,function(e){return $.extend(true,{},e)});for(var R=0;R<W.length;R++){delete W[R].linCharEnable;W[R].Equi=v[U].Equnr;S.EqLAMCH.push(W[R])}}}}}var te=s.getView().getModel(s.oModelName).getData();var K={Herst:te.Herst,Equnr:te.Equnr,Txtmi:te.Eqktx,Swerk:te.Maintplant,Name1:te.MaintplantDesc,TplnEilo:te.Tplnr,Flocdescription:te.Pltxt,Eqtyp:te.EquipmentCatogory,Etytx:te.EquipCatgDescription,Eqart:te.TechnicalObjectTyp,Eartx:te.Description,Typbz:te.Typbz,SubmEeqz:te.ConstrType,Constdesc:te.ConstructionDesc,BukrEilo:te.Bukrs,Butxt:te.Butxt,HequEeqz:te.SuperordinateEquip,SuperordEqDes:te.SuperordinateEquipDesc,TidnEeqz:te.TechIdNum,KostEilo:te.Kostl,KokrEilo:te.Kokrs,Contareaname:te.Mctxt,StorEilo:te.Location,Locationdesc:te.Locationdesc,AbckEilo:te.Abckz,Abctx:te.Abctx,PplaEeqz:te.Werks,Planningplantdes:te.Planningplantdes,IngrEeqz:te.Ingrp,Plannergrpdesc:te.Innam,Serge:te.Serge,MapaEeqz:te.MapaEeqz,Stattext:te.Stattext,StsmEqui:te.StsmEqui,Statproftxt:te.StsmEquiDesc,UstwEqui:te.UstwEqui,UswoEqui:te.UswoEqui,UstaEqui:te.UstaEqui,Answt:te.Answt,Ansdt:s._formatDate(te.Ansdt),Waers:te.Waers,ArbpEilo:te.Arbpl,Workcenterdesc:te.Ktext,WorkCenterPlant:te.WcWerks,ArbpEeqz:te.MainArbpl,MainWcDesc:te.MainKtext,MainWcPlant:te.MainWerks,BebeEilo:te.BeberFl,Fing:te.Fing,Tele:te.Tele,HeqnEeqz:te.EquipPosition,IsMenu:te.menuAction,Adrnr:te.Adrnr,Adrnri:te.Adrnri,Fhmkz:te.Fhmkz,Funcid:te.Funcid,Frcfit:te.Frcfit,Frcrmv:te.Frcrmv};var b=this.getView().getModel("dataOrigin").getData();if(b&&b.length>0){K.Swerki=b[0].instLoc?"R":b[0].maintenance?"D":"";K.Storti=b[1].instLoc?"R":b[1].maintenance?"D":"";K.Beberi=b[2].instLoc?"R":b[2].maintenance?"D":"";K.Ppsidi=b[3].instLoc?"R":b[3].maintenance?"D":"";K.Abckzi=b[4].instLoc?"R":b[4].maintenance?"D":"";K.Kostli=b[5].instLoc?"R":b[5].maintenance?"D":"";K.Iwerki=b[6].instLoc?"R":b[6].maintenance?"D":"";K.Ingrpi=b[7].instLoc?"R":b[7].maintenance?"D":"";K.Gewrki=b[8].instLoc?"R":b[8].maintenance?"D":"";K.Adrnri=b[10].instLoc?"R":b[10].maintenance?"D":""}if(te.viewParameter==="create"){K.Type=true}S.Equipment.push(K);p=K;K.IsDOI=true;var H={Equi:te.Equnr,Title:te.TitleCode,Name1:te.Name1,Name2:te.Name2,Name3:te.Name3,Name4:te.Name4,Sort1:te.Sort1,Sort2:te.Sort2,NameCo:te.NameCo,PostCod1:te.PostCod1,City1:te.City1,Building:te.Building,Floor:te.Floor,Roomnum:te.Roomnum,Strsuppl1:te.Strsuppl1,Strsuppl2:te.Strsuppl2,Strsuppl3:te.Strsuppl3,Location:te.AddrLocation,RefPosta:te.RefPosta,Landx:te.Landx,TimeZone:te.TimeZone,RfePost:te.Region,Regiotxt:te.RegionDesc};S.EqAddr.push(H);c=H;var V=te.intlAddr;if(V.length>0){for(var L=0;L<V.length;L++){S.EqAddrI.push(V[L])}}f=V;if(te.Floccategory==="L"){var _={Equi:te.Equnr,Lrpid:te.lam.Lrpid,Strtptatr:te.lam.Strtptatr,Endptatr:te.lam.Endptatr,Length:te.lam.Length,LinUnit:te.lam.LinUnit,Startmrkr:te.lam.Startmrkr,Endmrkr:te.lam.Endmrkr,Mrkdisst:te.lam.Mrkdisst,Mrkdisend:te.lam.Mrkdisend,MrkrUnit:te.lam.MrkrUnit,LamDer:te.lam.LamDer};g=_;_.LamDer="D";S.FLLAM.push(_)}var Z={Equi:te.Equnr,PlanvPrt:te.PlanvPrt,SteufPrt:te.SteufPrt,KtschPrt:te.KtschPrt,Ewformprt:te.Ewformprt,SteufRef:te.SteufRef,KtschRef:te.KtschRef,EwformRef:te.EwformRef};S.EqPRT.push(Z);m=Z;if(te.dfps){var j={Equi:te.Equnr,DeviceId:te.dfps.Tailno,Topsiteid:te.dfps.Area,Topsitede:te.dfps.AreaDesc,AreaPro:te.dfps.AreaPrfl,SiteId:te.dfps.Site,SiteDesc:te.dfps.SiteDesc,SitePro:te.dfps.SitePrfl,MpoId:te.dfps.MPO,MpoDescr:te.dfps.MPODesc,RicId:te.dfps.RIC,RicDescr:te.dfps.RICDesc,ModelId:te.dfps.ModelId,ModelDes:te.dfps.ModelIdDesc,Foreignob:i.truetoX(te.dfps.ForeignEq),TecState:te.dfps.TechSts,DepState:te.dfps.OperSts,DfpsRmrk:te.dfps.Remark};S.EqDFPS.push(j)}var Q=te.classItems;if(Q){if(Q.length>0){for(var G=0;G<Q.length;G++){var J={Equi:te.Equnr,Classtype:Q[G].Classtype,Class:Q[G].Class,Clstatus1:Q[G].Clstatus1,Artxt:Q[G].ClassTypeDesc};S.EqClass.push(J)}}}var X=te.characteristics;if(X){if(X.length>0){for(var Y=0;Y<X.length;Y++){var ee={Equi:te.Equnr,Atnam:X[Y].Atnam,Textbez:X[Y].Textbez,Atwrt:X[Y].Atwrt,Class:X[Y].Class};S.EqVal.push(ee)}}}var B=te.characteristics;if(B){if(B.length>0){var W=$.map(B,function(e){return $.extend(true,{},e)});for(var R=0;R<W.length;R++){delete W[R].linCharEnable;W[R].Equi=v[U].Equnr;S.EqLAMCH.push(W[R])}}}var ae=s.getView().getModel("mainView");var ie=ae.getData();ie.tableBusy=true;ae.setData(ie);var re=function(n){s.BusyDialog.close();if(n.Equipment.results.length>0){d=[];for(var l=0;l<n.Equipment.results.length;l++){if(n.Equipment.results[l].Equnr===D){var o=n.Equipment.results[l];var u={intlAddr:[],classItems:[],characteristics:[],linearChar:[],charNewButton:false,attachmentCount:"0",Guids:"",EqunrEnabled:true,EquipCatEnabled:true,MaintplantEnabled:true,BukrsEnabled:true,EqunrVS:"None",EqunrVST:"",EqktxVS:"None",EqktxVST:"",EquipmentCatogoryVS:"None",EquipmentCatogoryVST:"",MaintplantVS:"None",MaintplantVST:"",TplnrVS:"None",TplnrVST:"",SuperordinateEquipVS:"None",SuperordinateEquipVST:"",StsmEquiVS:"None",StsmEquiVST:"",UstwEquiVS:"None",UstwEquiVST:"",UswoEquiVS:"None",UswoEquiVST:"",TechnicalObjectTypVS:"None",TechnicalObjectTypVST:"",LocationVS:"None",LocationVSTL:"",AbckzVS:"None",AbckzVST:"",ArbplVS:"None",ArbplVST:"",BukrsVS:"None",BukrsVST:"",KostlVS:"None",KostlVST:"",WerksVS:"None",WerksVST:"",IngrpVS:"None",IngrpVST:"",ConstrTypeVS:"None",ConstrTypeVST:"",RefPostaVS:"None",RefPostaVST:"",MainArbplVS:"None",MainArbplVST:"",LangucodeVS:"None",LangucodeVST:"",TimeZoneVS:"None",TimeZoneVST:"",ConstrTypeMaxL:0,charValueMaxL:0,dfps:{Tailno:"",TailnoVS:"None",Area:"",AreaDesc:"",AreaPrfl:"",Site:"",SiteDesc:"",SiteVS:"None",SitePrfl:"",MPO:"",MPODesc:"",RIC:"",RICDesc:"",ModelId:"",ModelIdDesc:"",ModelIdVS:"None",ForeignEq:false,TechSts:"",OperSts:"0001",Remark:"",dfpsCrtEnabled:true,dfpsDltEnabled:false,dfpsEnabled:false,TailnoReq:false}};u.Equnr=o.Equnr;u.Eqktx=o.Txtmi;u.EquipmentCatogory=o.Eqtyp;u.EquipCatgDescription=o.Etytx;u.Maintplant=o.Swerk;u.MaintplantDesc=o.Name1;u.SuperordinateEquip=o.HequEeqz;u.SuperordinateEquipDesc=o.SuperordEqDes;u.Bukrs=o.BukrEilo;u.Butxt=o.Butxt;u.Location=o.StorEilo;u.Locationdesc=o.Locationdesc;u.Abckz=o.AbckEilo;u.Abctx=o.Abctx;u.Kostl=o.KostEilo;u.Kokrs=o.KokrEilo;u.Mctxt=o.Contareaname;u.Answt=o.Answt;u.Ansdt=i.getDateFormat(o.Ansdt);u.Waers=o.Waers;u.Werks=o.PplaEeqz;u.Planningplantdes=o.Planningplantdes;u.Ingrp=o.IngrEeqz;u.Innam=o.Plannergrpdesc;u.Arbpl=o.ArbpEilo;u.Ktext=o.Workcenterdesc;u.WcWerks=o.WorkCenterPlant;u.MainArbpl=o.ArbpEeqz;u.MainKtext=o.MainWcDesc;u.MainWerks=o.MainWcPlant;u.BeberFl=o.BebeEilo;u.Fing=o.Fing;u.Tele=o.Tele;u.Herst=o.Herst;u.TechnicalObjectTyp=o.Eqart;u.Description=o.Eartx;u.Typbz=o.Typbz;u.ConstrType=o.SubmEeqz;u.ConstructionDesc=o.Constdesc;u.TechIdNum=o.TidnEeqz;u.Serge=o.Serge;u.MapaEeqz=o.MapaEeqz;u.EquipPosition=o.HeqnEeqz;u.Stattext=o.Stattext;u.StsmEqui=o.StsmEqui;u.StsmEquiDesc=o.Statproftxt;u.UstwEqui=o.UstwEqui;u.UswoEqui=o.UswoEqui;u.UstaEqui=o.UstaEqui;u.menuAction=o.IsMenu;u.Adrnr=o.Adrnr;u.Adrnri=o.Adrnri;u.Fhmkz=o.Fhmkz;u.Funcid=o.Funcid;u.Frcfit=o.Frcfit;u.Frcrmv=o.Frcrmv;if(u.Equnr===D){s.equiHeader=n.Equipment.results[l];u.Maintplant=p.Maintplant;u.MaintplantDesc=p.MaintplantDesc;u.Bukrs=p.Bukrs;u.Butxt=p.Butxt;u.Location=p.Location;u.Locationdesc=p.Locationdesc;u.Abckz=p.Abckz;u.Abctx=p.Abctx;u.Kostl=p.Kostl;u.Kokrs=p.Kokrs;u.Mctxt=p.Mctxt;u.Werks=p.Werks;u.Planningplantdes=p.Planningplantdes;u.Ingrp=p.Ingrp;u.Innam=p.Innam;u.MainArbpl=p.MainArbpl;u.MainKtext=p.MainKtext;u.MainWerks=p.MainWerks;u.BeberFl=p.BeberFl;u.Fing=p.Fing;u.Tele=p.Tele;u.Stattext=p.Stattext}if(n.EqPRT){var m=n.EqPRT.results[l];if(m){u.PlanvPrt=m.PlanvPrt;u.SteufPrt=m.SteufPrt;u.KtschPrt=m.KtschPrt;u.Ewformprt=m.Ewformprt;u.PlanvPrtText=m.Ewformprt!==undefined?m.Ewformprt:"";u.SteufPrtText=m.SteufPrtText!==undefined?m.SteufPrtText:"";u.KtschPrtText=m.KtschPrtText!==undefined?m.KtschPrtText:"";u.EwformprtText=m.EwformprtText!==undefined?m.EwformprtText:"";u.SteufRef=m.SteufRef;u.KtschRef=m.KtschRef;u.EwformRef=m.EwformRef}else{u.PlanvPrt="";u.SteufPrt="";u.KtschPrt="";u.Ewformprt="";u.PlanvPrtText="";u.SteufPrtText="";u.KtschPrtText="";u.EwformprtText="";u.SteufRef=false;u.KtschRef=false;u.EwformRef=false}}if(n.EqLAM.results.length>0){var S=n.EqLAM.results;for(var h=0;h<S.length;h++){if(S[h].Equi===o.Equnr){var E={Equi:S[h].Equi,Lrpid:S[h].Lrpid,LrpidDesc:S[h].LrpDescr,Strtptatr:S[h].Strtptatr,Endptatr:S[h].Endptatr,Length:S[h].Length,LinUnit:S[h].LinUnit,LinUnitDesc:S[h].Uomtext,Startmrkr:S[h].Startmrkr,Endmrkr:S[h].Endmrkr,Mrkdisst:S[h].Mrkdisst,Mrkdisend:S[h].Mrkdisend,MrkrUnit:S[h].MrkrUnit};u.lam=E;break}}}if(u.Equnr===D&&u.EquipmentCatogory==="L"&&s.lamSwitch==="X"){u.lam=g;if(n.EqLAM.results.length>0){s.equiLAM=n.EqLAM.results}}if(o.Type===true){u.viewParameter="create"}if(o.Type===false){u.viewParameter="change";u.EqunrEnabled=false;if(u.EquipmentCatogory===""||u.EquipmentCatogory===undefined){u.EquipCatEnabled=true}else{u.EquipCatEnabled=false}if(u.Maintplant===""||u.Maintplant===undefined){u.MaintplantEnabled=true}else{u.MaintplantEnabled=false}if(u.Tplnr===""||u.Tplnr===undefined){u.TplnrEnabled=true}else{u.TplnrEnabled=false}}if(o.Swerk!==""){u.BukrsEnabled=false}else{u.BukrsEnabled=true}if(o.Eqtyp!=="P"){u.Tplnr=o.TplnEilo;u.Pltxt=o.Flocdescription;u.TplnrEnabled=true}else{u.Tplnr="";u.Pltxt="";u.TplnrEnabled=false}if(u.SuperordinateEquip!==""&&u.SuperordinateEquip!==undefined){u.TplnrEnabled=false;u.SuperordinateEquipEnabled=true}if(u.Tplnr!==""&&u.Tplnr!==undefined){u.TplnrEnabled=true;u.SuperordinateEquipEnabled=false}if(u.SuperordinateEquip!==""&&u.SuperordinateEquip!==undefined||u.Tplnr!==""&&u.Tplnr!==undefined){u.MaintplantEnabled=false}else{u.MaintplantEnabled=true}if(u.Equnr===D){var M=sap.ui.getCore().getModel("equiAddressView");var v=M.getData();var C=true;var A,T;if(v.length>0){for(var q=0;q<v.length;q++){if(u.Equnr===v[q].Equnr){C=false;T=q;break}}}if(C===true){if(u.SuperordinateEquip!==""&&u.SuperordinateEquip!==undefined||u.Tplnr!==""&&u.Tplnr!==undefined){A={Equnr:u.Equnr,Tplnr:u.Tplnr,IsEditable:c.IsEditable};v.push(A);M.setData(v)}}if(C===false){if(u.SuperordinateEquip!==""&&u.SuperordinateEquip!==undefined||u.Tplnr!==""&&u.Tplnr!==undefined){v[T].Equnr=u.Equnr;v[T].Tplnr=u.Tplnr;v[T].IsEditable=u.IsEditable;M.setData(v)}}u.IsEditable=c.IsEditable;u.Title=c.Titletxt?c.Titletxt:"";u.TitleCode=c.Title?c.Title:"";u.Name1=c.Name1?c.Name1:"";u.Name2=c.Name2?c.Name2:"";u.Name3=c.Name3?c.Name3:"";u.Name4=c.Name4?c.Name4:"";u.Sort1=c.Sort1?c.Sort1:"";u.Sort2=c.Sort2?c.Sort2:"";u.NameCo=c.NameCo?c.NameCo:"";u.PostCod1=c.PostCod1?c.PostCod1:"";u.City1=c.City1?c.City1:"";u.Building=c.Building?c.Building:"";u.Floor=c.Floor?c.Floor:"";u.Roomnum=c.Roomnum?c.Roomnum:"";u.AddrLocation=c.Location?c.Location:"";u.Strsuppl1=c.Strsuppl1?c.Strsuppl1:"";u.Strsuppl2=c.Strsuppl2?c.Strsuppl2:"";u.Strsuppl3=c.Strsuppl3?c.Strsuppl3:"";u.RefPosta=c.RefPosta?c.RefPosta:"";u.Landx=c.Landx?c.Landx:"";u.TimeZone=c.TimeZone?c.TimeZone:"";u.Region=c.RfePost?c.RfePost:"";u.RegionDesc=c.Regiotxt?c.Regiotxt:"";if(n.EqAddr.results){s.equiAddr=n.EqAddr.results}}var b=n.EqAddrI.results;if(b.length>0){for(var P=0;P<b.length;P++){if(b[P].Equi===u.Equnr){b[P].AdNationEnable=false;b[P].City1iVS="None";b[P].StreetiVS="None";u.intlAddr.push(b[P])}}}if(u.Equnr===D&&u.intlAddr.length>0){s.equiIntlAddr=u.intlAddr;u.intlAddr=f}else{s.equiIntlAddr=[]}if(n.EqDFPS){if(n.EqDFPS.results){var V=n.EqDFPS.results;if(V){if(V.length>0){for(var L=0;L<V.length;L++){if(u.Equnr===V[L].Equi){u.dfps.Equnr=V[L].Equi;u.dfps.MeOwner=V[L].MeOwner;u.dfps.MeUser=V[L].MeUser;u.dfps.Tailno=V[L].DeviceId;u.dfps.Area=V[L].Topsiteid;u.dfps.AreaDesc=V[L].Topsitede;u.dfps.AreaPrfl=V[L].AreaPro;u.dfps.Site=V[L].SiteId;u.dfps.SiteDesc=V[L].SiteDesc;u.dfps.SitePrfl=V[L].SitePro;u.dfps.MPO=V[L].MpoId;u.dfps.MPODesc=V[L].MpoDescr;u.dfps.RIC=V[L].RicId;u.dfps.RICDesc=V[L].RicDescr;u.dfps.ModelId=V[L].ModelId;u.dfps.ModelIdDesc=V[L].ModelDes;u.dfps.ForeignEq=i.XtoTrue(V[L].Foreignob);u.dfps.TechSts=V[L].TecState;u.dfps.OperSts=V[L].DepState;u.dfps.Remark=V[L].DfpsRmrk;if(V[L].DeviceId!==""){u.dfps.dfpsCrtEnabled=false;u.dfps.dfpsDltEnabled=true;u.dfps.dfpsEnabled=true;u.dfps.TailnoReq=true}}}}}}}if(n.EqClass){var N=n.EqClass.results;if(N){if(N.length>0){for(var F=0;F<N.length;F++){if(u.Equnr===N[F].Equi){N[F].ctEnable=false;N[F].classEnable=false;N[F].ClassTypeDesc=N[F].Artxt;delete N[F].Artxt;delete N[F].Changerequestid;delete N[F].Clint;delete N[F].Service;u.classItems.push(N[F])}}u.charNewButton=true;if(s.class&&s.class.getId().includes("detailEqui")===true){s.class.setModel(new t(u.classItems))}}}}if(n.EqVal){var I=n.EqVal.results;if(I){if(I.length>0){for(var w=0;w<I.length;w++){if(u.Equnr===I[w].Equi){I[w].cNameEnable=false;I[w].Textbz=I[w].Atwtb;delete I[w].Ataut;delete I[w].Ataw1;delete I[w].Atawe;delete I[w].Atcod;delete I[w].Atflb;delete I[w].Atflv;delete I[w].Atimb;delete I[w].Atsrt;delete I[w].Atvglart;delete I[w].Atzis;delete I[w].Changerequestid;delete I[w].CharName;delete I[w].Charid;delete I[w].Classtype;delete I[w].Service;delete I[w].Valcnt;I[w].slNo=w+1;I[w].flag=I[w].Class+"-"+I[w].slNo;u.characteristics.push(I[w])}}if(s.char&&s.char.getId().includes("detailEqui")===true){s.char.setModel(new t(u.characteristics))}}}}if(n.EqLAMCH){var x=n.EqLAMCH.results;if(x){if(x.length>0){for(var k=0;k<x.length;k++){if(u.Equnr===x[k].Equi){x[k].linCharEnable=true;u.linearChar.push(x[k])}}}}}if(u.UstaEqui){ie.visible=true}else{ie.visible=false}ae.setData(ie);s.getView().getModel(s.oModelName).setData(u);var y=new t;var R=u;R.Title=R.Title?R.Title:"";R.TitleCode=R.TitleCode?R.TitleCode:"";R.Name1=R.Name1?R.Name1:"";R.Name2=R.Name2?R.Name2:"";R.Name3=R.Name3?R.Name3:"";R.Name4=R.Name4?R.Name4:"";R.Sort1=R.Sort1?R.Sort1:"";R.Sort2=R.Sort2?R.Sort2:"";R.NameCo=R.NameCo?R.NameCo:"";R.PostCod1=R.PostCod1?R.PostCod1:"";R.City1=R.City1?R.City1:"";R.Building=R.Building?R.Building:"";R.Floor=R.Floor?R.Floor:"";R.Roomnum=R.Roomnum?R.Roomnum:"";R.Strsuppl1=R.Strsuppl1?R.Strsuppl1:"";R.Strsuppl2=R.Strsuppl2?R.Strsuppl2:"";R.Strsuppl3=R.Strsuppl3?R.Strsuppl3:"";R.AddrLocation=R.AddrLocation?R.AddrLocation:"";R.RefPosta=R.RefPosta?R.RefPosta:"";R.Landx=R.Landx?R.Landx:"";R.TimeZone=R.TimeZone?R.TimeZone:"";R.Region=R.Region?R.Region:"";R.RegionDesc=R.RegionDesc?R.RegionDesc:"";if(R.Title!==""&&R.Title!==undefined||R.TitleCode!==""&&R.TitleCode!==undefined||R.Name1!==""&&R.Name1!==undefined||R.Name2!==""&&R.Name2!==undefined||R.Name3!==""&&R.Name3!==undefined||R.Name4!==""&&R.Name4!==undefined||R.Sort1!==""&&R.Sort1!==undefined||R.Sort2!==""&&R.Sort2!==undefined||R.NameCo!==""&&R.NameCo!==undefined||R.PostCod1!==""&&R.PostCod1!==undefined||R.City1!==""&&R.City1!==undefined||R.Building!==""&&R.Building!==undefined||R.Floor!==""&&R.Floor!==undefined||R.Roomnum!==""&&R.Roomnum!==undefined||R.AddrLocation!==""&&R.AddrLocation!==undefined||R.Strsuppl1!==""&&R.Strsuppl1!==undefined||R.Strsuppl2!==""&&R.Strsuppl2!==undefined||R.Strsuppl3!==""&&R.Strsuppl3!==undefined||R.TimeZone!==""&&R.TimeZone!==undefined||R.RefPosta!==""&&R.RefPosta!==undefined||R.Region!==""&&R.Region!==undefined){R.RefPostaLblReq=true;var O=s.getView().getModel("equiAddressView");var B=O.getData();B.enabled=R.IsEditable;O.setData(B)}y.setData(R);s.getView().setModel(y,s.oModelName);s.lam.setModel(y,"AIWLAM");var W=[y.getData()];var U=$.map(W,function(e){return $.extend(true,{},e)});var K=new t;K.setData(U);s.getView().setModel(K,"SUP_EQUI_DATA");var z=sap.ui.getCore().getModel("SUP_EQUI_DATA");var H=z.getData();var Z=true;for(var _=0;_<H.length;_++){if(R.Equnr===H[_].Equnr){Z=false}}if(Z===true){if(R.SuperordinateEquip!==""&&R.SuperordinateEquip!==undefined||R.Tplnr!==""&&R.Tplnr!==undefined){H.push(U[0]);z.setData(H)}}}}}ie.tableBusy=false;ae.setData(ie);if(e!==""&&a==="EQ"){s.superiorEquipment=e;s.superiorEqDesc=r}else if(e!==""&&a==="FL"){s.functionalLocation=e;s.functionalLocDesc=r}s.getView().getModel("dataOrigin").setProperty("/originDerive",n);s.openDoiView(undefined,n)};var ne=function(e){s.BusyDialog.close();var t=[];if(JSON.parse(e.responseText).error.innererror.errordetails===undefined||JSON.parse(e.responseText).error.innererror.errordetails.length===0){t[0]=JSON.parse(e.responseText).error.message.value}else{for(var a=0;a<JSON.parse(e.responseText).error.innererror.errordetails.length;a++){t[a]=JSON.parse(e.responseText).error.innererror.errordetails[a].message}}var i=t.join("\n");ie.tableBusy=false;ae.setData(ie);s.invokeMessage(i)};if(S.FLAddrI.length>0){S.FLAddrI=$.map(S.FLAddrI,function(e){return $.extend(true,{},e)});for(var se=0;se<S.FLAddrI.length>0;se++){delete S.FLAddrI[se].AdNationEnable;delete S.FLAddrI[se].City1iVS;delete S.FLAddrI[se].StreetiVS}}if(S.EqAddrI.length>0){S.EqAddrI=$.map(S.EqAddrI,function(e){return $.extend(true,{},e)});for(var se=0;se<S.EqAddrI.length>0;se++){delete S.EqAddrI[se].AdNationEnable;delete S.EqAddrI[se].City1iVS;delete S.EqAddrI[se].StreetiVS}}s.BusyDialog.open();o.create(l,S,{success:re,error:ne})},onDOIDisplayPress:function(){this.doiDisplayFlag=true;var e=this.getView().getModel(this.oModelName).getData();if(!this.doiView){this.doiView=sap.ui.xmlfragment("ugieamui.mdg.eam.lib.doi.DataOrigin",this)}var a=new sap.ui.model.json.JSONModel,i;var r=this.superiorEquipment,n=this.superiorEqDesc,s=this.functionalLocation,l=this.functionalLocDesc;var o={},d,u;o.install=true;o.dismantle=false;o.parent=r===""?s:r;o.parentDesc=n===""?l:n;o.currentObj=e.Equnr;o.currObjDesc=e.Eqktx;i=this.getView().getModel("i18n").getProperty("doi");this.doiView.getAggregation("beginButton").setText("OK").setEnabled(true);this.doiView.setTitle(i);this.doiView.getContent()[1].getColumns()[5].getAggregation("header").setText(this.getView().getModel("i18n").getProperty("indMaintEQ"));if(r!==""){u=this.getView().getModel("i18n").getProperty("instlFieldEqText");d=this.getView().getModel("i18n").getProperty("instlHdrEqText");this.doiView.getContent()[0].getContent()[0].setText(u);this.doiView.getContent()[1].getColumns()[1].getAggregation("header").setText(d)}else if(s!==""){u=this.getView().getModel("i18n").getProperty("instlFieldFlText");d=this.getView().getModel("i18n").getProperty("instlHdrFlText");this.doiView.getContent()[0].getContent()[0].setText(u);this.doiView.getContent()[1].getColumns()[1].getAggregation("header").setText(d)}a.setData(o);this.getView().setModel(a,"doi");this.doiView.setModel(a,"doi");var p=this.doiView.getContent()[1];var g=this.getView().getModel("dataOrigin").getData();var c=this.getView().getModel("dataOrigin").getData();var f=$.map(c,function(e){return $.extend(true,{},e)});p.getColumns()[3].getAggregation("header").setEnabled(false);p.getColumns()[5].getAggregation("header").setEnabled(false);f.forEach(function(e){e.locEnable=false;e.maintEnable=false});if(p.getModel()){p.getModel().setData(f)}else{var m=new t(f);p.setModel(m)}var S=sap.ui.getCore().byId("idColItems");p.bindItems("/",S);this.doiView.open()},openDoiView:function(e,a){var i=this.getView().getModel(this.oModelName).getData();if(!this.doiView){this.doiView=sap.ui.xmlfragment("ugieamui.mdg.eam.lib.doi.DataOrigin",this)}var r=new sap.ui.model.json.JSONModel,n;var s=this.superiorEquipment,l=this.superiorEqDesc,o=this.functionalLocation,d=this.functionalLocDesc;var u={},p,g;if(e===""){u.install=false;u.dismantle=true;u.parent=s===""?o:s;u.parentDesc=l===""?d:l;u.currentObj=i.Equnr;u.currObjDesc=i.Eqktx;this.doiView.getAggregation("beginButton").setText("Dismantle").setEnabled(true);n=this.getView().getModel("i18n").getProperty("doiDismantle");this.doiView.setTitle(n)}else{u.install=true;u.dismantle=false;u.parent=s===""?o:s;u.parentDesc=l===""?d:l;u.currentObj=i.Equnr;u.currObjDesc=i.Eqktx;n=this.getView().getModel("i18n").getProperty("doi");this.doiView.getAggregation("beginButton").setText("Install").setEnabled(true);this.doiView.setTitle(n);this.doiView.getContent()[1].getColumns()[5].getAggregation("header").setText(this.getView().getModel("i18n").getProperty("indMaintEQ"))}if(s!==""){g=this.getView().getModel("i18n").getProperty("instlFieldEqText");p=this.getView().getModel("i18n").getProperty("instlHdrEqText");this.doiView.getContent()[0].getContent()[0].setText(g);this.doiView.getContent()[1].getColumns()[1].getAggregation("header").setText(p);var c=this.getView().getModel("i18n").getProperty("doiEQCurrVal");var f=this.getView().getModel("i18n").getProperty("doiEQTarVal");this.doiView.mAggregations.content[1].mAggregations.columns[6].mAggregations.header.setText(c);this.doiView.mAggregations.content[1].mAggregations.columns[7].mAggregations.header.setText(f)}else if(o!==""){g=this.getView().getModel("i18n").getProperty("instlFieldFlText");p=this.getView().getModel("i18n").getProperty("instlHdrFlText");this.doiView.getContent()[0].getContent()[0].setText(g);this.doiView.getContent()[1].getColumns()[1].getAggregation("header").setText(p);var m=this.getView().getModel("i18n").getProperty("doiFlCurrVal");var S=this.getView().getModel("i18n").getProperty("doiFlTarVal");this.doiView.mAggregations.content[1].mAggregations.columns[6].mAggregations.header.setText(m);this.doiView.mAggregations.content[1].mAggregations.columns[7].mAggregations.header.setText(S)}r.setData(u);this.getView().setModel(r,"doi");this.doiView.setModel(r,"doi");if(i.SuperordinateEquip===""){i.SuperordinateEquipDesc=""}else if(i.Tplnr===""){i.Pltxt=""}var h=this.doiView.getContent()[1];var E=this.getView().getModel("dataOrigin").getData();if(a){var M=a.Equi_DOI.results;for(var D=0;D<M.length;D++){M[D].instLoc=true;if(M[D].hasOwnProperty("maintenance")){if(!M[D].maintenance){M[D].targetVal=M[D].SupFlVal}}else{M[D].maintenance=E[D].maintenance;if(M[D].maintenance){M[D].instLoc=false}else{M[D].instLoc=true}M[D].currentVal=E[D].currentVal}if(M[D].Property==="Maintplant"||M[D].Property==="PplaEeqz"){M[D].locEnable=false;M[D].maintEnable=false}else{M[D].locEnable=true;M[D].maintEnable=true}M[D].targetVal=M[D].SupFlVal}if(i.Title!==""&&i.Title!==undefined||i.TitleCode!==""&&i.TitleCode!==undefined||i.Name1!==""&&i.Name1!==undefined||i.Name2!==""&&i.Name2!==undefined||i.Name3!==""&&i.Name3!==undefined||i.Name4!==""&&i.Name4!==undefined||i.Sort1!==""&&i.Sort1!==undefined||i.Sort2!==""&&i.Sort2!==undefined||i.NameCo!==""&&i.NameCo!==undefined||i.PostCod1!==""&&i.PostCod1!==undefined||i.City1!==""&&i.City1!==undefined||i.Building!==""&&i.Building!==undefined||i.Floor!==""&&i.Floor!==undefined||i.Roomnum!==""&&i.Roomnum!==undefined||i.AddrLocation!==""&&i.AddrLocation!==undefined||i.Strsuppl1!==""&&i.Strsuppl1!==undefined||i.Strsuppl2!==""&&i.Strsuppl2!==undefined||i.Strsuppl3!==""&&i.Strsuppl3!==undefined||i.TimeZone!==""&&i.TimeZone!==undefined||i.RefPosta!==""&&i.RefPosta!==undefined||i.Region!==""&&i.Region!==undefined){M[10].maintenance=true;M[10].instLoc=false;M[10].targetVal=i.Equnr;M[10].currentVal=i.Eqktx}h.setModel(new sap.ui.model.json.JSONModel(M))}else{var v=this.getView().getModel("dataOrigin").getData();var C=$.map(v,function(e){return $.extend(true,{},e)});h.setModel(new t(C));var A=h.getModel().getData();h.getColumns()[3].getAggregation("header").setSelected(false);A.forEach(function(e){e.instLoc=false});var T=$.map(A,function(e){return $.extend(true,{},e)});T.splice(6,1);T.splice(0,1);T.forEach(function(e){e.instLoc=false});h.getModel().setData(T)}h.getColumns()[3].getAggregation("header").setEnabled(true);h.getColumns()[5].getAggregation("header").setEnabled(true);var q=sap.ui.getCore().byId("idColItems");h.bindItems("/",q);this.doiView.open();this.getView().getModel("dataOrigin").refresh()},onObjectItemSelect:function(e){var t=e.getSource();var a=e.getSource().getSelected();var i=t.getBindingContext().getObject();var r=e.getSource().getParent().getParent().getParent().getBeginButton().getText();var n=t.getId();if(n.indexOf("eq")>-1){i.instLoc=false;i.targetVal=""}else if(n.indexOf("il")>-1){if(a){if(r==="Dismantle"){i.maintenance=false;i.finalDismantle=i.SupFlVal}else{i.maintenance=false;i.targetVal=i.SupFlVal}}else{if(r==="Dismantle"){i.maintenance=false;i.finalDismantle=""}}}},onDOIActionPress:function(e){var a=this;if(this.doiDisplayFlag){e.getSource().getParent().close();this.doiDisplayFlag=false;return}if(a.viewName==="ChangeEqui"){a.onDOIActionPressChange(e);return}var i=e.getSource().getText();var r=sap.ui.getCore().getModel("AIWEQUI");var n=r.getData();var s=a.getView().getModel(a.oModelName);var l=s.getData();var o=a.getView().getModel(a.oModelName).getData().Equnr;var d=e.getSource().getParent().getContent()[1].getModel().getData();var u={};var p="";for(var g=0;g<n.length;g++){if(n[g].Equnr===o){u=n[g];p=g}}if(i==="Install"){this.isInstall=true;var c=a.equiHeader;if(!d[1].maintenance){u.Location=c.StorEilo;u.Locationdesc=c.Locationdesc}if(!d[2].maintenance){u.BeberFl=c.BebeEilo;u.Fing=c.Fing;u.Tele=c.Tele}if(!d[3].maintenance){u.Arbpl=c.ArbpEilo;u.Ktext=c.Workcenterdesc}if(!d[4].maintenance){u.Abctx=c.Abctx;u.Abckz=c.AbckEilo}if(!d[5].maintenance){u.Kostl=c.KostEilo;u.Mctxt=c.Contareaname}if(!d[7].maintenance){u.Ingrp=c.IngrEeqz;u.Innam=c.Plannergrpdesc}if(!d[8].maintenance){u.MainArbpl=c.ArbpEeqz;u.MainKtext=c.MainWcDesc;u.MainWerks=c.MainWcPlant}if(d[0].instLoc&&c.Swerk!==""){u.Maintplant=c.Swerk;u.MaintplantDesc=c.Name1;u.MaintplantEnabled=false;u.Bukrs=c.BukrEilo;u.Butxt=c.Butxt;u.BukrsEnabled=false;u.Werks=c.PplaEeqz;u.Planningplantdes=c.Planningplantdes;u.Kokrs=c.KokrEilo}u.MaintplantEnabled=true;u.Stattext=c.Stattext;u.Tplnr=c.TplnEilo;u.Pltxt=c.Flocdescription;if(d.length<11){var f=this.getView().getModel("dataOrigin").getData();d.splice(0,0,f[0]);d.splice(6,0,f[6]);this.getView().getModel("dataOrigin").setData(d)}if(!d[10].maintenance){var m=a.equiAddr;if(m){if(m.length>0){for(var S=0;S<m.length;S++){if(u.Equnr===m[S].Equi){var h=sap.ui.getCore().getModel("equiAddressView");var E=h.getData();var M=true;var D,v;if(E.length>0){for(var C=0;C<E.length;C++){if(u.Equnr===E[C].Equnr){M=false;v=C;break}}}if(M===true){if(u.SuperordinateEquip!==""&&u.SuperordinateEquip!==undefined||u.Tplnr!==""&&u.Tplnr!==undefined){D={Equnr:u.Equnr,Tplnr:u.Tplnr,IsEditable:m[S].IsEditable};E.push(D);h.setData(E)}}if(M===false){if(u.SuperordinateEquip!==""&&u.SuperordinateEquip!==undefined||u.Tplnr!==""&&u.Tplnr!==undefined){E[v].Equnr=u.Equnr;E[v].Tplnr=u.Tplnr;E[v].IsEditable=u.IsEditable;h.setData(E)}}u.IsEditable=m[S].IsEditable;u.Title=m[S].Titletxt?m[S].Titletxt:"";u.TitleCode=m[S].Title?m[S].Title:"";u.Name1=m[S].Name1?m[S].Name1:"";u.Name2=m[S].Name2?m[S].Name2:"";u.Name3=m[S].Name3?m[S].Name3:"";u.Name4=m[S].Name4?m[S].Name4:"";u.Sort1=m[S].Sort1?m[S].Sort1:"";u.Sort2=m[S].Sort2?m[S].Sort2:"";u.NameCo=m[S].NameCo?m[S].NameCo:"";u.PostCod1=m[S].PostCod1?m[S].PostCod1:"";u.City1=m[S].City1?m[S].City1:"";u.Building=m[S].Building?m[S].Building:"";u.Floor=m[S].Floor?m[S].Floor:"";u.Roomnum=m[S].Roomnum?m[S].Roomnum:"";u.AddrLocation=m[S].Location?m[S].Location:"";u.Strsuppl1=m[S].Strsuppl1?m[S].Strsuppl1:"";u.Strsuppl2=m[S].Strsuppl2?m[S].Strsuppl2:"";u.Strsuppl3=m[S].Strsuppl3?m[S].Strsuppl3:"";u.RefPosta=m[S].RefPosta?m[S].RefPosta:"";u.Landx=m[S].Landx?m[S].Landx:"";u.TimeZone=m[S].TimeZone?m[S].TimeZone:"";u.Region=m[S].RfePost?m[S].RfePost:"";u.RegionDesc=m[S].Regiotxt?m[S].Regiotxt:""}}}else{u.Title=u.Title?u.Title:"";u.TitleCode=u.TitleCode?u.TitleCode:"";u.Name1=u.Name1?u.Name1:"";u.Name2=u.Name2?u.Name2:"";u.Name3=u.Name3?u.Name3:"";u.Name4=u.Name4?u.Name4:"";u.Sort1=u.Sort1?u.Sort1:"";u.Sort2=u.Sort2?u.Sort2:"";u.NameCo=u.NameCo?u.NameCo:"";u.PostCod1=u.PostCod1?u.PostCod1:"";u.City1=u.City1?u.City1:"";u.Building=u.Building?u.Building:"";u.Floor=u.Floor?u.Floor:"";u.Roomnum=u.Roomnum?u.Roomnum:"";u.Strsuppl1=u.Strsuppl1?u.Strsuppl1:"";u.Strsuppl2=u.Strsuppl2?u.Strsuppl2:"";u.Strsuppl3=u.Strsuppl3?u.Strsuppl3:"";u.AddrLocation=u.AddrLocation?u.AddrLocation:"";u.RefPosta=u.RefPosta?u.RefPosta:"";u.Landx=u.Landx?u.Landx:"";u.TimeZone=u.TimeZone?u.TimeZone:"";u.Region=u.Region?u.Region:"";u.RegionDesc=u.RegionDesc?u.RegionDesc:""}u.intlAddr=a.equiIntlAddr}}var A=a.equiLAM;if(A){for(var T=0;T<A.length;T++){if(A[T].Equi===u.Equnr){if(u.Equnr===o&&u.EquipmentCatogory==="L"&&a.lamSwitch==="X"){var q=T;var b="Superior object has been changed. Do you want to copy linear data from superior object?";sap.m.MessageBox.confirm(b,{title:"Confirmation",onClose:function(e){if(e==="OK"){var t={Equi:A[q].Equi,Lrpid:A[q].Lrpid,LrpidDesc:A[q].LrpDescr,Strtptatr:A[q].Strtptatr,Endptatr:A[q].Endptatr,Length:A[q].Length,LinUnit:A[q].LinUnit,LinUnitDesc:A[q].Uomtext,Startmrkr:A[q].Startmrkr,Endmrkr:A[q].Endmrkr,Mrkdisst:A[q].Mrkdisst,Mrkdisend:A[q].Mrkdisend,MrkrUnit:A[q].MrkrUnit,LamDer:A[q].LamDer};var i=a.getView().getModel(a.oModelName);var s=i.getData();s.lam=t;i.setData(s);a.lam.setModel(i,"AIWLAM");n[p].lam=t;r.setData(n)}}});break}}}}n[p]=u;r.setData(n)}else{this.isInstall=false;this.superiorEquipment="";this.superiorEqDesc="";this.functionalLocation="";this.functionalLocDesc="";var P=this.getView().byId("idLocation").getName();var V=this.getView().byId("idAbcInd").getName();var L=this.getView().byId("idPlntSec").getName();var N=this.getView().byId("idWorkCen").getName();var F=this.getView().byId("idCostCtr").getName();var I=this.getView().byId("idPlnGrp").getName();var w=this.getView().byId("idMainWC").getName();for(var x=0;x<d.length;x++){if(d[x].Property===P&&!d[x].instLoc){u.Location="";u.Locationdesc=""}else if(d[x].Property===V&&!d[x].instLoc){u.Abckz="";u.Abctx=""}else if(d[x].Property===L&&!d[x].instLoc){u.BeberFl="";u.Fing="";u.Tele=""}else if(d[x].Property===N&&!d[x].instLoc){u.Arbpl="";u.Ktext="";u.WcWerks=""}else if(d[x].Property===F&&!d[x].instLoc){u.Kostl="";u.Kokrs=""}else if(d[x].Property===I&&!d[x].instLoc){u.Ingrp="";u.Innam=""}else if(d[x].Property===w&&!d[x].instLoc){u.MainArbpl="";u.MainWerks="";u.MainKtext=""}else if(d[x].Property==="Adrnr"){if(a.getView().getModel("SUP_EQUI_DATA")){var k=sap.ui.getCore().getModel("SUP_EQUI_DATA");var y=k.getData();var R;for(var O=0;O<y.length;O++){if(e.getSource().getModel(a.oModelName).getData().Equnr===y[O].Equnr){R=O;break}}var B=a.getView().getModel(a.oModelName);var l=B.getData();var W=a.getView().getModel("SUP_EQUI_DATA").getData()[0];if(W){l.Tplnr=l.Tplnr===W.Tplnr?"":l.Tplnr;l.Pltxt=l.Pltxt===W.Pltxt?"":l.Pltxt;l.BeberFl=l.BeberFl===W.BeberFl?"":l.BeberFl;l.Fing=l.Fing===W.Fing?"":l.Fing;l.Tele=l.Tele===W.Tele?"":l.Tele;l.Location=l.Location===W.Location?"":l.Location;l.Locationdesc=l.Locationdesc===W.Locationdesc?"":l.Locationdesc;l.Arbpl=l.Arbpl===W.Arbpl?"":l.Arbpl;l.Ktext=l.Ktext===W.Ktext?"":l.Ktext;l.WcWerks=l.WcWerks===W.WcWerks?"":l.WcWerks;l.Abckz=l.Abckz===W.Abckz?"":l.Abckz;l.Abctx=l.Abctx===W.Abctx?"":l.Abctx;l.MainArbpl=l.MainArbpl===W.MainArbpl?"":l.MainArbpl;l.MainKtext=l.MainKtext===W.MainKtext?"":l.MainKtext;l.MainWerks=l.MainWerks===W.MainWerks?"":l.MainWerks;l.Kostl=l.Kostl===W.Kostl?"":l.Kostl;l.Mctxt=l.Mctxt===W.Mctxt?"":l.Mctxt;l.Ingrp=l.Ingrp===W.Ingrp?"":l.Ingrp;l.Innam=l.Innam===W.Innam?"":l.Innam;if(l.Maintplant!==""){l.TplnrEnabled=true;l.MaintplantEnabled=true;l.BukrsEnabled=false;l.Bukrs=l.Bukrs;l.Butxt=l.Butxt;l.Kokrs=l.Kokrs;l.Werks=l.Werks;l.Planningplantdes=l.Planningplantdes}else{l.BukrsEnabled=true;l.Bukrs=l.Bukrs===W.Bukrs?"":l.Bukrs;l.Butxt=l.Butxt===W.Butxt?"":l.Butxt;l.Kokrs=l.Kokrs===W.Kokrs?"":l.Kokrs;l.Werks=l.Werks===W.Werks?"":l.Werks;l.Planningplantdes=l.Planningplantdes===W.Planningplantdes?"":l.Planningplantdes}l.Title="";l.TitleCode="";l.Name1="";l.Name2="";l.Name3="";l.Name4="";l.Sort1="";l.Sort2="";l.NameCo="";l.PostCod1="";l.City1="";l.Building="";l.Floor="";l.Roomnum="";l.Strsuppl1="";l.Strsuppl2="";l.Strsuppl3="";l.AddrLocation="";l.RefPosta="";l.Landx="";l.TimeZone="";l.Region="";l.RegionDesc="";l.RefPostaLblReq=false;var U=sap.ui.getCore().getModel("equiAddressView");var K=U.getData();for(var z=0;z<K.length;z++){if(e.getSource().getModel(a.oModelName).getData().Equnr===K[z].Equnr){K.splice(z,1);U.setData(K);break}}var H=a.getView().getModel("equiAddressView");var Z=H.getData();Z.enabled=true;H.setData(Z);y.splice(R,1);k.setData(y)}}u.intlAddr=[]}}if(d[8].Property==="Adrnr"&&d[8].instLoc===true){var H=a.getView().getModel("equiAddressView");var Z=H.getData();Z.enabled=true;H.setData(Z);sap.ui.getCore().getModel("equiAddressView").getData().forEach(function(e){if(e.Equnr===u.Equnr){e.IsEditable=true}})}u.MaintplantEnabled=true;u.Tplnr="";u.Pltxt="";u.TplnrEnabled=true;u.SuperordinateEquipEnabled=true;n[p]=u;r.setData(n);this.readSystemStatus(a)}if(d.length<11){var f=this.getView().getModel("dataOrigin").getData();d.splice(0,0,f[0]);d.splice(6,0,f[6]);this.getView().getModel("dataOrigin").setData(d)}this.getView().getModel("dataOrigin").setData(d);for(var _=0;_<sap.ui.getCore().getModel("dataOriginMOP").getData().EQ.length;_++){if(sap.ui.getCore().getModel("dataOriginMOP").getData().EQ[_].key===o){sap.ui.getCore().getModel("dataOriginMOP").getData().EQ[_].DOI=d}}for(var j=0;j<r.getData().length;j++){if(o===r.getData()[j].Equnr){a.rowIndex="/"+j;var Q=new t;var G=r.getProperty(a.rowIndex);G.Title=G.Title?G.Title:"";G.TitleCode=G.TitleCode?G.TitleCode:"";G.Name1=G.Name1?G.Name1:"";G.Name2=G.Name2?G.Name2:"";G.Name3=G.Name3?G.Name3:"";G.Name4=G.Name4?G.Name4:"";G.Sort1=G.Sort1?G.Sort1:"";G.Sort2=G.Sort2?G.Sort2:"";G.NameCo=G.NameCo?G.NameCo:"";G.PostCod1=G.PostCod1?G.PostCod1:"";G.City1=G.City1?G.City1:"";G.Building=G.Building?G.Building:"";G.Floor=G.Floor?G.Floor:"";G.Roomnum=G.Roomnum?G.Roomnum:"";G.Strsuppl1=G.Strsuppl1?G.Strsuppl1:"";G.Strsuppl2=G.Strsuppl2?G.Strsuppl2:"";G.Strsuppl3=G.Strsuppl3?G.Strsuppl3:"";G.AddrLocation=G.AddrLocation?G.AddrLocation:"";G.RefPosta=G.RefPosta?G.RefPosta:"";G.Landx=G.Landx?G.Landx:"";G.TimeZone=G.TimeZone?G.TimeZone:"";G.Region=G.Region?G.Region:"";G.RegionDesc=G.RegionDesc?G.RegionDesc:"";if(G.Title!==""&&G.Title!==undefined||G.TitleCode!==""&&G.TitleCode!==undefined||G.Name1!==""&&G.Name1!==undefined||G.Name2!==""&&G.Name2!==undefined||G.Name3!==""&&G.Name3!==undefined||G.Name4!==""&&G.Name4!==undefined||G.Sort1!==""&&G.Sort1!==undefined||G.Sort2!==""&&G.Sort2!==undefined||G.NameCo!==""&&G.NameCo!==undefined||G.PostCod1!==""&&G.PostCod1!==undefined||G.City1!==""&&G.City1!==undefined||G.Building!==""&&G.Building!==undefined||G.Floor!==""&&G.Floor!==undefined||G.Roomnum!==""&&G.Roomnum!==undefined||G.AddrLocation!==""&&G.AddrLocation!==undefined||G.Strsuppl1!==""&&G.Strsuppl1!==undefined||G.Strsuppl2!==""&&G.Strsuppl2!==undefined||G.Strsuppl3!==""&&G.Strsuppl3!==undefined||G.TimeZone!==""&&G.TimeZone!==undefined||G.RefPosta!==""&&G.RefPosta!==undefined||G.Region!==""&&G.Region!==undefined){G.RefPostaLblReq=true;var H=a.getView().getModel("equiAddressView");var Z=H.getData();Z.enabled=G.IsEditable;if(i!=="Install"&&d[10].Property==="Adrnr"&&d[10].instLoc===true){Z.enabled=true}H.setData(Z)}Q.setData(G);a.getView().setModel(Q,a.oModelName);a.getView().getModel(a.oModelName).refresh();a.lam.setModel(Q,"AIWLAM");var J=[Q.getData()];var W=$.map(J,function(e){return $.extend(true,{},e)});var X=new t;X.setData(W);a.getView().setModel(X,"SUP_EQUI_DATA");var k=sap.ui.getCore().getModel("SUP_EQUI_DATA");var y=k.getData();var Y=true;for(var ee=0;ee<y.length;ee++){if(G.Equnr===y[ee].Equnr){Y=false}}if(Y===true){if(G.SuperordinateEquip!==""&&G.SuperordinateEquip!==undefined||G.Tplnr!==""&&G.Tplnr!==undefined){y.push(W[0]);k.setData(y)}}break}}e.getSource().getParent().close();if(this.doiDisplayFlag){this.doiDisplayFlag=false}},onDOIActionPressChange:function(e){var t=this;var a=e.getSource().getText();var i=t.getView().getModel(t.oModelName);var r=i.getData();var n=t.getView().getModel(t.oModelName).getData().Equnr;var s=e.getSource().getParent().getContent()[1].getModel().getData();var l=r;if(a==="Install"){this.isInstall=true;var o=t.equiHeader;if(!s[1].maintenance){l.Location=o.StorEilo;l.Locationdesc=o.Locationdesc}if(!s[2].maintenance){l.BeberFl=o.BebeEilo;l.Fing=o.Fing;l.Tele=o.Tele}if(!s[4].maintenance){l.Abctx=o.Abctx;l.Abckz=o.AbckEilo}if(!s[5].maintenance){l.Kostl=o.KostEilo;l.Mctxt=o.Contareaname}if(!s[7].maintenance){l.Ingrp=o.IngrEeqz;l.Innam=o.Plannergrpdesc}if(!s[8].maintenance){l.MainArbpl=o.ArbpEeqz;l.MainKtext=o.MainWcDesc;l.MainWerks=o.MainWcPlant}if(s[0].instLoc&&o.Swerk!==""){l.Maintplant=o.Swerk;l.MaintplantDesc=o.Name1;l.MaintplantEnabled=false;l.Bukrs=o.BukrEilo;l.Butxt=o.Butxt;l.BukrsEnabled=false;l.Werks=o.PplaEeqz;l.Planningplantdes=o.Planningplantdes;l.Kokrs=o.KokrEilo}l.MaintplantEnabled=true;l.Stattext=o.Stattext;l.Tplnr=o.TplnEilo;l.Pltxt=o.Flocdescription;if(s.length<11){var d=this.getView().getModel("dataOrigin").getData();s.splice(0,0,d[0]);s.splice(6,0,d[6]);this.getView().getModel("dataOrigin").setData(s)}if(!s[10].maintenance){var u=t.equiAddr;if(u){if(u.length>0){for(var p=0;p<u.length;p++){if(l.Equnr===u[p].Equi){var g=sap.ui.getCore().getModel("equiAddressView");var c=g.getData();var f=true;var m,S;if(c.length>0){for(var h=0;h<c.length;h++){if(l.Equnr===c[h].Equnr){f=false;S=h;break}}}if(f===true){if(l.SuperordinateEquip!==""&&l.SuperordinateEquip!==undefined||l.Tplnr!==""&&l.Tplnr!==undefined){m={Equnr:l.Equnr,Tplnr:l.Tplnr,IsEditable:u[p].IsEditable};c.push(m);g.setData(c)}}if(f===false){if(l.SuperordinateEquip!==""&&l.SuperordinateEquip!==undefined||l.Tplnr!==""&&l.Tplnr!==undefined){c[S].Equnr=l.Equnr;c[S].Tplnr=l.Tplnr;c[S].IsEditable=l.IsEditable;g.setData(c)}}l.IsEditable=u[p].IsEditable;l.Title=u[p].Titletxt?u[p].Titletxt:"";l.TitleCode=u[p].Title?u[p].Title:"";l.Name1=u[p].Name1?u[p].Name1:"";l.Name2=u[p].Name2?u[p].Name2:"";l.Name3=u[p].Name3?u[p].Name3:"";l.Name4=u[p].Name4?u[p].Name4:"";l.Sort1=u[p].Sort1?u[p].Sort1:"";l.Sort2=u[p].Sort2?u[p].Sort2:"";l.NameCo=u[p].NameCo?u[p].NameCo:"";l.PostCod1=u[p].PostCod1?u[p].PostCod1:"";l.City1=u[p].City1?u[p].City1:"";l.Building=u[p].Building?u[p].Building:"";l.Floor=u[p].Floor?u[p].Floor:"";l.Roomnum=u[p].Roomnum?u[p].Roomnum:"";l.AddrLocation=u[p].Location?u[p].Location:"";l.Strsuppl1=u[p].Strsuppl1?u[p].Strsuppl1:"";l.Strsuppl2=u[p].Strsuppl2?u[p].Strsuppl2:"";l.Strsuppl3=u[p].Strsuppl3?u[p].Strsuppl3:"";l.RefPosta=u[p].RefPosta?u[p].RefPosta:"";l.Landx=u[p].Landx?u[p].Landx:"";l.TimeZone=u[p].TimeZone?u[p].TimeZone:"";l.Region=u[p].RfePost?u[p].RfePost:"";l.RegionDesc=u[p].Regiotxt?u[p].Regiotxt:""}}}else{l.Title=l.Title?l.Title:"";l.TitleCode=l.TitleCode?l.TitleCode:"";l.Name1=l.Name1?l.Name1:"";l.Name2=l.Name2?l.Name2:"";l.Name3=l.Name3?l.Name3:"";l.Name4=l.Name4?l.Name4:"";l.Sort1=l.Sort1?l.Sort1:"";l.Sort2=l.Sort2?l.Sort2:"";l.NameCo=l.NameCo?l.NameCo:"";l.PostCod1=l.PostCod1?l.PostCod1:"";l.City1=l.City1?l.City1:"";l.Building=l.Building?l.Building:"";l.Floor=l.Floor?l.Floor:"";l.Roomnum=l.Roomnum?l.Roomnum:"";l.Strsuppl1=l.Strsuppl1?l.Strsuppl1:"";l.Strsuppl2=l.Strsuppl2?l.Strsuppl2:"";l.Strsuppl3=l.Strsuppl3?l.Strsuppl3:"";l.AddrLocation=l.AddrLocation?l.AddrLocation:"";l.RefPosta=l.RefPosta?l.RefPosta:"";l.Landx=l.Landx?l.Landx:"";l.TimeZone=l.TimeZone?l.TimeZone:"";l.Region=l.Region?l.Region:"";l.RegionDesc=l.RegionDesc?l.RegionDesc:""}l.intlAddr=t.equiIntlAddr}}var E=t.equiLAM;if(E){for(var M=0;M<E.length;M++){if(E[M].Equi===l.Equnr){if(l.Equnr===n&&l.EquipmentCatogory==="L"&&t.lamSwitch==="X"){var D=M;var v="Superior object has been changed. Do you want to copy linear data from superior object?";sap.m.MessageBox.confirm(v,{title:"Confirmation",onClose:function(e){if(e==="OK"){var a={Equi:E[D].Equi,Lrpid:E[D].Lrpid,LrpidDesc:E[D].LrpDescr,Strtptatr:E[D].Strtptatr,Endptatr:E[D].Endptatr,Length:E[D].Length,LinUnit:E[D].LinUnit,LinUnitDesc:E[D].Uomtext,Startmrkr:E[D].Startmrkr,Endmrkr:E[D].Endmrkr,Mrkdisst:E[D].Mrkdisst,Mrkdisend:E[D].Mrkdisend,MrkrUnit:E[D].MrkrUnit,LamDer:E[D].LamDer};var i=t.getView().getModel(t.oModelName);var r=i.getData();r.lam=a;i.setData(r);t.lam.setModel(i,"AIWLAM")}}});break}}}}t.getView().getModel(t.oModelName).setData(l)}else{this.isInstall=false;this.superiorEquipment="";this.superiorEqDesc="";this.functionalLocation="";this.functionalLocDesc="";var C=this.getView().byId("idLocation").getName();var A=this.getView().byId("idAbcInd").getName();var T=this.getView().byId("idPlntSec").getName();var q=this.getView().byId("idWorkCen").getName();var b=this.getView().byId("idCostCtr").getName();var P=this.getView().byId("idPlnGrp").getName();var V=this.getView().byId("idMainWC").getName();for(var L=0;L<s.length;L++){if(s[L].Property===C&&!s[L].instLoc){l.Location="";l.Locationdesc=""}else if(s[L].Property===A&&!s[L].instLoc){l.Abckz="";l.Abctx=""}else if(s[L].Property===T&&!s[L].instLoc){l.BeberFl="";l.Fing="";l.Tele=""}else if(s[L].Property===q&&!s[L].instLoc){l.Arbpl="";l.Ktext="";l.WcWerks=""}else if(s[L].Property===b&&!s[L].instLoc){l.Kostl="";l.Kokrs=""}else if(s[L].Property===P&&!s[L].instLoc){l.Ingrp="";l.Innam=""}else if(s[L].Property===V&&!s[L].instLoc){l.MainArbpl="";l.MainWerks="";l.MainKtext=""}else if(s[L].Property==="Adrnr"){if(t.getView().getModel("SUP_EQUI_DATA")){var N=sap.ui.getCore().getModel("SUP_EQUI_DATA");var F=N.getData();var I;for(var w=0;w<F.length;w++){if(e.getSource().getModel(t.oModelName).getData().Equnr===F[w].Equnr){I=w;break}}var x=t.getView().getModel(t.oModelName);var r=x.getData();var k=t.getView().getModel("SUP_EQUI_DATA").getData()[0];if(k){r.Tplnr=r.Tplnr===k.Tplnr?"":r.Tplnr;r.Pltxt=r.Pltxt===k.Pltxt?"":r.Pltxt;r.BeberFl=r.BeberFl===k.BeberFl?"":r.BeberFl;r.Fing=r.Fing===k.Fing?"":r.Fing;r.Tele=r.Tele===k.Tele?"":r.Tele;r.Location=r.Location===k.Location?"":r.Location;r.Locationdesc=r.Locationdesc===k.Locationdesc?"":r.Locationdesc;r.Arbpl=r.Arbpl===k.Arbpl?"":r.Arbpl;r.Ktext=r.Ktext===k.Ktext?"":r.Ktext;r.WcWerks=r.WcWerks===k.WcWerks?"":r.WcWerks;r.Abckz=r.Abckz===k.Abckz?"":r.Abckz;r.Abctx=r.Abctx===k.Abctx?"":r.Abctx;r.MainArbpl=r.MainArbpl===k.MainArbpl?"":r.MainArbpl;r.MainKtext=r.MainKtext===k.MainKtext?"":r.MainKtext;r.MainWerks=r.MainWerks===k.MainWerks?"":r.MainWerks;r.Kostl=r.Kostl===k.Kostl?"":r.Kostl;r.Mctxt=r.Mctxt===k.Mctxt?"":r.Mctxt;r.Ingrp=r.Ingrp===k.Ingrp?"":r.Ingrp;r.Innam=r.Innam===k.Innam?"":r.Innam;if(r.Maintplant!==""){r.TplnrEnabled=true;r.MaintplantEnabled=true;r.BukrsEnabled=false;r.Bukrs=r.Bukrs;r.Butxt=r.Butxt;r.Kokrs=r.Kokrs;r.Werks=r.Werks;r.Planningplantdes=r.Planningplantdes}else{r.BukrsEnabled=true;r.Bukrs=r.Bukrs===k.Bukrs?"":r.Bukrs;r.Butxt=r.Butxt===k.Butxt?"":r.Butxt;r.Kokrs=r.Kokrs===k.Kokrs?"":r.Kokrs;r.Werks=r.Werks===k.Werks?"":r.Werks;r.Planningplantdes=r.Planningplantdes===k.Planningplantdes?"":r.Planningplantdes}r.Title="";r.TitleCode="";r.Name1="";r.Name2="";r.Name3="";r.Name4="";r.Sort1="";r.Sort2="";r.NameCo="";r.PostCod1="";r.City1="";r.Building="";r.Floor="";r.Roomnum="";r.Strsuppl1="";r.Strsuppl2="";r.Strsuppl3="";r.AddrLocation="";r.RefPosta="";r.Landx="";r.TimeZone="";r.Region="";r.RegionDesc="";r.RefPostaLblReq=false;var y=sap.ui.getCore().getModel("equiAddressView");var R=y.getData();for(var O=0;O<R.length;O++){if(e.getSource().getModel(t.oModelName).getData().Equnr===R[O].Equnr){R.splice(O,1);y.setData(R);break}}var B=t.getView().getModel("equiAddressView");var W=B.getData();W.enabled=true;B.setData(W);F.splice(I,1);N.setData(F)}}l.intlAddr=[]}}if(s[8].Property==="Adrnr"&&s[8].instLoc===true){var B=t.getView().getModel("equiAddressView");var W=B.getData();W.enabled=true;B.setData(W);sap.ui.getCore().getModel("equiAddressView").getData().forEach(function(e){if(e.Equnr===l.Equnr){e.IsEditable=true}})}l.MaintplantEnabled=true;l.Tplnr="";l.Pltxt="";l.TplnrEnabled=true;t.getView().getModel(t.oModelName).setData(l);t.getView().getModel(t.oModelName).refresh();this.readSystemStatus(t)}if(s.length<11){var d=this.getView().getModel("dataOrigin").getData();s.splice(0,0,d[0]);s.splice(6,0,d[6]);this.getView().getModel("dataOrigin").setData(s)}e.getSource().getParent().close();if(this.doiDisplayFlag){this.doiDisplayFlag=false}},onDonePress:function(e){var t=this;t.doneFlag=true;var i,r;var n=e.getSource().getId();if(t.viewName==="CreateEqui"||t.oModelUpdateFlag===true){t.handleValueState("Equnr","EqunrVS",e);t.handleValueState("Eqktx","EqktxVS",e);t.handleValueState("EquipmentCatogory","EquipmentCatogoryVS",e);var s=t.getView().getModel(t.oModelName);var l=s.getData();if(l.Fhmkz){t.handleValueState("PlanvPrt","PlanvPrtVS",e)}if(l.Title!==""&&l.Title!==undefined||l.TitleCode!==""&&l.TitleCode!==undefined||l.Name1!==""&&l.Name1!==undefined||l.Name2!==""&&l.Name2!==undefined||l.Name3!==""&&l.Name3!==undefined||l.Name4!==""&&l.Name4!==undefined||l.Sort1!==""&&l.Sort1!==undefined||l.Sort2!==""&&l.Sort2!==undefined||l.NameCo!==""&&l.NameCo!==undefined||l.PostCod1!==""&&l.PostCod1!==undefined||l.City1!==""&&l.City1!==undefined||l.Building!==""&&l.Building!==undefined||l.Floor!==""&&l.Floor!==undefined||l.Roomnum!==""&&l.Roomnum!==undefined||l.AddrLocation!==""&&l.AddrLocation!==undefined||l.Strsuppl1!==""&&l.Strsuppl1!==undefined||l.Strsuppl2!==""&&l.Strsuppl2!==undefined||l.Strsuppl3!==""&&l.Strsuppl3!==undefined||l.TimeZone!==""&&l.TimeZone!==undefined||l.RefPosta!==""&&l.RefPosta!==undefined||l.Region!==""&&l.Region!==undefined){t.handleValueState("RefPosta","RefPostaVS",e);var o=this.getView().byId("idTBLIntlAddr").getItems();for(var d=0;d<o.length;d++){var u=o[d].getCells();for(var p=0;p<u.length;p++){if(u[3].getValueState()==="Error"){i=true}if(u[4].getValueState()==="Error"){r=true}}}}if(l.dfps&&l.dfps.dfpsEnabled===true&&l.dfps.Tailno===""){l.dfps.TailnoVS="Error";s.refresh();t.doneFlag=false}}if(t.doneFlag===false){var g=t.getView().getModel("i18n").getProperty("MANDMSG");t.invokeMessage(g);return}else if(i||r){var c=[];if(i){c.push("Enter valid state")}if(r){c.push("Enter valid city")}var f=c.join("\n");t.invokeMessage(f);return}else{var m=t.getView().getModel(t.oModelName);var S=m.getData();if(t.class.getModel()){var h=t.class.getModel().getData();if(h){S.classItems=[];for(var E=0;E<h.length;E++){S.classItems.push(h[E])}m.setData(S)}}if(this.chData){var M=this.chData;if(M!==null&&M!==undefined){S.characteristics=[];for(var D=0;D<M.length;D++){S.characteristics.push(M[D])}}m.setData(S)}if(this.lnrChData){var v=this.lnrChData;if(v!==null&&v!==undefined&&v.length>0){S.linearChar=[];for(var D=0;D<v.length;D++){S.linearChar.push(v[D])}}m.setData(S)}if(n.indexOf("idBtnCheck")>-1){this.validateCheck();return}this.chData=[];this.lnrChData=[];if(t.oModelUpdateFlag&&!t.sExistFlag){var C=sap.ui.getCore().getModel(t.oModelName).getData();t.getView().getModel(t.oModelName).getData().viewParameter="change";C.push(t.getView().getModel(t.oModelName).getData());sap.ui.getCore().getModel("dataOriginMOP").getData().EQ.push({key:t.getView().getModel(t.oModelName).getData().Equnr,DOI:t.getView().getModel("dataOrigin").getData()})}sap.ui.getCore().getModel(t.oModelName).refresh();t.currentFragment=undefined;var A=this.getView().getModel("ain");if(A){var T=A.getData();var q=sap.ui.getCore().getModel("ainMOP").getData();var b=false;for(var P=0;P<q.length;P++){if(q[P].key===t.getView().getModel(t.oModelName).getData().Equnr){q[P].AIN=T;b=true;break}}if(!b){sap.ui.getCore().getModel("ainMOP").getData().push({key:t.getView().getModel(t.oModelName).getData().Equnr,AIN:T})}this.getView().setModel(undefined,"ain")}if(t.viewName==="CreateEqui"){var V=false;var L=sap.ui.getCore().getModel("dataOriginMOP").getData().EQ;for(var P=0;P<L.length;P++){if(L[P].key===t.getView().getModel(t.oModelName).getData().Equnr){sap.ui.getCore().getModel("dataOriginMOP").getData().EQ[P].DOI=t.getView().getModel("dataOrigin").getData();V=true;break}}if(!V){var N=this.rowIndex.split("/")[1];sap.ui.getCore().getModel("dataOriginMOP").getData().EQ[N]={key:t.getView().getModel(t.oModelName).getData().Equnr,DOI:t.getView().getModel("dataOrigin").getData()}}this.dataDerivationFlow();var F=true}t.rowIndex=undefined;if(this.doiView){this.doiView.destroy();sap.ui.getCore().byId("il").destroy();sap.ui.getCore().byId("eq").destroy();sap.ui.getCore().byId("currVal").destroy();sap.ui.getCore().byId("targetVal").destroy();this.doiView=undefined}if(this.dataOriginFrag){this.dataOriginFrag.destroy();this.dataOriginFrag=undefined}if(!F){var I=a.getInstance().getPreviousHash();if(I!==undefined){history.go(-1)}else{t.getRouter().navTo("main",{},true)}}else{F=false}}},validateCheck:function(){var e=this;var t=sap.ui.getCore().getModel("AIWFLOC").getData();var a=sap.ui.getCore().getModel("AIWEQUI").getData();var r=sap.ui.getCore().getModel("AIWListWCModel").getData();var n=sap.ui.getCore().getModel("tempCrTypeModel").getData();var s={ChangeRequestType:n.crtype,CrDescription:n.desc,IsDraft:"C",Messages:[],FuncLoc:[],FLAddr:[],FLAddrI:[],FLLAM:[],FLClass:[],FLVal:[],Equipment:[],EqAddr:[],EqAddrI:[],EqDFPS:[],EqPRT:[],EqLAM:[],EqClass:[],EqVal:[],MSPoint:[],MSLAM:[],MSClass:[],MSVal:[],MPLAN:[],MPItem:[],MPLAM:[],MPOBList:[],MPCycle:[],MRBHeader:[],MRBItem:[],MRBSBIT:[],EBHeader:[],EBItem:[],EBSBIT:[],FBHeader:[],FBItem:[],FBSBIT:[],WBHeader:[],WBItem:[],WBSBIT:[],ONetwork:[],ONLAM:[],Workcenter:[],WCCost:[],GTList:[],GTOprs:[],GTComp:[],GTClass:[],GTVal:[],ETList:[],ETOprs:[],ETComp:[],ETClass:[],ETVal:[],FTList:[],FTOprs:[],FTComp:[],FTClass:[],FTVal:[],Olink:[],OLClass:[],OLVal:[],FLLAMCH:[],EqLAMCH:[]};if(t.length>0){for(var l=0;l<t.length;l++){var o={Tplnr:t[l].Functionallocation,Txtmi:t[l].Flocdescription,TplkzFlc:t[l].Strucindicator,Tplxt:t[l].StrucIndicatorDesc,EditMask:t[l].EditMask,Hierarchy:t[l].Hierarchy,Fltyp:t[l].Floccategory,Flttx:t[l].FlocCategoryDesc,Swerk:t[l].Maintplant,Plantname:t[l].MaintplantDesc,StorFloc:t[l].Location,Locationdesc:t[l].Locationdesc,Abckzfloc:t[l].Abckz,Abctx:t[l].Abctx,Bukrsfloc:t[l].Bukrs,Butxt:t[l].Butxt,City:t[l].City,KostFloc:t[l].Kostl,KokrFloc:t[l].Kokrs,Contareaname:t[l].Mctxt,PlntFloc:t[l].Werks,Planningplantdes:t[l].Planningplantdes,Ingrp:t[l].Ingrp,Plannergrpdesc:t[l].Innam,Arbplfloc:t[l].Arbpl,Wergwfloc:t[l].WcWerks,Gewrkfloc:t[l].MainArbpl,MainWcPlant:t[l].MainWerks,Tplma:t[l].SupFunctionallocation,Supflocdesc:t[l].SupFlocdescription,BeberFl:t[l].BeberFl,Fing:t[l].Fing,Tele:t[l].Tele,Submtiflo:t[l].ConstrType,Constdesc:t[l].ConstructionDesc,Eqart:t[l].TechnicalObjectTyp,Eartx:t[l].Description,Stattext:t[l].Stattext,StsmFloc:t[l].StsmEqui,Statproftxt:t[l].StsmEquiDesc,UstwFloc:t[l].UstwEqui,UswoFloc:t[l].UswoEqui,UstaFloc:t[l].UstaEqui,Adrnr:t[l].Adrnr,Adrnri:t[l].Adrnri,Deact:t[l].Deact,Modeldesc:t[l].Modeldesc,Modelref:t[l].Modelref,Modelrver:t[l].Modelrver,Modelext:t[l].Modelext,Modelname:t[l].Modelname,Modelver:t[l].Modelver};s.FuncLoc.push(o);var d={Funcloc:t[l].Functionallocation,Title:t[l].TitleCode,Name1:t[l].Name1,Name2:t[l].Name2,Name3:t[l].Name3,Name4:t[l].Name4,Sort1:t[l].Sort1,Sort2:t[l].Sort2,NameCo:t[l].NameCo,PostCod1:t[l].PostCod1,City1:t[l].City1,Building:t[l].Building,Floor:t[l].Floor,Roomnum:t[l].Roomnum,Strsuppl1:t[l].Strsuppl1,Strsuppl2:t[l].Strsuppl2,Strsuppl3:t[l].Strsuppl3,Location:t[l].AddrLocation,RPostafl:t[l].RefPosta,Landx:t[l].Landx,TimeZone:t[l].TimeZone,RPostFl:t[l].Region,Regiotxt:t[l].RegionDesc};s.FLAddr.push(d);var u=t[l].intlAddr;if(u){for(var p=0;p<u.length;p++){s.FLAddrI.push(u[p])}}if(t[l].altlbl){if(e.AltLblDerv==="2"&&t[l].altlbl.length>0){for(var g=0;g<t[l].altlbl.length;g++){var c={Funcloc:t[l].Functionallocation,AltAlkey:t[l].altlbl[g].AltAlkey,AltStrno:t[l].altlbl[g].AltStrno,AltTplkz:t[l].altlbl[g].AltTplkz};s.FLALTLBEL.push(c)}}}if(t[l].Floccategory==="L"&&t[l].lam){var f={Funcloc:t[l].Functionallocation,Lrpid:t[l].lam.Lrpid,Strtptatr:t[l].lam.Strtptatr,Endptatr:t[l].lam.Endptatr,Length:t[l].lam.Length,LinUnit:t[l].lam.LinUnit,Startmrkr:t[l].lam.Startmrkr,Endmrkr:t[l].lam.Endmrkr,Mrkdisst:t[l].lam.Mrkdisst,Mrkdisend:t[l].lam.Mrkdisend,MrkrUnit:t[l].lam.MrkrUnit};s.FLLAM.push(f)}var m=t[l].classItems;if(m){if(m.length>0){for(var S=0;S<m.length;S++){var h={Funcloc:t[l].Functionallocation,Classtype:m[S].Classtype,Class:m[S].Class,Clstatus1:m[S].Clstatus1};s.FLClass.push(h)}}}var E=t[l].characteristics;if(E){if(E.length>0){for(var M=0;M<E.length;M++){var D={Funcloc:t[l].Functionallocation,Atnam:E[M].Atnam,Textbez:E[M].Textbez,Atwrt:E[M].Atwrt,Class:E[M].Class};s.FLVal.push(D)}}}var v=t[l].linearChar;if(v){if(v.length>0){var C=$.map(v,function(e){return $.extend(true,{},e)});for(var M=0;M<C.length;M++){delete C[M].linCharEnable;C[M].Funcloc=t[l].Functionallocation;s.FLLAMCH.push(C[M])}}}}}if(a.length>0){for(var A=0;A<a.length;A++){var T={Herst:a[A].Herst,Equnr:a[A].Equnr,Txtmi:a[A].Eqktx,Swerk:a[A].Maintplant,Name1:a[A].MaintplantDesc,TplnEilo:a[A].Tplnr,Flocdescription:a[A].Pltxt,Eqtyp:a[A].EquipmentCatogory,Etytx:a[A].EquipCatgDescription,Eqart:a[A].TechnicalObjectTyp,Eartx:a[A].Description,Typbz:a[A].Typbz,SubmEeqz:a[A].ConstrType,Constdesc:a[A].ConstructionDesc,BukrEilo:a[A].Bukrs,Butxt:a[A].Butxt,HequEeqz:a[A].SuperordinateEquip,SuperordEqDes:a[A].SuperordinateEquipDesc,TidnEeqz:a[A].TechIdNum,KostEilo:a[A].Kostl,KokrEilo:a[A].Kokrs,Contareaname:a[A].Mctxt,StorEilo:a[A].Location,Locationdesc:a[A].Locationdesc,AbckEilo:a[A].Abckz,Abctx:a[A].Abctx,PplaEeqz:a[A].Werks,Planningplantdes:a[A].Planningplantdes,IngrEeqz:a[A].Ingrp,Plannergrpdesc:a[A].Innam,Serge:a[A].Serge,MapaEeqz:a[A].MapaEeqz,Stattext:a[A].Stattext,StsmEqui:a[A].StsmEqui,Statproftxt:a[A].StsmEquiDesc,UstwEqui:a[A].UstwEqui,UswoEqui:a[A].UswoEqui,UstaEqui:a[A].UstaEqui,Deact:a[A].Deact,Answt:a[A].Answt,Ansdt:e._formatDate(a[A].Ansdt),Waers:a[A].Waers,ArbpEilo:a[A].Arbpl,WorkCenterPlant:a[A].WcWerks,ArbpEeqz:a[A].MainArbpl,MainWcPlant:a[A].MainWerks,BebeEilo:a[A].BeberFl,Fing:a[A].Fing,Tele:a[A].Tele,HeqnEeqz:a[A].EquipPosition,Adrnr:a[A].Adrnr,Adrnri:a[A].Adrnri,Funcid:a[A].Funcid,Frcfit:a[A].Frcfit,Frcrmv:a[A].Frcrmv};s.Equipment.push(T);var q={Equi:a[A].Equnr,PlanvPrt:a[A].PlanvPrt,SteufPrt:a[A].SteufPrt,KtschPrt:a[A].KtschPrt,Ewformprt:a[A].Ewformprt,SteufRef:a[A].SteufRef,KtschRef:a[A].KtschRef,EwformRef:a[A].EwformRef};s.EqPRT.push(q);if(a[A].EquipmentCatogory==="L"&&a[A].lam){var b={Equi:a[A].Equnr,Lrpid:a[A].lam.Lrpid,Strtptatr:a[A].lam.Strtptatr,Endptatr:a[A].lam.Endptatr,Length:a[A].lam.Length,LinUnit:a[A].lam.LinUnit,Startmrkr:a[A].lam.Startmrkr,Endmrkr:a[A].lam.Endmrkr,Mrkdisst:a[A].lam.Mrkdisst,Mrkdisend:a[A].lam.Mrkdisend,MrkrUnit:a[A].lam.MrkrUnit};s.EqLAM.push(b)}var P={Equi:a[A].Equnr,Title:a[A].TitleCode,Name1:a[A].Name1,Name2:a[A].Name2,Name3:a[A].Name3,Name4:a[A].Name4,Sort1:a[A].Sort1,Sort2:a[A].Sort2,NameCo:a[A].NameCo,PostCod1:a[A].PostCod1,City1:a[A].City1,Building:a[A].Building,Floor:a[A].Floor,Roomnum:a[A].Roomnum,Strsuppl1:a[A].Strsuppl1,Strsuppl2:a[A].Strsuppl2,Strsuppl3:a[A].Strsuppl3,Location:a[A].AddrLocation,RefPosta:a[A].RefPosta,Landx:a[A].Landx,TimeZone:a[A].TimeZone,RfePost:a[A].Region,Regiotxt:a[A].RegionDesc};s.EqAddr.push(P);var V=a[A].intlAddr;if(V){for(var p=0;p<V.length;p++){s.EqAddrI.push(V[p])}}if(a[A].dfps){var L={Equi:a[A].Equnr,DeviceId:a[A].dfps.Tailno,Topsiteid:a[A].dfps.Area,Topsitede:a[A].dfps.AreaDesc,AreaPro:a[A].dfps.AreaPrfl,SiteId:a[A].dfps.Site,SiteDesc:a[A].dfps.SiteDesc,SitePro:a[A].dfps.SitePrfl,MpoId:a[A].dfps.MPO,MpoDescr:a[A].dfps.MPODesc,RicId:a[A].dfps.RIC,RicDescr:a[A].dfps.RICDesc,ModelId:a[A].dfps.ModelId,ModelDes:a[A].dfps.ModelIdDesc,Foreignob:i.truetoX(a[A].dfps.ForeignEq),TecState:a[A].dfps.TechSts,DepState:a[A].dfps.OperSts,DfpsRmrk:a[A].dfps.Remark};s.EqDFPS.push(L)}var N=a[A].classItems;if(N){if(N.length>0){for(var F=0;F<N.length;F++){var I={Equi:a[A].Equnr,Classtype:N[F].Classtype,Class:N[F].Class,Clstatus1:N[F].Clstatus1};s.EqClass.push(I)}}}var w=a[A].characteristics;if(w){if(w.length>0){for(var x=0;x<w.length;x++){var k={Equi:a[A].Equnr,Atnam:w[x].Atnam,Textbez:w[x].Textbez,Atwrt:w[x].Atwrt,Class:w[x].Class};s.EqVal.push(k)}}}var v=a[A].linearChar;if(v){if(v.length>0){var C=$.map(v,function(e){return $.extend(true,{},e)});for(var M=0;M<C.length;M++){delete C[M].linCharEnable;C[M].Equi=a[A].Equnr;s.EqLAMCH.push(C[M])}}}}}if(r.length>0){for(var y=0;y<r.length;y++){var R={Werks:r[y].plant,Arbpl:r[y].wc,Txtmi:r[y].wcDesc,Verwe:r[y].wcCat,Crveran:r[y].person,Planv:r[y].usg,Vgwts:r[y].stdVal,Crsteus:r[y].ctrlKey};if(r[y].hasOwnProperty("Type")){if(r[y].Type==="X"){R.Type="X"}}s.Workcenter.push(R);if(r[y].cost){for(var O=0;O<r[y].cost.length;O++){var B={Werks:r[y].cost[O].CrKokrs,Arbpl:r[y].wc,CrKostl:r[y].cost[O].CrKostl,Costcentxt:r[y].cost[O].Costcentxt,CrLstar:r[y].cost[O].CrLstar,Forn1:r[y].cost[O].Forn1,ActvttypeTxt:r[y].cost[O].ActvttypeTxt,Frmltxt:r[y].cost[O].Frmltxt};s.WCCost.push(B)}}}}if(s.FLAddrI.length>0){s.FLAddrI=$.map(s.FLAddrI,function(e){return $.extend(true,{},e)});for(var y=0;y<s.FLAddrI.length>0;y++){delete s.FLAddrI[y].AdNationEnable;delete s.FLAddrI[y].City1iVS;delete s.FLAddrI[y].StreetiVS}}if(s.EqAddrI.length>0){s.EqAddrI=$.map(s.EqAddrI,function(e){return $.extend(true,{},e)});for(var y=0;y<s.EqAddrI.length>0;y++){delete s.EqAddrI[y].AdNationEnable;delete s.EqAddrI[y].City1iVS;delete s.EqAddrI[y].StreetiVS}}this.getView().byId("equipmentPage").setBusy(true);var W=this.getView().getModel();W.create("/ChangeRequestSet",s,{success:function(t){e.getView().byId("equipmentPage").setBusy(false);var a=t;var r=[];for(var n=0;n<a.Messages.results.length;n++){r.push({type:i.getMessageType(a.Messages.results[n].Type),title:a.Messages.results[n].Message})}e.createMessagePopover(r,"")},error:function(t){e.getView().byId("equipmentPage").setBusy(false);var a=[],i=[];if(JSON.parse(t.responseText).error.innererror.errordetails===undefined||JSON.parse(t.responseText).error.innererror.errordetails.length===0){a[0]=JSON.parse(t.responseText).error.message.value}else{for(var r=0;r<JSON.parse(t.responseText).error.innererror.errordetails.length;r++){a[r]=JSON.parse(t.responseText).error.innererror.errordetails[r].message}}var n=a.join("\n");sap.m.MessageBox.show(n,{title:"Error",icon:sap.m.MessageBox.Icon.ERROR,onClose:function(){}})}})},_getMessagePopover:function(){if(!this._oMessagePopover){this._oMessagePopover=sap.ui.xmlfragment("ugieamui.mdg.eam.lib.popover.MessagePopover",this);this.getView().addDependent(this._oMessagePopover)}return this._oMessagePopover},handleMessagePopoverPress:function(e){this._getMessagePopover().openBy(e.getSource())},createMessagePopover:function(e,t){var a=[];var i,r=this._getMessagePopover();if(typeof e==="string"){a.push({type:t,title:e,message:e})}else if(Array.isArray(e)){a=e;for(var n=0;n<a.length;n++){a[n].message=a[n].title}}sap.ui.getCore().getMessageManager().removeAllMessages();for(var n=0;n<a.length;n++){i=new u({message:a[n].message,type:a[n].type,target:"/Dummy",processor:this.getView().getModel()});sap.ui.getCore().getMessageManager().addMessages(i)}r.toggle(this.getView().byId("idMessagePopover"));this.getView().byId("idMessagePopover").setEnabled(true);this.getView().byId("idMessagePopover").setText(a.length+"")},onForceInstDismantSelect:function(e){var t=e.getSource().getBindingInfo("selected").binding.sPath;var a=e.getSource().getModel(this.oModelName).getData();if(t==="/Frcfit"&&e.getSource().getSelected()===true){a.Frcfit="X";a.Frcrmv=""}else if(t==="/Frcrmv"&&e.getSource().getSelected()===true){a.Frcrmv="X";a.Frcfit=""}this.getView().getModel(this.oModelName).refresh()},onLinkAinPress:function(e){var t=this.getView().getModel("AIWEQUI");var a=this.getView().getModel("ainModel");var i=t.getData();var r=i.Typbz,n=i.Herst;this.getView().byId("equipmentPage").setBusy(true);var s=this;jQuery.sap.delayedCall(30,this,function(){d.searchPress(e,this,r,n,a);s.getView().byId("equipmentPage").setBusy(false)})},onRowSelect:function(e){var t=e.getParameter("listItem").oBindingContexts.results.sPath;this.sPath=t},onAINMoreInfoClose:function(e){e.getSource().getParent().close()},onDeLlinkAinPress:function(e){var t=this;sap.m.MessageBox.confirm("Link from Equipment to AIN Model will be Removed. Do you want to continue?",{title:"Confirm",onClose:function(e){if(e==="OK"){var a=t.getView().getModel("ain").getData();a.linkVisible=true;a.moreInfo=false;a.equiCreate=false;a.Name="";a.Modelid="";a.Description="";a.Manufacturer="";a.Modeltemplate="";t.getView().getModel("ain").setData(a);sap.ui.getCore().getModel("ain").setData(a)}},styleClass:"",initialFocus:null,textDirection:sap.ui.core.TextDirection.Inherit})},handleMoreInfoPress:function(e){var a=this;var i=this.getView().getModel("ainModel");var r=this.getView().getModel("ain").getProperty("/Modelid");var n=[new sap.ui.model.Filter("Modelid","EQ",r)];var s=new sap.m.BusyDialog;s.open();var l=["AINHeaderinfo","AINAnnounce","AINAttachments","AINCharacteristics"];i.read("/Equipment_DetailsSet",{filters:n,urlParameters:{$expand:l},success:function(e){var r=new t;r.setData(e.results[0]);a.getView().setModel(r,"detail");sap.ui.getCore().setModel(r,"detail");if(!a.moreInfoDialog){a.moreInfoDialog=sap.ui.xmlfragment("ugieamui.mdg.eam.lib.ain.AINMoreInfo",a);a.getView().addDependent(a.moreInfoDialog)}var n=a.getView().getModel("detail").getProperty("/AINHeaderinfo/results/0/Image");var l=i.sServiceUrl+"/DownloadattachmentSet(AttachmentID='"+n+"_image_png"+"')/$value";sap.ui.getCore().byId("imgDisplay").setSrc(l);a.moreInfoDialog.setModel(r);a.moreInfoDialog.open();s.close()},error:function(e){}})},setAinInitialData:function(){var e={moreInfo:false,linkVisible:true,deLinkVisible:false};var t=new sap.ui.model.json.JSONModel(e);this.getView().setModel(t,"ain");sap.ui.getCore().setModel(t,"ain")},linkModel:function(e){var t=sap.ui.getCore().byId("searchResults").getModel("results").getProperty(this.sPath);this.getView().byId("equipmentPage").setBusy(true);this.pressDialog.close();this.pressDialog.destroy();jQuery.sap.delayedCall(10,this,function(){var e=new sap.ui.model.json.JSONModel;t.moreInfo=true;t.equiCreate=true;t.linkVisible=false;e.setData(t);this.getView().setModel(e,"ain");sap.ui.getCore().setModel(e,"ain");this.getView().getModel("AIWEQUI").setProperty("/Herst",t.Manufacturer);this.getView().getModel("AIWEQUI").setProperty("/Typbz",t.Name);this.readAinDefaultClass(t.Modelid);this.getView().byId("equipmentPage").setBusy(false)})},readAinDefaultClass:function(e){var t=this.getView().getModel("ainModel");var a=this;var i=[];if(e){i.push(new sap.ui.model.Filter("ClassDesc","EQ",e))}t.read("/ClassEquiSet",{filters:i,urlParameters:{$expand:"EqValua"},success:function(e){var t=e;var i=t.results[0];i.ctEnable=false;i.classEnable=false;i.ClassTypeDesc=i.Artxt;delete i.Artxt;delete i.Changerequestid;delete i.Clint;delete i.Desc_class;var r=new sap.ui.model.json.JSONModel;r.setData([i]);a.class.setModel(r);var n=t.results[0].EqValua.results;if(n){if(n.length>0){for(var s=0;s<n.length;s++){n[s].cNameEnable=false;delete n[s].Ataut;delete n[s].Ataw1;delete n[s].Atawe;delete n[s].Atcod;delete n[s].Atflb;delete n[s].Atflv;delete n[s].Atimb;delete n[s].Atsrt;delete n[s].Atvglart;delete n[s].Atzis;delete n[s].Changerequestid;delete n[s].CharName;delete n[s].Charid;delete n[s].Classtype;delete n[s].Service;delete n[s].Valcnt;n[s].slNo=s+1;n[s].flag=n[s].Class+"-"+n[s].slNo}for(var l=0;l<n.length;l++){var o=1;for(var d=0;d<n.length;d++){if(l===d){continue}if(n[d].Atnam===n[l].Atnam&&n[d].Class===n[l].Class){o++}}if(o>1){n[l].charDltEnable=true}else{n[l].charDltEnable=false}if(n[l].Atein===true){n[l].charAddEnable=false}}var u=new sap.ui.model.json.JSONModel;u.setData(n);a.char.setModel(u);a.chData=n}}},error:function(e){}})},onSearch:function(e){var t="";var a="";d.onSearch(t,a,"main",this)},onDataOriginPress:function(e){var a=this;if(!this.dataOriginFrag){this.dataOriginFrag=sap.ui.xmlfragment("ugieamui.mdg.eam.lib.doi.DOIElement",this)}var i={flocVisible:true,equiVisible:true,parent:"",parentDesc:"",parentSelected:false,IndvSelected:false,currentObj:"",currentObjDesc:"",DOIindex:null};var r=new t(i);this.dataOriginFrag.setModel(r,"doiElement");var n=this.getView().getModel(this.oModelName).getData();var l=this.getView().getModel("dataOrigin").getData();if(n.SuperordinateEquip!==""){i.flocVisible=false;i.equiVisible=true}else if(n.SuperordinateEquip===""&&n.Tplnr!==""){i.flocVisible=true;i.equiVisible=false}var o=e.getSource(),d,u=this.dataOriginFrag.getContent()[0].getContent()[1],p=this.dataOriginFrag.getContent()[0].getContent()[2],g=this.dataOriginFrag.getContent()[0].getContent()[4],c=this.dataOriginFrag.getContent()[0].getContent()[5],f=this.dataOriginFrag.getContent()[0].getContent()[7],m=this.dataOriginFrag.getContent()[0].getContent()[8];p.setText("Functional Location");f.mEventRegistry.valueHelpRequest=[];if(o.getId().includes("MaintenancePlant")){this.dataOriginFrag.setTitle("Data Orgin - "+this.getView().getModel("i18n").getProperty("MAINT_PLANT"));d=this.getView().byId("idMaintenancePlant").getValue();f.setShowValueHelp(true);f.attachValueHelpRequest(function(e){this.onMaintPlantVH("idMaintenancePlant",e)});if(d===""){u.setEnabled(false);p.setEnabled(false);g.setEnabled(false);c.setEnabled(false)}i.parent=l[0].SupFlVal;i.parentDesc=l[0].Txtmi;i.DOIindex=0;if(l[0].maintenance===true){i.parentSelected=false;i.IndvSelected=true}else if(l[0].instLoc===true){i.parentSelected=true;i.IndvSelected=false}}else if(o.getId().includes("Location")){this.dataOriginFrag.setTitle("Data Orgin - "+this.getView().getModel("i18n").getProperty("LOC"));d=this.getView().byId("idLocation").getValue();f.setShowValueHelp(true);f.attachValueHelpRequest(function(e){s.onDOILocationVH(a,e)});if(d===""){u.setEnabled(false);p.setEnabled(false);g.setEnabled(false);c.setEnabled(false)}i.parent=l[1].SupFlVal;i.parentDesc=l[1].Txtmi;i.DOIindex=1;if(l[1].maintenance===true){i.parentSelected=false;i.IndvSelected=true}else if(l[1].instLoc===true){i.parentSelected=true;i.IndvSelected=false}}else if(o.getId().includes("abcInd")){this.dataOriginFrag.setTitle("Data Orgin - "+this.getView().getModel("i18n").getProperty("ABC_IND"));d=this.getView().byId("idAbcInd").getValue();f.setShowValueHelp(true);f.attachValueHelpRequest(function(e){s.onDOIabcIndVH(a,e)});if(d===""){u.setEnabled(false);p.setEnabled(false);g.setEnabled(false);c.setEnabled(false)}i.parent=l[4].SupFlVal;i.parentDesc=l[4].Txtmi;i.DOIindex=4;if(l[4].maintenance===true){i.parentSelected=false;i.IndvSelected=true}else if(l[4].instLoc===true){i.parentSelected=true;i.IndvSelected=false}}else if(o.getId().includes("PlantSec")){this.dataOriginFrag.setTitle("Data Orgin - "+this.getView().getModel("i18n").getProperty("PL_SEC"));d=this.getView().byId("idPlntSec").getValue();f.setShowValueHelp(true);f.attachValueHelpRequest(function(e){s.onDOIPlantSecVH(a,e)});if(d===""){u.setEnabled(false);p.setEnabled(false);g.setEnabled(false);c.setEnabled(false)}i.parent=l[2].SupFlVal;i.parentDesc=l[2].Txtmi;i.DOIindex=2;if(l[2].maintenance===true){i.parentSelected=false;i.IndvSelected=true}else if(l[2].instLoc===true){i.parentSelected=true;i.IndvSelected=false}}else if(o.getId().includes("WorkCen")){this.dataOriginFrag.setTitle("Data Orgin - "+this.getView().getModel("i18n").getProperty("WC"));d=this.getView().byId("idWorkCen").getValue();f.setShowValueHelp(true);f.attachValueHelpRequest(function(e){s.onDOIMainwcVH(a,e)});if(d===""){u.setEnabled(false);p.setEnabled(false);g.setEnabled(false);c.setEnabled(false)}i.parent=l[3].SupFlVal;i.parentDesc=l[3].Txtmi;i.DOIindex=3;if(l[3].maintenance===true){i.parentSelected=false;i.IndvSelected=true}else if(l[3].instLoc===true){i.parentSelected=true;i.IndvSelected=false}}else if(o.getId().includes("CostCenter")){this.dataOriginFrag.setTitle("Data Orgin - "+this.getView().getModel("i18n").getProperty("CC"));d=this.getView().byId("idCostCtr").getValue();f.setShowValueHelp(true);f.attachValueHelpRequest(function(e){s.onDOICostCenterVH(a,e)});if(d===""){u.setEnabled(false);p.setEnabled(false);g.setEnabled(false);c.setEnabled(false)}i.parent=l[5].SupFlVal;i.parentDesc=l[5].Txtmi;i.DOIindex=5;if(l[5].maintenance===true){i.parentSelected=false;i.IndvSelected=true}else if(l[5].instLoc===true){i.parentSelected=true;i.IndvSelected=false}}else if(o.getId().includes("PlanPlant")){this.dataOriginFrag.setTitle("Data Orgin - "+this.getView().getModel("i18n").getProperty("PLAN_PLANT_TXT"));d=this.getView().byId("idPlnPlnt").getValue();f.setShowValueHelp(true);f.attachValueHelpRequest(function(e){s.onDOIPlanPlantVH(a,e)});if(d===""){u.setEnabled(false);p.setEnabled(false);g.setEnabled(false);c.setEnabled(false)}i.parent=l[6].SupFlVal;i.parentDesc=l[6].Txtmi;i.DOIindex=6;if(l[6].maintenance===true){i.parentSelected=false;i.IndvSelected=true}else if(l[6].instLoc===true){i.parentSelected=true;i.IndvSelected=false}}else if(o.getId().includes("PlanGrp")){this.dataOriginFrag.setTitle("Data Orgin - "+this.getView().getModel("i18n").getProperty("PL_GRP"));d=this.getView().byId("idPlnGrp").getValue();f.setShowValueHelp(true);f.attachValueHelpRequest(function(e){s.onDOIPlanrGrpVH(a,e)});if(d===""){u.setEnabled(false);p.setEnabled(false);g.setEnabled(false);c.setEnabled(false)}i.parent=l[7].SupFlVal;i.parentDesc=l[7].Txtmi;i.DOIindex=7;if(l[7].maintenance===true){i.parentSelected=false;i.IndvSelected=true}else if(l[7].instLoc===true){i.parentSelected=true;i.IndvSelected=false}}else if(o.getId().includes("MainWC")){this.dataOriginFrag.setTitle("Data Orgin - "+this.getView().getModel("i18n").getProperty("mainWorkCenter"));d=this.getView().byId("idMainWC").getValue();f.setShowValueHelp(true);f.attachValueHelpRequest(function(e){s.onDOIMainwcVH(a,e)});if(d===""){u.setEnabled(false);p.setEnabled(false);g.setEnabled(false);c.setEnabled(false)}i.parent=l[8].SupFlVal;i.parentDesc=l[8].Txtmi;i.DOIindex=8;if(l[8].maintenance===true){i.parentSelected=false;i.IndvSelected=true}else if(l[8].instLoc===true){i.parentSelected=true;i.IndvSelected=false}}if(i.parent===""){p.setEnabled(false);c.setEnabled(false)}else{p.setEnabled(true);c.setEnabled(true)}i.currentObj=d;r=new t(i);this.dataOriginFrag.setModel(r,"doiElement");this.dataOriginFrag.open()},onCheckSelect:function(e){var t=e.getSource().getId();var a=this.dataOriginFrag.getModel("doiElement");var i=a.getData();if(t.includes("IndvMaint")){i.parentSelected=false;i.IndvSelected=true}else{i.parentSelected=true;i.IndvSelected=false}this.dataOriginFrag.setModel(a,"doiElement")},onElementActionPress:function(e){var t,a,i;var r=this.dataOriginFrag.getModel("doiElement");var n=r.getData();var s=this.getView().getModel(this.oModelName).getData();var l=this.getView().getModel("dataOrigin").getData();if(n.IndvSelected){l[n.DOIindex].instLoc=false;l[n.DOIindex].maintenance=true;l[n.DOIindex].currentVal=n.currentObj;t=n.currentObj;a=n.currentObjDesc;i=n.currentObjDesc2!==undefined?n.currentObjDesc2:""}else if(n.parentSelected){l[n.DOIindex].instLoc=true;l[n.DOIindex].maintenance=false;l[n.DOIindex].currentVal=n.parent;t=n.parent;a=n.parentDesc;i=n.currentObjDesc2!==undefined?n.currentObjDesc2:""}if(n.DOIindex===1){s.Location=t;s.Locationdesc=a}if(n.DOIindex===2){s.BeberFl=t;s.Fing=a;s.Tele=i}if(n.DOIindex===3){s.Arbpl=t;s.Ktext=a}if(n.DOIindex===4){s.Abckz=t;s.Abctx=a}if(n.DOIindex===5){s.Kostl=t;s.Kokrs=a;s.Mctxt=i}if(n.DOIindex===6){s.Werks=t;s.Planningplantdes=a}if(n.DOIindex===7){s.Ingrp=t;s.Innam=a}if(n.DOIindex===8){s.MainArbpl=t;s.MainKtext=a;s.MainWerks=i}this.getView().getModel("dataOrigin").refresh();this.getView().getModel(this.oModelName).refresh();e.getSource().getParent().close()},onElementCancelPress:function(e){e.getSource().getParent().close()},onTailNoVH:function(e){s.TailNoVH(e,this)},onTailNoChange:function(e){s.TailNoChange(e,this)},onDFPSSiteVH:function(e){s.DFPSSiteVH(e,this)},onDFPSSiteChange:function(e){s.DFPSSiteChange(e,this)},onDFPSAreaVH:function(e){s.DFPSAreaVH(e,this)},onDFPSAreaChange:function(e){s.DFPSAreaChange(e,this)},onDFPSSiteProVH:function(e){s.DFPSSiteProVH(e,this)},onDFPSSiteProChange:function(e){s.DFPSSiteProChange(e,this)},onDFPSAreaProVH:function(e){s.DFPSAreaProVH(e,this)},onDFPSAreaProChange:function(e){s.DFPSAreaProChange(e,this)},onModelIdWsVH:function(e){s.ModelIdWsVH(e,this)},onModelIdWsChange:function(e){s.ModelIdWsChange(e,this)},deriveDFPSdata:function(){var e=this;var t=e.getView().getModel(e.oModelName);var a=t.getData();var r=e.getView().getModel();var n="/EqDFPSSet";var s=[new sap.ui.model.Filter("Equi","EQ",a.Equnr),new sap.ui.model.Filter("Eqtyp","EQ",a.EquipmentCatogory),new sap.ui.model.Filter("SiteId","EQ",a.dfps.Site),new sap.ui.model.Filter("ModelId","EQ",a.dfps.ModelId),new sap.ui.model.Filter("MatEqu","EQ","")];e.BusyDialog.open();r.read(n,{filters:s,success:function(r){e.BusyDialog.close();if(r.results.length>0){a.dfps.Area=r.results[0].Topsiteid;a.dfps.AreaDesc=r.results[0].Topsitede;a.dfps.AreaPrfl=r.results[0].AreaPro;a.dfps.SitePrfl=r.results[0].SitePro;a.dfps.MPO=r.results[0].MpoId;a.dfps.MPODesc=r.results[0].MpoDescr;a.dfps.RIC=r.results[0].RicId;a.dfps.RICDesc=r.results[0].RicDescr;a.dfps.ModelId=r.results[0].ModelId;a.dfps.ModelIdDesc=r.results[0].ModelDes;a.dfps.ForeignEq=i.XtoTrue(r.results[0].Foreignob);a.dfps.TechSts=r.results[0].TecState;a.dfps.OperSts=r.results[0].DepState;a.dfps.Remark=r.results[0].DfpsRmrk;t.setData(a)}},error:function(e){}})},onOperStatusEditpress:function(){if(!this.oprStsFrag){this.oprStsFrag=sap.ui.xmlfragment("ugiaiwui.mdg.aiw.request.Fragments.EQUI.OperStatus",this)}var e=this;var a=e.getView().getModel(e.oModelName);var i=a.getData();var r=i.dfps.OperSts;var n=r.split(" ");var s=n.slice(1);var l=e.oprStsFrag.getAggregation("content")[0].getId();var o=e.oprStsFrag.getAggregation("content")[1].getId();var d=sap.ui.getCore().byId(l);var u=sap.ui.getCore().byId(o);var p=this.getView().getModel("valueHelp2");var g=[];p.read("/DfpsStatusPop1Set",{success:function(a){if(a.results.length>0){var i=new t;i.setData(a.results);e.oprStsFrag.setModel(i,"mStsWitNum");e.oprStsFrag.setModel(e.getView().getModel("i18n"),"i18n");for(var r in a.results){if(n[0]===a.results[r].Txt04Dfps){d.setSelectedItem(d.getItems()[r],true,true)}}}p.read("/DfpsStatusPop2Set",{success:function(a){if(a.results.length>0){var i=new t;i.setData(a.results);e.oprStsFrag.setModel(i,"mStsWitoutNum");for(var r in s){for(var n in a.results){if(s[r]===a.results[n].Txt04Dfps){u.setSelectedItem(u.getItems()[n],true,true)}}}e.oprStsFrag.open()}},error:function(e){}})},error:function(e){}})},onOperStatusEditOKpress:function(){var e=this;var t=e.getView().getModel(e.oModelName);var a=t.getData();var i=e.oprStsFrag.getAggregation("content")[0].getId();var r=e.oprStsFrag.getAggregation("content")[1].getId();var n=sap.ui.getCore().byId(i);var s=sap.ui.getCore().byId(r);var l=e.oprStsFrag.getModel("mStsWitNum");var o=e.oprStsFrag.getModel("mStsWitoutNum");var d=n.getSelectedItem().getBindingContext("mStsWitNum").getPath();var u=l.getProperty(d).Txt04Dfps;for(var p in s.getSelectedItems()){var g=s.getSelectedItems()[p];var c=g.getBindingContext("mStsWitoutNum").getPath();u=u+" "+g.getBindingContext("mStsWitoutNum").getProperty(c).Txt04Dfps}a.dfps.OperSts=u;t.setData(a);this.oprStsFrag.close()},onOperStatusEditCancelclose:function(){this.oprStsFrag.close()},onIppeAccessRecPress:function(){var e=this;var t=this.getView().getModel(this.oModelName).getData();if(t.ConstrType===""||t.ConstrTypeVS==="Error"){return}var a={title:e.getView().getModel("i18n").getProperty("IPPE_SELECTION"),noDataText:e.getView().getModel("i18n").getProperty("LOAD")+"...",columns:[new sap.m.Column({header:[new sap.m.Text({text:"{i18n>MAT}"})]}),new sap.m.Column({demandPopin:true,minScreenWidth:"Tablet",header:[new sap.m.Text({text:"{i18n>PLANT}"})]}),new sap.m.Column({demandPopin:true,minScreenWidth:"Tablet",header:[new sap.m.Text({text:"{i18n>USAGE}"})]}),new sap.m.Column({demandPopin:true,minScreenWidth:"Tablet",header:[new sap.m.Text({text:"{i18n>desc}"})]})],items:{path:"/IppeSelectionSet",template:new sap.m.ColumnListItem({type:"Active",unread:false,cells:[new sap.m.Text({text:"{Matnr}"}),new sap.m.Text({text:"{Plant}"}),new sap.m.Text({text:"{Usage}"}),new sap.m.Text({text:"{Description}"})]})},confirm:function(t){var a=t.getParameter("selectedItem").getBindingContext().getPath();var i=t.getParameter("selectedItem").getBindingContext().getModel().getProperty(a).Ppeguid;e.getIPPEConfig(i)}};var i="/IppeSelectionSet";var r=[new sap.ui.model.Filter("Kmatn","EQ",""),new sap.ui.model.Filter("MatEqu","EQ",""),new sap.ui.model.Filter("SubmEeqz","EQ",t.ConstrType)];var n=e.getView().getModel();var s=[new sap.m.Text({text:"{Matnr}"}),new sap.m.Text({text:"{Plant}"}),new sap.m.Text({text:"{Usage}"}),new sap.m.Text({text:"{Description}"})];var o=l.getValueHelp(n,i,s,r,a,"Matnr","Plant");o.open();o.setModel(e.getView().getModel("i18n"),"i18n")},getIPPEConfig:function(e){var t=this;if(e){var a=this.getView().getModel(this.oModelName);var i=a.getData();var r=this.getView().getModel();var n=[new sap.ui.model.Filter("Ppeguid","EQ",e)];r.read("/IppeAccessSet",{filters:n,success:function(e){if(e.results&&e.results.length>0){var t=e.results[0];i.AcsnodeIppe=t.Pname;i.DescIppe=t.Pntext;i.VariantIppe=t.Pvname;i.AltIppe=t.Altnum;i.Ppeguid=t.Ppeguid;a.setData(i);a.refresh()}},error:function(e){}})}},onIppeDeletePress:function(){var e=this;var t=this.getView().getModel(this.oModelName);var a=t.getData();if(a.Ppeguid===""){return}a.AcsnodeIppe="";a.DescIppe="";a.VariantIppe="";a.AltIppe="";a.Ppeguid="";t.setData(a);t.refresh()},handleLinearCharRowAdd:function(){this.addLinearChar(this.oModelName)},handleLinearCharRowDelete:function(e){this.deleteLinearChar(e,this.oModelName)},onCreateAssignSiteAreaPress:function(e){var t=this.getView().getModel(this.oModelName).getData();var a=t.dfps;if(a.Tailno===""){var i=this.getView().getModel("i18n").getProperty("MANDMSG");this.invokeMessage(i);a.TailnoVS="Error";this.getView().getModel(this.oModelName).refresh();return}if(!this.dfpsSiteArea){this.dfpsSiteArea=sap.ui.xmlfragment("ugiaiwui.mdg.aiw.request.Fragments.EQUI.DFPSAreaSite",this);this.getView().addDependent(this.dfpsSiteArea)}this.dfpsSiteArea.open()},onCloseSiteArea:function(){this.dfpsSiteArea.close();this.getView().getModel(this.oModelName).refesh()},onClearSiteArea:function(){},onDFPScreate:function(e){var t=this.getView().getModel(this.oModelName).getData();var a=t.dfps;a.dfpsCrtEnabled=false;a.dfpsDltEnabled=true;a.TailnoReq=true;a.dfpsEnabled=true;this.getView().getModel(this.oModelName).refresh()},onDFPSdelete:function(){var e=this.getView().getModel(this.oModelName).getData();var t=e.dfps;t.Tailno="";t.TailnoVS="None";t.Area="";t.AreaDesc="";t.AreaPrfl="";t.Site="";t.SiteDesc="";t.SiteVS="None";t.SitePrfl="";t.MPO="";t.MPODesc="";t.RIC="";t.RICDesc="";t.ModelId="";t.ModelIdDesc="";t.ModelIdVS="None";t.ForeignEq=false;t.TechSts="";t.OperSts="0001";t.Remark="";t.dfpsCrtEnabled=true;t.dfpsDltEnabled=false;t.dfpsEnabled=false;t.TailnoReq=false;this.getView().getModel(this.oModelName).refresh()},onClassSelect:function(e){var t=e.getParameter("listItem").getBindingContext().getPath();t=t.substring(t.lastIndexOf("/")+1);this.classIndex=t;var a=this.class.getModel().getData();this.clValue=a[this.classIndex].Class;this._class=a[this.classIndex].Class;this.classType=a[this.classIndex].Classtype;var i=e.getParameter("listItem");var r;if(e.getSource().getSelectedItems().length===a.length){for(r=0;r<a.length;r++){a[r].checked=true}}else if(e.getSource().getSelectedItems().length===0){for(r=0;r<a.length;r++){a[r].checked=false}}else{for(r=0;r<a.length;r++){if(i.getSelected()===true){if(a[r].Class===a[this.classIndex].Class){a[r].checked=true}}else{if(a[r].Class===a[this.classIndex].Class){a[r].checked=false}}}}var n=this.char.getModel();if(n!==undefined&&n!==null){var s=n.getData();if(s!==null){for(var l=0;l<s.length;l++){if(!s[l].hasOwnProperty("flag")){s[l].flag=this.clValue+"-"+s[l].slNo}}}var o=[];if(this.chData===undefined){if(s!==null){this.chData=s}}else if(this.chData instanceof Array){if(this.chData.length===0){this.chData=s}}else{if(s!==null&&this.chData!==undefined){for(var d=0;d<s.length;d++){for(var u=0;u<this.chData.length;u++){if(this.chData[u].Class!==s[d].Class){var p=s;o.push(p[d])}}}}if(this.chData!==null&&this.chData!==undefined){Array.prototype.push.apply(this.chData,o);var g=[];this.chData=this.chData.filter(function(e){if(g.indexOf(e.Atnam+e.Atwrt)===-1){g.push(e.Atnam+e.Atwrt);return true}return false})}}var c=[];for(var f=0;f<this.chData.length;f++){if(this.chData[f].SingleVal===true){c.push(this.chData[f])}}var m=[];var S=[];c=c.filter(function(e){if(m.indexOf(e.Atnam)===-1){m.push(e.Atnam);return true}S.push(e);return false});var h=[];if(this.chData!==null&&this.chData!==undefined){for(var E=0;E<a.length;E++){if(a[E].checked===true){for(var M=0;M<this.chData.length;M++){var D=this.chData[M].flag;D=D.split("-");if(a[E].Class===this.chData[M].Class){h.push(this.chData[M])}}}else{for(var M=0;M<h.length;M++){var D=this.chData[M].flag;D=D.split("-");if(a[E].Class===h[M].Class){h.pop(this.chData[M])}}}}}for(var v=0;v<h.length;v++){var C=0;for(var u=0;u<h.length;u++){if(h[u].Atnam===h[v].Atnam){C++}}if(C===1&&h[v].Aterf==="X"){h[v].charDltEnable=false}}if(e.getSource().getSelectedItems().length===a.length){for(var A=0;A<S.length;A++){var T=0;for(var q=0;q<h.length;q++){var b=S[A].Atnam;var P=h[q].Atnam;if(b===P){if(T===0){T++;continue}else{h.splice(q,1)}}}}}var V=[];h=h.filter(function(e){if(V.indexOf(e.Atnam+e.Atwrt)===-1){V.push(e.Atnam+e.Atwrt);return true}return false});var L=new sap.ui.model.json.JSONModel;L.setData(h);this.char.setModel(L)}}})});