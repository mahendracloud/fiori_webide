sap.ui.define(["ugiaiwui/mdg/aiw/request/controller/BaseController","sap/ui/model/json/JSONModel","sap/ui/core/routing/History","ugiaiwui/mdg/aiw/request/model/formatter","sap/ui/model/Filter","sap/ui/model/FilterOperator","ugiaiwui/mdg/aiw/request/util/ValueHelpRequest","ugiaiwui/mdg/aiw/library/js/ValueHelpProvider","sap/ui/core/message/Message"],function(e,t,a,r,n,i,o,s,l){"use strict";return e.extend("ugiaiwui.mdg.aiw.request.controller.ItemMaintenancePlan",{formatter:r,oAttach:[],onInit:function(){this._oComponent=sap.ui.component(sap.ui.core.Component.getOwnerIdFor(this.getView()));this.getRouter().getRoute("itemMpmi").attachPatternMatched(this._onObjectMatched,this);var e=this._oComponent.getModel();e.setDefaultCountMode(sap.ui.model.odata.CountMode.None);this.getView().setModel(e);var a=this._oComponent.getModel("NewModel");this.getView().setModel(a,"valueHelp");var r=this._oComponent.getModel("NewModel2");this.getView().setModel(r,"valueHelp2");var n,i=new t({busy:true,delay:0});n=this.getView().getBusyIndicatorDelay();this.setModel(i,"objectView");this.getOwnerComponent().getModel().metadataLoaded().then(function(){i.setProperty("/delay",n)});this.oModelName="itemDetailView";var o=this.getView().createId("lamFrag");this.lam=sap.ui.core.Fragment.byId(o,"lamSimpleForm");var s=this.getView().createId("lamAprvFrag");this.lamAprvSF=sap.ui.core.Fragment.byId(s,"lamSimpleForm");this.isLam();var l=sap.ui.getCore().getMessageManager();this.getView().setModel(l.getMessageModel(),"message");l.registerObject(this.getView(),true)},isLam:function(){var e=this;var t=this.getView().getModel("valueHelp");t.read("/LAM_switchSet('')",{success:function(t,a){e.lamSwitch=t.lam_switch},error:function(e){}})},attachModelEventHandlers:function(e){e.attachPropertyChange(this.handlePropertyChanged,this)},handlePropertyChanged:function(){this.oModelUpdateFlag=true},_onObjectMatched:function(e){this.mainRowIndex=decodeURIComponent(e.getParameter("arguments").mainRowIndex);this.itemPath=decodeURIComponent(e.getParameter("arguments").itemPath);var a=this.itemPath;var r=sap.ui.getCore().getModel("AIWMPMIDetail").getData();var n=new sap.ui.model.json.JSONModel;n.setData(r.itemModel[a]);var i=n.getData();this.getView().setModel(n,this.oModelName);this.lam.setModel(n,"AIWLAM");this.lam.setVisible(i.LDVisible);this.lamAprvSF.setVisible(false);var o=r.ObjListItems;this.getView().setModel(new t(o),"ObjListItemModel");var s=[new sap.ui.model.Filter("Mitemnumb","EQ",r.itemModel[a].Mitemnumb),new sap.ui.model.Filter("Warpl","EQ",r.Warpl)];var l=this.getView().byId("idObjectListItem");l.getBinding("items").filter(s);this.strategy=e.getParameter("arguments").strategy;this.cUnit=e.getParameter("arguments").cUnit;this.getView().bindElement({path:a,model:this.oModelName});this.viewName=e.getParameter("arguments").viewName;if(this.viewName==="ChangeMpmi"){this.attachModelEventHandlers(n)}if(this.viewName==="Approve"){this.lam.setVisible(false);this.lamAprvSF.setVisible(true);this.lamAprvSF.setModel(n,"AIWLAM")}var u=new t;u.setData(sap.ui.getCore().getModel("mainView").getData());this.getView().setModel(u,"mainView");var g=r.Warpl;var d=r.Mptyp;this.configMPITemFields(g,d);var p=new t([]);p.setData(sap.ui.getCore().getModel("ApproveModel").getData());this.getView().setModel(p,"ApproveModel");this.category=e.getParameter("arguments").maintCat;if(this.category==="EA"||this.category==="PM"){i.QmartLBL=false;i.QmartVis=false;i.nTypetxtVis=false}else if(this.category==="NO"){i.AuartLBL=false;i.AuartVis=false;i.oTypeTxtVis=false}var c=e.getParameter("arguments").multiCycle;if(c==="true"){i.CycleseqLBL=true;i.CycleseqVis=true}this.system=e.getParameter("arguments").sys;if(this.system==="true"){i.AsmblyObMaxLength=40}else{i.AsmblyObMaxLength=18}var m=r.cycleModel;var M=[];if(m&&m.length>0){for(var f=0;f<m.length;f++){var h={};if(m[f].Cycleseqi!==""){h.Cycleseqi=m[f].Cycleseqi;M.push(h)}}}this.cycleSeq=M;if(i.Cycleseq===""){i.Cycleseq="00"}n.setData(i)},configMPITemFields:function(e,a){var r=this;var n=new t;var i={};var o=this.getView().getModel();var s=[new sap.ui.model.Filter("Mitemnumb","EQ",e),new sap.ui.model.Filter("MaintCategory","EQ",a)];o.read("/MpFieldConfigSet",{filters:s,success:function(e){var t=e.results[0];t.Funcloc==="H"?i.visFloc=false:i.visFloc=true;t.Equipment==="H"?i.visEqui=false:i.visEqui=true;t.Assembly==="H"?i.visAsbly=false:i.visAsbly=true;t.Serialnr==="H"?i.visSerNum=false:i.visSerNum=true;t.Sermaterial==="H"?i.visMat=false:i.visMat=true;t.Deviceid==="H"?i.visDevData=false:i.visDevData=true;n.setData(i);r.getView().setModel(n,"configModel")},error:function(e){}})},onNavBack:function(){var e=this;var t=e.getView().getModel("i18n").getProperty("DATA_LOSS");sap.m.MessageBox.show(t,{title:"Confirmation",icon:sap.m.MessageBox.Icon.QUESTION,actions:[sap.m.MessageBox.Action.YES,sap.m.MessageBox.Action.NO],onClose:function(t){if(t==="YES"){var a=new sap.ui.model.json.JSONModel;var r=e.getView().getModel(e.oModelName).getData();r=e.displayObject();a.setData(r);window.history.go(-1)}}})},displayObject:function(){return{Mitemnumb:"",Pstxt:"",Cycleseq:"",Tplnr:"",Pltxt:"",Equnr:"",Eqktx:"",AsmblyOb:"",Assemblydesc:"",Werks:"",Planningplantdes:"",Auart:"",oTypeTxt:"",Qmart:"",nTypeTxt:"",ArbpMi:"",WergwMi:"",Ingrp:"",Innam:"",Zeieh:"",Priok:"",ItmPriotxt:"",GsberMi:"",Gtext:"",TaskDet:false,Ilart:"",Ilatx:"",PlntyMi:"",ApfktMi:"",PlnnrMi:"",PlnalMi:"",Gpcounterdesc:"",AnlzuMi:"",Anlzux:"",SwerkMil:"",Name1:"",StortMil:"",Locationdesc:"",MsgrpIl:"",BeberMil:"",Fing:"",Tele:"",ArbplIl:"",Workcenterdesc:"",AbckzIl:"",Abctx:"",EqfnrIl:"",BukrsMil:"",Butxt:"",City:"",Anln1Mil:"",Anln2Mil:"",Txt50:"",GsberIl:"",KostlMil:"",Contareaname:"",KokrsMil:"",Posid:"",Post1:"",AufnrIl:"",SettleOrdDesc:"",CycleseqVS:"None",CycleseqVST:"",TplnrVS:"None",TplnrVST:"",EqunrVS:"None",EqunrVST:"",AsmblyObVS:"None",AsmblyObVST:"",WerksVS:"None",WerksVST:"",AuartVS:"None",AuartVST:"",QmartVS:"None",QmartVST:"",ArbpMiVS:"None",ArbpMiVST:"",WergwMiVS:"None",WergwMiVST:"",IngrpVS:"None",IngrpVST:"",lam:{Mitemnumb:"",Lrpid:"",LrpidDesc:"",Strtptatr:"",Endptatr:"",Length:"",LinUnit:"",LinUnitDesc:"",Startmrkr:"",Endmrkr:"",Mrkdisst:"",Mrkdisend:"",MrkrUnit:"",enableLrp:true,enableMarker:false,LrpidVS:"None",StrtptatrVS:"None",EndptatrVS:"None",LinUnitVS:"None",StartmrkrVS:"None",EndmrkrVS:"None",MrkdisstVS:"None",MrkdisendVS:"None",MrkrUnitVS:"None"}}},onCancelPress:function(){var e=this.getView().getModel("i18n").getProperty("DATA_LOSS");var t=this;sap.m.MessageBox.show(e,{title:"Confirmation",icon:sap.m.MessageBox.Icon.QUESTION,actions:[sap.m.MessageBox.Action.YES,sap.m.MessageBox.Action.NO],onClose:function(e){if(e==="YES"){var a=new sap.ui.model.json.JSONModel;var r=t.getView().getModel(t.oModelName).getData();r=t.displayObject();a.setData(r);window.history.go(-1)}}})},valueHelpFunSelect:function(e){var t=e.getSource().getBindingInfo("value").binding.sPath;if(t.indexOf("/Ingrp")!==-1){o.valueHelpFunPlGrp(e.getSource().getModel(this.oModelName).getData(),this)}else if(t.indexOf("/Cycleseq")!==-1){o.valueHelpCycleSetSeq(e.getSource().getModel(this.oModelName).getData(),this)}else if(t.indexOf("/AsmblyOb")!==-1){o.valueHelpAssembly(e,this)}else if(t.indexOf("/Werks")!==-1){o.valueHelpFunPlanPlant(e.getSource().getModel(this.oModelName).getData(),this)}else if(t.indexOf("/Auart")!==-1){o.valueHelpFunOrderType(e.getSource().getModel(this.oModelName).getData(),this)}else if(t.indexOf("/Qmart")!==-1){o.valueHelpFunNotifType(e,this)}else if(t.indexOf("/ArbpMi")!==-1){o.valueHelpFunMpmiMainWc(e.getSource().getModel(this.oModelName).getData(),this)}else if(t.indexOf("/WergwMi")!==-1){o.valueHelpFunMpmiMainWcPlnt(e.getSource().getModel(this.oModelName).getData(),this)}else if(t.indexOf("/Tplnr")!==-1){o.valueHelpFunFloc(e,this)}else if(t.indexOf("/Equnr")!==-1){o.valueHelpFunEquipment(e,this)}else if(t.indexOf("/PlntyMi")!==-1){o.TLTypeVH(e.getSource().getModel(this.oModelName).getData(),this)}else if(t.indexOf("/PlnnrMi")!==-1){o.TLGroupVH(e.getSource().getModel(this.oModelName).getData(),this)}else if(t.indexOf("/PlnalMi")!==-1){o.TLCounterVH(e.getSource().getModel(this.oModelName).getData(),this)}},readCounter:function(e,t){var a="/DeriveMsptSet";var r=t.getView().getModel();var n=[];if(e.Equnr!==""&&e.Tplnr===""){n=[new sap.ui.model.Filter("Equnr","EQ",e.Equnr),new sap.ui.model.Filter("Unit","EQ",t.cUnit)]}else if(e.Equnr===""&&e.Tplnr!==""){n=[new sap.ui.model.Filter("Floc","EQ",e.Tplnr),new sap.ui.model.Filter("Unit","EQ",t.cUnit)]}else if(e.Equnr!==""&&e.Tplnr!==""){n=[new sap.ui.model.Filter("Equnr","EQ",e.Equnr),new sap.ui.model.Filter("Unit","EQ",t.cUnit)]}var i=function(e){if(e.results.length>0){t.displayCounter(e.results,t)}};var o=function(){};t._readData(a,r,i,o,n)},displayCounter:function(e,t){var a;if(a===undefined){var r=new sap.m.TableSelectDialog({title:t.getView().getModel("i18n").getProperty("MP_CTR"),noDataText:t.getView().getModel("i18n").getProperty("LOAD")+"...",columns:[new sap.m.Column({header:[new sap.m.Text({text:"Measuring Point"})]}),new sap.m.Column({demandPopin:true,minScreenWidth:"Tablet",header:[new sap.m.Text({text:"Description"})]}),new sap.m.Column({demandPopin:true,minScreenWidth:"Tablet",header:[new sap.m.Text({text:"Measuring Point Unit"})]}),new sap.m.Column({demandPopin:true,minScreenWidth:"Tablet",visible:false,header:[new sap.m.Text({text:"Counter Reading"})]})],items:{path:"/",template:new sap.m.ColumnListItem({type:"Active",unread:false,cells:[new sap.m.Text({text:"{Point}"}),new sap.m.Text({text:"{Description}"}),new sap.m.Text({text:"{Unit}"}),new sap.m.Text({text:"{Reading}"})]})},confirm:function(e){t.refCounter=e.getParameter("selectedItem").getCells()[0].getText();t.refUnit=e.getParameter("selectedItem").getCells()[2].getText();t.reading=e.getParameter("selectedItem").getCells()[3].getText()},search:function(e){var t=e.getParameter("value");e.getSource().getBinding("items").filter(!t?[]:[new sap.ui.model.Filter([new sap.ui.model.Filter("Point",sap.ui.model.FilterOperator.Contains,t),new sap.ui.model.Filter("Description",sap.ui.model.FilterOperator.Contains,t)],false)])}});var n=new sap.ui.model.json.JSONModel;n.setData(e);r.setModel(n);var i=r.getItems();for(var o=0;o<i.length;o++){i[o].setVisible(true)}}r.open()},readPlantData:function(e,t){var a=t.getView().getModel();var r="/MPItemSet";var n;if(e.Equnr!==""&&e.Tplnr===""){n=[new sap.ui.model.Filter("Equnr","EQ",e.Equnr)]}else if(e.Equnr!==""&&e.Tplnr!==""){n=[new sap.ui.model.Filter("Equnr","EQ",e.Equnr)]}else if(e.Equnr===""&&e.Tplnr!==""){n=[new sap.ui.model.Filter("TplnrMi","EQ",e.Tplnr)]}var i={$expand:"MPItemToPlanningData"};var o=function(a){if(a.results.length>0){var r=a.results[0].MPItemToPlanningData.results[0];e.Werks=r.PlntMi;e.Planningplantdes=r.Planningplantdes;e.Ingrp=r.IngrpMi;e.Innam=r.Plannergrpdesc;e.ArbpMi=r.ArbpMi;e.WergwMi=r.WergwMi;t.getView().getModel(t.oModelName).refresh()}};var s=function(){};t._readData(r,a,o,s,n,i)},readRefObject:function(e,t){var a="/MPRefObjSet('"+e.Equnr+"')";var r=t.getView().getModel();var n=function(a){e.Tplnr=a.Tplnrmi;e.Pltxt=a.Flocdesc;t.getView().getModel(t.oModelName).refresh();if(e.Equnr!==""&&e.Tplnr===""){t.readPlantData(e,t)}else if(e.Equnr!==""&&e.Tplnr!==""){t.readPlantData(e,t)}else if(e.Equnr===""&&e.Tplnr!==""){t.readPlantData(e,t)}if(t.strategy==="PERF"||t.strategy==="singlePerf"){t.readCounter(e,t)}};var i=function(){};t._readData(a,r,n,i)},handleClose:function(e){var t=this;var a=e.getParameter("selectedItem");var r=e.getSource().getModel(t.oModelName).getData();if(a){if(t.inputId.indexOf("Item_FunctionalLoc")!==-1){r.TplnrVS="None";r.TplnrVST="";r.Tplnr=e.getParameter("selectedItem").getProperty("title");r.Pltxt=e.getParameter("selectedItem").getProperty("description");e.getSource().getBinding("items").filter([]);t.getView().getModel(t.oModelName).refresh();if(r.Equnr!==""&&r.Tplnr===""){t.readPlantData(r,t)}else if(r.Equnr!==""&&r.Tplnr!==""){t.readPlantData(r,t)}else if(r.Equnr===""&&r.Tplnr!==""){t.readPlantData(r,t)}if(t.strategy==="PERF"||t.strategy==="singlePerf"){t.readCounter(r,t)}}if(t.inputId.indexOf("Item_Equipment")!==-1){r.Equnr=e.getParameter("selectedItem").getProperty("title");r.Eqktx=e.getParameter("selectedItem").getProperty("description");r.EqunrVS="None";r.EqunrVST="";t.getView().getModel(t.oModelName).refresh();t.readRefObject(r,t);e.getSource().getBinding("items").filter([])}}},onFlocChange:function(e){var t=this;var a=e.getSource().getModel(t.oModelName).getData().Tplnr;if(a===""||a===undefined){e.getSource().getModel(t.oModelName).getData().Tplnr="";e.getSource().getModel(t.oModelName).getData().Pltxt="";var r=t.getView().getModel(t.oModelName);var n=r.getData();n.enableLoc=true;n.SwerkMil="";n.SwerkMilVS="None";n.Name1="";n.StortMil="";n.StortMilVS="None";n.Locationdesc="";n.MsgrpIl="";n.MsgrpIlVS="None";n.BeberMil="";n.BeberMillVS="None";n.Fing="";n.ArbplIl="";n.ArbplIlVS="None";n.Workcenterdesc="";n.AbckzIl="";n.AbckzIlVS="None";n.Abctx="";n.EqfnrIl="";n.EqfnrIlVS="None";n.BukrsMil="";n.Butxt="";n.City="";n.BukrsMilVS="None";n.Anln1Mil="";n.Txt50="";n.Anln1MilVS="None";n.Anln2Mil="";n.Anln2MilVS="None";n.GsberIl="";n.Gtext="";n.GsberIlVS="None";n.KostlMil="";n.Contareaname="";n.KostlMilVS="None";n.KokrsMil="";n.Posid="";n.Post1="";n.PosidVS="None";n.AufnrIl="";n.SettleOrdDesc="";n.AufnrIlVS="None";r.setData(n)}else{var i=false;var s=sap.ui.getCore().getModel("AIWFLOC").getData();if(s.length>0){for(var l=0;l<s.length;l++){if(s[l].Functionallocation===a.toUpperCase()){e.getSource().setValue(a.toUpperCase());e.getSource().getModel(t.oModelName).getData().Pltxt=s[l].Flocdescription;i=true;break}}}var u=e.getSource().getModel(t.oModelName).getData().Equnr;if(u!==""||u!==undefined){e.getSource().getModel(t.oModelName).getData().Equnr="";e.getSource().getModel(t.oModelName).getData().Eqktx=""}if(i){t._itemViewData();t.fetchData(t.oModelName,parseInt(t.mainRowIndex),parseInt(t.itemPath))}else{o._changeFunctionalLocation(e,t)}}},orderTypeChange:function(e){var t=this;var a=e.getSource().getModel(t.oModelName).getData().Auart;if(a===""||a===undefined){e.getSource().getModel(t.oModelName).getData().Auart="";e.getSource().getModel(t.oModelName).getData().oTypeTxt=""}e.getSource().setValueState("None")},onOrderTypeChange:function(e){var t=this;var a=e.getSource().getModel(t.oModelName).getData().Auart;if(a===""||a===undefined){e.getSource().getModel(t.oModelName).getData().Auart="";e.getSource().getModel(t.oModelName).getData().oTypeTxt=""}else{e.getSource().getModel(t.oModelName).getData().Auart=a.toUpperCase();o._changeOrderType(e.getSource().getModel(t.oModelName).getData(),t)}},notifTypeChange:function(e){var t=this;var a=e.getSource().getModel(t.oModelName).getData().Qmart;if(a===""||a===undefined){e.getSource().getModel(t.oModelName).getData().Qmart="";e.getSource().getModel(t.oModelName).getData().nTypeTxt=""}e.getSource().setValueState("None")},onNotifTypeChange:function(e){var t=this;var a=e.getSource().getModel(t.oModelName).getData().Qmart;if(a===""||a===undefined){e.getSource().getModel(t.oModelName).getData().Qmart="";e.getSource().getModel(t.oModelName).getData().nTypeTxt=""}else{e.getSource().getModel(t.oModelName).getData().Qmart=a.toUpperCase();o._changeNotifType(e,t)}},mainWcChange:function(e){var t=this;var a=e.getSource().getModel(t.oModelName).getData().ArbpMi;if(a===""||a===undefined){e.getSource().getModel(t.oModelName).getData().ArbpMi="";e.getSource().getModel(t.oModelName).getData().WergwMi=""}e.getSource().setValueState("None")},onMainWcChange:function(e){var t=this;var a=e.getSource().getModel(t.oModelName).getData().ArbpMi;if(a===""||a===undefined){e.getSource().getModel(t.oModelName).getData().ArbpMi="";e.getSource().getModel(t.oModelName).getData().WergwMi=""}else{e.getSource().setValue(a.toUpperCase());var r=false;if(sap.ui.getCore().getModel("AIWListWCModel")){var n=sap.ui.getCore().getModel("AIWListWCModel").getData();if(n.length>0){for(var i=0;i<n.length;i++){if(n[i].wc.toUpperCase()===a.toUpperCase()){e.getSource().setValue(a.toUpperCase());e.getSource().getModel(t.oModelName).getData().WergwMi=n[i].plant;r=true}}}}if(r===true){t.getView().getModel(t.oModelName).refresh();return}else{o._changeMpmiMainWc(e.getSource().getModel(t.oModelName).getData(),t)}}},onMainWcPlntChange:function(e){var t=this;var a=e.getSource().getModel(t.oModelName).getData().WergwMi;if(a===""||a===undefined){e.getSource().getModel(t.oModelName).getData().WergwMi=""}else{e.getSource().getModel(t.oModelName).getData().WergwMi=a.toUpperCase();o._changeMpmiMainWcPlnt(e.getSource().getModel(t.oModelName).getData(),t)}},equipmentChange:function(e){var t=this;var a=e.getSource().getModel(t.oModelName).getData().Equnr;if(a===""||a===undefined){e.getSource().getModel(t.oModelName).getData().Equnr="";e.getSource().getModel(t.oModelName).getData().Eqktx=""}e.getSource().setValueState("None")},onEquipmentChange:function(e){var t=this;var a=e.getSource().getModel(t.oModelName).getData().Equnr;if(a===""||a===undefined){e.getSource().getModel(t.oModelName).getData().Equnr="";e.getSource().getModel(t.oModelName).getData().Eqktx="";var r=t.getView().getModel(t.oModelName);var n=r.getData();n.enableLoc=true;n.SwerkMil="";n.SwerkMilVS="None";n.Name1="";n.StortMil="";n.StortMilVS="None";n.Locationdesc="";n.BeberMil="";n.BeberMillVS="None";n.MsgrpIl="";n.MsgrpIlVS="None";n.Fing="";n.ArbplIl="";n.ArbplIlVS="None";n.Workcenterdesc="";n.AbckzIl="";n.AbckzIlVS="None";n.Abctx="";n.EqfnrIl="";n.EqfnrIlVS="None";n.BukrsMil="";n.Butxt="";n.City="";n.BukrsMilVS="None";n.Anln1Mil="";n.Txt50="";n.Anln1MilVS="None";n.Anln2Mil="";n.Anln2MilVS="None";n.GsberIl="";n.Gtext="";n.GsberIlVS="None";n.KostlMil="";n.Contareaname="";n.KostlMilVS="None";n.KokrsMil="";n.Posid="";n.Post1="";n.PosidVS="None";n.AufnrIl="";n.SettleOrdDesc="";n.AufnrIlVS="None";r.setData(n)}else{e.getSource().setValue(a.toUpperCase());var i=false;if(sap.ui.getCore().getModel("AIWEQUI")){var s=sap.ui.getCore().getModel("AIWEQUI").getData();if(s.length>0){for(var l=0;l<s.length;l++){if(s[l].Equnr===a.toUpperCase()){e.getSource().setValue(a.toUpperCase());e.getSource().getModel(t.oModelName).getData().Eqktx=s[l].Eqktx;i=true}}}}var u=e.getSource().getModel(t.oModelName).getData().Tplnr;if(u!==""||u!==undefined){e.getSource().getModel(t.oModelName).getData().Tplnr="";e.getSource().getModel(t.oModelName).getData().Pltxt=""}if(i===true){t._itemViewData();t.fetchData(t.oModelName,parseInt(t.mainRowIndex),parseInt(t.itemPath));return}else{o._changeEquiment(e,t)}}},_itemViewData:function(){var e=this;var t=sap.ui.getCore().getModel("AIWMPMIDetail").getData();var a=t.itemModel;var r=parseInt(e.itemPath.substr(-1));var n=e.getView().getModel(e.oModelName).getData();a[r].Mitemnumb=n.Mitemnumb;a[r].Pstxt=n.Pstxt;a[r].Cycleseq=n.Cycleseq;a[r].Tplnr=n.Tplnr;a[r].Pltxt=n.Pltxt;a[r].Equnr=n.Equnr;a[r].Eqktx=n.Eqktx;a[r].AsmblyOb=n.AsmblyOb;a[r].Werks=n.Werks;a[r].Planningplantdes=n.Planningplantdes;a[r].Auart=n.Auart;a[r].oTypeTxt=n.oTypeTxt;a[r].Qmart=n.Qmart;a[r].nTypeTxt=n.nTypeTxt;a[r].ArbpMi=n.ArbpMi;a[r].WergwMi=n.WergwMi;a[r].Ingrp=n.Ingrp;a[r].Innam=n.Innam;if(e.strategy==="PERF"){t.Mpcycleno=e.refCounter;if(t.Szaeh===""){t.Szaeh=e.reading}var i=e.getView().getParent()._pageStack[0].id;sap.ui.getCore().byId(i).oController.counterUnit=e.refUnit}else if(e.strategy==="singlePerf"){if(t.Szaeh===""){t.Szaeh=e.reading}}sap.ui.getCore().getModel("AIWMPMIDetail").setProperty("/itemModel",a);sap.ui.getCore().getModel("AIWMPMI").getProperty("/"+r).itemModel=a},_changeEquiment:function(e,t){var a=e.Equnr;var r=a.replace(/^[ ]+|[ ]+$/g,"");if(r!==""){var n="/RefObjSet('"+a+"')";var i=t.getView().getModel();var o=function(n){if(n){e.Equnr=r;e.Eqktx=n.Equipdesc;e.Tplnr=n.Tplnrmi;e.Pltxt=n.Flocdesc;if(a!==""&&e.Tplnr===""){t.readPlantData(e,t)}else if(a!==""&&e.Tplnr!==""){t.readPlantData(e,t)}else if(a===""&&e.Tplnr!==""){t.readPlantData(e,t)}if(t.strategy==="PERF"||t.strategy==="singlePerf"){t.readCounter(e,t)}}else{e.Equnr="";e.Eqktx="";e.EqunrVS="Error";e.EqunrVST="Invalid Entry";t.getView().getModel(t.oModelName).refresh()}};var s=function(a){var r=JSON.parse(a.response.body);var n=r.error.message.value;e.EqunrVS="Error";e.EqunrVST=n;t.getView().getModel(t.oModelName).refresh()};t._readData(n,i,o,s)}else{e.Equnr=r;t.getView().getModel(t.oModelName).refresh()}},onAssemblyChange:function(e){var t=this;var a=e.getSource().getValue();if(a!==""||a!==undefined){e.getSource().setValue(a.toUpperCase());o._changeAssembly(e,t)}},_bindView:function(e){var t=this.getModel(this.oModelName),a=this.getModel();this.getView().bindElement({path:e,events:{change:this._onBindingChange.bind(this),dataRequested:function(){a.metadataLoaded().then(function(){t.setProperty("/busy",true)})},dataReceived:function(){t.setProperty("/busy",false)}}})},_onBindingChange:function(){var e=this.getView(),t=this.getModel(this.oModelName),a=e.getElementBinding();if(!a.getBoundContext()){this.getRouter().getTargets().display("objectNotFound");return}t.setProperty("/busy",false)},onDonePress:function(e){var t=e.getSource().getId();if(this.viewName!=="Approve"){if(this.oModelUpdateFlag){sap.ui.getCore().getModel("AIWMPMIStatus").getData().oModelUpdateFlag=true}var a=sap.ui.getCore().getModel("AIWMPMIDetail").getData();var r=a.itemModel;var n=parseInt(this.itemPath.substr(-1));var i=this.getView().getModel(this.oModelName).getData();r[n].Mitemnumb=i.Mitemnumb;r[n].Pstxt=i.Pstxt;r[n].Cycleseq=i.Cycleseq;r[n].Tplnr=i.Tplnr;r[n].Pltxt=i.Pltxt;r[n].Equnr=i.Equnr;r[n].Eqktx=i.Eqktx;r[n].AsmblyOb=i.AsmblyOb;r[n].Werks=i.Werks;r[n].Planningplantdes=i.Planningplantdes;r[n].Auart=i.Auart;r[n].oTypeTxt=i.oTypeTxt;r[n].Qmart=i.Qmart;r[n].nTypeTxt=i.nTypeTxt;r[n].ArbpMi=i.ArbpMi;r[n].WergwMi=i.WergwMi;r[n].Ingrp=i.Ingrp;r[n].Innam=i.Innam;r[n].PlntyMi=i.PlntyMi;r[n].PlnnrMi=i.PlnnrMi;r[n].PlnalMi=i.PlnalMi;r[n].LDVisible=this.lam.getVisible();if(this.strategy==="PERF"){a.Mpcycleno=this.refCounter;if(a.Szaeh===""){a.Szaeh=this.reading}var o=this.getView().getParent()._pageStack[0].id;sap.ui.getCore().byId(o).oController.counterUnit=this.refUnit}else if(this.strategy==="singlePerf"){if(a.Szaeh===""){a.Szaeh=this.reading}}sap.ui.getCore().getModel("AIWMPMIDetail").setProperty("/itemModel",r);var s=this.getView().getModel("ObjListItemModel");if(s){var l=s.getData();var u=true;for(var g=0;g<l.length;g++){if(l[g].Warpl===a.Warpl&&l[g].Mitemnumb===r[n].Mitemnumb&&(l[g].MatnrObjState==="Error"||l[g].EquiObjState==="Error"||l[g].FlocObjState==="Error"||l[g].AsmblyObState==="Error")){u=false;break}}if(!u){this.invokeMessage(this.OLIMessage);return}sap.ui.getCore().getModel("AIWMPMIDetail").setProperty("/ObjListItems",l)}if(t.indexOf("idBtnCheck")>-1){this.validateCheck();return}}window.history.go(-1)},validateCheck:function(){var e=this;var t=sap.ui.getCore().getModel("AIWMPMIDetail").getData();var a=sap.ui.getCore().getModel("AIWFLOC").getData();var n=sap.ui.getCore().getModel("AIWEQUI").getData();var i=sap.ui.getCore().getModel("AIWListWCModel").getData();var o=sap.ui.getCore().getModel("tempCrTypeModel").getData();var s={ChangeRequestType:o.crtype,CrDescription:o.desc,IsDraft:"C",Messages:[],FuncLoc:[],FLAddr:[],FLAddrI:[],FLLAM:[],FLClass:[],FLVal:[],Equipment:[],EqAddr:[],EqAddrI:[],EqPRT:[],EqLAM:[],EqClass:[],EqVal:[],MSPoint:[],MSLAM:[],MSClass:[],MSVal:[],MPLAN:[],MPItem:[],MPLAM:[],MPOBList:[],MPCycle:[],MRBHeader:[],MRBItem:[],MRBSBIT:[],EBHeader:[],EBItem:[],EBSBIT:[],FBHeader:[],FBItem:[],FBSBIT:[],WBHeader:[],WBItem:[],WBSBIT:[],ONetwork:[],ONLAM:[],Workcenter:[],WCCost:[],GTList:[],GTOprs:[],GTComp:[],GTClass:[],GTVal:[],ETList:[],ETOprs:[],ETComp:[],ETClass:[],ETVal:[],FTList:[],FTOprs:[],FTComp:[],FTClass:[],FTVal:[],Olink:[],OLClass:[],OLVal:[]};if(a.length>0){for(var l=0;l<a.length;l++){var u={Tplnr:a[l].Functionallocation,Txtmi:a[l].Flocdescription,TplkzFlc:a[l].Strucindicator,Tplxt:a[l].StrucIndicatorDesc,EditMask:a[l].EditMask,Hierarchy:a[l].Hierarchy,Fltyp:a[l].Floccategory,Flttx:a[l].FlocCategoryDesc,Swerk:a[l].Maintplant,Plantname:a[l].MaintplantDesc,StorFloc:a[l].Location,Locationdesc:a[l].Locationdesc,Abckzfloc:a[l].Abckz,Abctx:a[l].Abctx,Bukrsfloc:a[l].Bukrs,Butxt:a[l].Butxt,City:a[l].City,KostFloc:a[l].Kostl,KokrFloc:a[l].Kokrs,Contareaname:a[l].Mctxt,PlntFloc:a[l].Werks,Planningplantdes:a[l].Planningplantdes,Ingrp:a[l].Ingrp,Plannergrpdesc:a[l].Innam,Arbplfloc:a[l].Arbpl,Wergwfloc:a[l].WcWerks,Gewrkfloc:a[l].MainArbpl,MainWcPlant:a[l].MainWerks,Tplma:a[l].SupFunctionallocation,Supflocdesc:a[l].SupFlocdescription,BeberFl:a[l].BeberFl,Fing:a[l].Fing,Tele:a[l].Tele,Submtiflo:a[l].ConstrType,Constdesc:a[l].ConstructionDesc,Eqart:a[l].TechnicalObjectTyp,Eartx:a[l].Description,Stattext:a[l].Stattext,StsmFloc:a[l].StsmEqui,Statproftxt:a[l].StsmEquiDesc,UstwFloc:a[l].UstwEqui,UswoFloc:a[l].UswoEqui,UstaFloc:a[l].UstaEqui,Adrnri:a[l].Adrnri,Deact:a[l].Deact};s.FuncLoc.push(u);var g={Funcloc:a[l].Functionallocation,Title:a[l].TitleCode,Name1:a[l].Name1,Name2:a[l].Name2,Name3:a[l].Name3,Name4:a[l].Name4,Sort1:a[l].Sort1,Sort2:a[l].Sort2,NameCo:a[l].NameCo,PostCod1:a[l].PostCod1,City1:a[l].City1,Building:a[l].Building,Floor:a[l].Floor,Roomnum:a[l].Roomnum,Strsuppl1:a[l].Strsuppl1,Strsuppl2:a[l].Strsuppl2,Strsuppl3:a[l].Strsuppl3,Location:a[l].AddrLocation,RPostafl:a[l].RefPosta,Landx:a[l].Landx,TimeZone:a[l].TimeZone,RPostFl:a[l].Region,Regiotxt:a[l].RegionDesc};s.FLAddr.push(g);var d=a[l].intlAddr;if(d){for(var p=0;p<d.length;p++){s.FLAddrI.push(d[p])}}if(e.AltLblDerv==="2"&&a[l].altlbl){for(var c=0;c<a[l].altlbl.length;c++){var m={Funcloc:a[l].Functionallocation,AltAlkey:a[l].altlbl[c].AltAlkey,AltStrno:a[l].altlbl[c].AltStrno,AltTplkz:a[l].altlbl[c].AltTplkz};s.FLALTLBEL.push(m)}}if(a[l].Floccategory==="L"&&a[l].lam){var M={Funcloc:a[l].Functionallocation,Lrpid:a[l].lam.Lrpid,Strtptatr:a[l].lam.Strtptatr,Endptatr:a[l].lam.Endptatr,Length:a[l].lam.Length,LinUnit:a[l].lam.LinUnit,Startmrkr:a[l].lam.Startmrkr,Endmrkr:a[l].lam.Endmrkr,Mrkdisst:a[l].lam.Mrkdisst,Mrkdisend:a[l].lam.Mrkdisend,MrkrUnit:a[l].lam.MrkrUnit};s.FLLAM.push(M)}var f=a[l].classItems;if(f){if(f.length>0){for(var h=0;h<f.length;h++){var S={Funcloc:a[l].Functionallocation,Classtype:f[h].Classtype,Class:f[h].Class,Clstatus1:f[h].Clstatus1};s.FLClass.push(S)}}}var b=a[l].characteristics;if(b){if(b.length>0){for(var v=0;v<b.length;v++){var E={Funcloc:a[l].Functionallocation,Atnam:b[v].Atnam,Textbez:b[v].Textbez,Atwrt:b[v].Atwrt,Class:b[v].Class};s.FLVal.push(E)}}}}}if(n.length>0){for(var P=0;P<n.length;P++){var C={Herst:n[P].Herst,Equnr:n[P].Equnr,Txtmi:n[P].Eqktx,Swerk:n[P].Maintplant,Name1:n[P].MaintplantDesc,TplnEilo:n[P].Tplnr,Flocdescription:n[P].Pltxt,Eqtyp:n[P].EquipmentCatogory,Etytx:n[P].EquipCatgDescription,Eqart:n[P].TechnicalObjectTyp,Eartx:n[P].Description,Typbz:n[P].Typbz,SubmEeqz:n[P].ConstrType,Constdesc:n[P].ConstructionDesc,BukrEilo:n[P].Bukrs,Butxt:n[P].Butxt,HequEeqz:n[P].SuperordinateEquip,SuperordEqDes:n[P].SuperordinateEquipDesc,TidnEeqz:n[P].TechIdNum,KostEilo:n[P].Kostl,KokrEilo:n[P].Kokrs,Contareaname:n[P].Mctxt,StorEilo:n[P].Location,Locationdesc:n[P].Locationdesc,AbckEilo:n[P].Abckz,Abctx:n[P].Abctx,PplaEeqz:n[P].Werks,Planningplantdes:n[P].Planningplantdes,IngrEeqz:n[P].Ingrp,Plannergrpdesc:n[P].Innam,Serge:n[P].Serge,MapaEeqz:n[P].MapaEeqz,Stattext:n[P].Stattext,StsmEqui:n[P].StsmEqui,Statproftxt:n[P].StsmEquiDesc,UstwEqui:n[P].UstwEqui,UswoEqui:n[P].UswoEqui,UstaEqui:n[P].UstaEqui,Deact:n[P].Deact,Answt:n[P].Answt,Ansdt:e._formatDate(n[P].Ansdt),Waers:n[P].Waers,ArbpEilo:n[P].Arbpl,WorkCenterPlant:n[P].WcWerks,ArbpEeqz:n[P].MainArbpl,MainWcPlant:n[P].MainWerks,BebeEilo:n[P].BeberFl,Fing:n[P].Fing,Tele:n[P].Tele,HeqnEeqz:n[P].EquipPosition,Adrnri:n[P].Adrnri,Funcid:n[P].Funcid,Frcfit:n[P].Frcfit,Frcrmv:n[P].Frcrmv};s.Equipment.push(C);var I={Equi:n[P].Equnr,PlanvPrt:n[P].PlanvPrt,SteufPrt:n[P].SteufPrt,KtschPrt:n[P].KtschPrt,Ewformprt:n[P].Ewformprt,SteufRef:n[P].SteufRef,KtschRef:n[P].KtschRef,EwformRef:n[P].EwformRef};s.EqPRT.push(I);if(n[P].EquipmentCatogory==="L"&&n[P].lam){var T={Equi:n[P].Equnr,Lrpid:n[P].lam.Lrpid,Strtptatr:n[P].lam.Strtptatr,Endptatr:n[P].lam.Endptatr,Length:n[P].lam.Length,LinUnit:n[P].lam.LinUnit,Startmrkr:n[P].lam.Startmrkr,Endmrkr:n[P].lam.Endmrkr,Mrkdisst:n[P].lam.Mrkdisst,Mrkdisend:n[P].lam.Mrkdisend,MrkrUnit:n[P].lam.MrkrUnit};s.EqLAM.push(T)}var O={Equi:n[P].Equnr,Title:n[P].TitleCode,Name1:n[P].Name1,Name2:n[P].Name2,Name3:n[P].Name3,Name4:n[P].Name4,Sort1:n[P].Sort1,Sort2:n[P].Sort2,NameCo:n[P].NameCo,PostCod1:n[P].PostCod1,City1:n[P].City1,Building:n[P].Building,Floor:n[P].Floor,Roomnum:n[P].Roomnum,Strsuppl1:n[P].Strsuppl1,Strsuppl2:n[P].Strsuppl2,Strsuppl3:n[P].Strsuppl3,Location:n[P].AddrLocation,RefPosta:n[P].RefPosta,Landx:n[P].Landx,TimeZone:n[P].TimeZone,RfePost:n[P].Region,Regiotxt:n[P].RegionDesc};s.EqAddr.push(O);var A=n[P].intlAddr;if(A){for(var p=0;p<A.length;p++){s.EqAddrI.push(A[p])}}var x=n[P].classItems;if(x){if(x.length>0){for(var y=0;y<x.length;y++){var w={Equi:n[P].Equnr,Classtype:x[y].Classtype,Class:x[y].Class,Clstatus1:x[y].Clstatus1};s.EqClass.push(w)}}}var q=n[P].characteristics;if(q){if(q.length>0){for(var D=0;D<q.length;D++){var V={Equi:n[P].Equnr,Atnam:q[D].Atnam,Textbez:q[D].Textbez,Atwrt:q[D].Atwrt,Class:q[D].Class};s.EqVal.push(V)}}}}}if(i.length>0){for(var L=0;L<i.length;L++){var N={Werks:i[L].plant,Arbpl:i[L].wc,Txtmi:i[L].wcDesc,Verwe:i[L].wcCat,Crveran:i[L].person,Planv:i[L].usg,Vgwts:i[L].stdVal,Crsteus:i[L].ctrlKey};if(i[L].hasOwnProperty("Type")){if(i[L].Type==="X"){N.Type="X"}}s.Workcenter.push(N);if(i[L].cost){for(var F=0;F<i[L].cost.length;F++){var k={Werks:i[L].cost[F].CrKokrs,Arbpl:i[L].wc,CrKostl:i[L].cost[F].CrKostl,Costcentxt:i[L].cost[F].Costcentxt,CrLstar:i[L].cost[F].CrLstar,Forn1:i[L].cost[F].Forn1,ActvttypeTxt:i[L].cost[F].ActvttypeTxt,Frmltxt:i[L].cost[F].Frmltxt};s.WCCost.push(k)}}}}var j={Warpl:t.Warpl,Abrho:t.Abrho,Hunit:t.Hunit,Mptyp:t.Mptyp,Wptxt:t.Wptxt,Stich:t.Stich.toString(),Fabkl:t.Fabkl,FabklDesc:t.FabklDesc,Sfakt:t.Sfakt,Andor:e.parseValue(t.Andor),Mehrfach:e.parseValue(t.Mehrfach),Strat:t.Strat,StratDesc:t.StratDesc,Wset:t.Wset,Startdate:e._formatDate(t.Stadt),Unitc:t.Unitc,Szaeh:t.Szaeh,PointStp:t.Mpcycleno,Vspos:t.Vspos,Topos:t.Topos,Vsneg:t.Vsneg,Toneg:t.Toneg,Horiz:t.Horiz,CallConf:t.CallConf,PlanSort:t.PlanSort,Begru:t.Begru,InactMp:t.Deact};s.MPLAN.push(j);var W=t.itemModel;if(W){for(var B=0;B<W.length;B++){var U={Mplan:t.Warpl,Qmart:W[B].Qmart,Qmartx:W[B].nTypeTxt,PlntMi:W[B].Werks,Planningplantdes:W[B].Planningplantdes,IngrpMi:W[B].Ingrp,Plannergrpdesc:W[B].Innam,Pstxt:W[B].Pstxt,WergwMi:W[B].WergwMi,ArbpMi:W[B].ArbpMi,Auart:W[B].Auart,Ordertypedesc:W[B].oTypeTxt,Bautl:W[B].AsmblyOb,Cycleseq:W[B].Cycleseq,Equnr:W[B].Equnr,Equipdesc:W[B].Eqktx,TplnrMi:W[B].Tplnr,Flocdesc:W[B].Pltxt,Mitemnumb:W[B].Mitemnumb,PlnnrMi:W[B].PlnnrMi,PlntyMi:W[B].PlntyMi,PlnalMi:W[B].PlnalMi,SwerkMil:W[B].SwerkMil,StortMil:W[B].StortMil,MsgrpIl:W[B].MsgrpIl,BeberMil:W[B].BeberMil,Fing:W[B].Fing,ArbplIl:W[B].ArbplIl,AbckzIl:W[B].AbckzIl,EqfnrIl:W[B].EqfnrIl,BukrsMil:W[B].BukrsMil,Butxt:W[B].Butxt,City:W[B].City,Anln1Mil:W[B].Anln1Mil,Anln2Mil:W[B].Anln2Mil,GsberIl:W[B].GsberIl,KostlMil:W[B].KostlMil,KokrsMil:W[B].KokrsMil,Posid:W[B].Posid,AufnrIl:W[B].AufnrIl};s.MPItem.push(U);if(W[B].lam){var H={Mplan:t.Warpl,Mitemnumb:W[B].lam.Mitemnumb,Lrpid:W[B].lam.Lrpid,Strtptatr:W[B].lam.Strtptatr,Endptatr:W[B].lam.Endptatr,Length:W[B].lam.Length,LinUnit:W[B].lam.LinUnit,Startmrkr:W[B].lam.Startmrkr,Endmrkr:W[B].lam.Endmrkr,Mrkdisst:W[B].lam.Mrkdisst,Mrkdisend:W[B].lam.Mrkdisend,MrkrUnit:W[B].lam.MrkrUnit};s.MPLAM.push(H)}}}var R=t.cycleModel;if(R){for(var z=0;z<R.length;z++){var _={Mplan:t.Warpl,Point:R[z].Point,PointTxt:R[z].Psort,Offset:R[z].Offset,Ofsetunit:R[z].Ofsetunit,PakText:R[z].PakText,Zeieh:R[z].Zeieh,Zykl1:R[z].Zykl1,Cycleseqi:R[z].Cycleseqi,Mpcycleno:R[z].Mpcycleno};s.MPCycle.push(_)}}var Q=t.ObjListItems;if(W){for(var p=0;p<Q.length;p++){var K={AsmblyOb:Q[p].AsmblyOb,EquiObj:Q[p].EquiObj,FlocObj:Q[p].FlocObj,MatnrObj:Q[p].MatnrObj,Mitemnumb:Q[p].Mitemnumb,Mplan:Q[p].Warpl};s.MPOBList.push(K)}}if(s.FLAddrI.length>0){s.FLAddrI=$.map(s.FLAddrI,function(e){return $.extend(true,{},e)});for(var L=0;L<s.FLAddrI.length>0;L++){delete s.FLAddrI[L].AdNationEnable;delete s.FLAddrI[L].City1iVS;delete s.FLAddrI[L].StreetiVS}}if(s.EqAddrI.length>0){s.EqAddrI=$.map(s.EqAddrI,function(e){return $.extend(true,{},e)});for(var L=0;L<s.EqAddrI.length>0;L++){delete s.EqAddrI[L].AdNationEnable;delete s.EqAddrI[L].City1iVS;delete s.EqAddrI[L].StreetiVS}}this.getView().byId("itemDetailPage").setBusy(true);var G=this.getView().getModel();G.create("/ChangeRequestSet",s,{success:function(t){e.getView().byId("itemDetailPage").setBusy(false);var a=t;var n=[];for(var i=0;i<a.Messages.results.length;i++){n.push({type:r.getMessageType(a.Messages.results[i].Type),title:a.Messages.results[i].Message})}e.createMessagePopover(n,"")},error:function(t){e.getView().byId("itemDetailPage").setBusy(false);var a=[],r=[];if(JSON.parse(t.responseText).error.innererror.errordetails===undefined||JSON.parse(t.responseText).error.innererror.errordetails.length===0){a[0]=JSON.parse(t.responseText).error.message.value}else{for(var n=0;n<JSON.parse(t.responseText).error.innererror.errordetails.length;n++){a[n]=JSON.parse(t.responseText).error.innererror.errordetails[n].message}}var i=a.join("\n");sap.m.MessageBox.show(i,{title:"Error",icon:sap.m.MessageBox.Icon.ERROR,onClose:function(){}})}})},onObjListItmRowSelect:function(e){var t=this;var a=e.getSource().getSelectedItems().length;if(a>0){this.getView().byId("idObjListItmDelete").setEnabled(true)}else{this.getView().byId("idObjListItmDelete").setEnabled(false)}},onTLTypeChange:function(e){var t=this;var a=e.getSource().getValue();e.getSource().setValue(a.toUpperCase());o._changeTLType(e,t)},onTLGroupChange:function(e){var t=this;var a=e.getSource().getValue();e.getSource().setValue(a.toUpperCase());o._changeTLGroup(e,t)},onTLCounterChange:function(e){var t=this;var a=e.getSource().getValue();e.getSource().setValue(a.toUpperCase());o._changeTLCounter(e,t)},addObjListItmRow:function(){var e=sap.ui.getCore().getModel("AIWMPMIDetail").getData();var t=this.getView().getModel(this.oModelName).getData();var a={Mitemnumb:t.Mitemnumb,Warpl:e.Warpl,UiiObj:"",SernrObj:"",MatnrObj:"",Matnrtxt:"",EquiObj:"",Equnrtxt:"",FlocObj:"",Tplnrtxt:"",AsmblyOb:"",Bautltxt:"",Enable:true};var r=this.getView().getModel("ObjListItemModel");var n=r.getData();n.push(a);r.setData(n)},onOLIMaterialVH:function(e){var t=this;var a=this.getView();var r=e.getSource().getParent().getBindingContextPath();r=parseInt(r.split("/")[1]);var n=e.getSource().getBindingInfo("value").binding.sPath;var i=this.getView().getModel("ObjListItemModel");var o=i.getData();var l={title:this.getView().getModel("i18n").getProperty("MATERIAL"),noDataText:this.getView().getModel("i18n").getProperty("LOAD")+"...",items:{path:"/MaterialSHSet",template:new sap.m.StandardListItem({title:"{Matnr}",description:"{Maktx}"})},confirm:function(e){if(n==="MatnrObj"){o[r].MatnrObj=e.getParameters().selectedItem.getProperty("title");o[r].Matnrtxt=e.getParameters().selectedItem.getProperty("description");o[r].MatnrObjState="None";o[r].Enable=false;i.setData(o)}else if(n==="AsmblyOb"){o[r].AsmblyOb=e.getParameters().selectedItem.getProperty("title");o[r].Bautltxt=e.getParameters().selectedItem.getProperty("description");o[r].AsmblyObState="None";o[r].Enable=false;i.setData(o);t.validateOLI(r,n)}}};var u="/MaterialSHSet";var g=this.getView().getModel("valueHelp");var d=s.getSelectDialog(g,u,[],l,"Matnr","Maktx");d.open();d.setModel(a.getModel("i18n"),"i18n")},onOLIEquipmentVH:function(e){var t=this;var a=this.getView();var r=e.getSource().getBindingInfo("value").binding.sPath;var n=e.getSource().getParent().getBindingContextPath();n=parseInt(n.split("/")[1]);var i=this.getView().getModel("ObjListItemModel");var o=i.getData();var s=new sap.m.SelectDialog({title:this.getView().getModel("i18n").getProperty("EQUI"),noDataText:this.getView().getModel("i18n").getProperty("LOAD")+"...",items:{path:"/EquipmentNumberSet",template:new sap.m.StandardListItem({title:"{Equnr}",description:"{Eqktx}"})},confirm:function(e){o[n].EquiObj=e.getParameters().selectedItem.getProperty("title");o[n].Equnrtxt=e.getParameters().selectedItem.getProperty("description");o[n].EquiObjState="None";o[n].Enable=false;i.setData(o);var a=sap.ui.getCore().getModel("AIWEQUI").getData();var s=false;for(var l=0;l<a.length;l++){if(a[l].Equnr===o[n].EquiObj){s=true;break}}if(s){t.fetchStagingData(n,r)}else{t.deriveObjectListData(n,r)}},search:function(e){var t=e.getParameter("value");e.getSource().getBinding("items").filter(!t?[]:[new sap.ui.model.Filter([new sap.ui.model.Filter("Equnr",sap.ui.model.FilterOperator.Contains,t),new sap.ui.model.Filter("Eqktx",sap.ui.model.FilterOperator.Contains,t)],false)])}});var l="/EquipmentNumberSet";var u=this.getView().getModel("valueHelp");var g=function(e){var a=sap.ui.getCore().getModel("AIWEQUI").getData();if(a.length>0){for(var r=0;r<a.length;r++){var n={Equnr:a[r].Equnr,Eqktx:a[r].Eqktx};e.results.unshift(n)}}if(e.results.length>0){var i=new sap.m.StandardListItem({title:"{Equnr}",description:"{Eqktx}",active:true});var o=new sap.ui.model.json.JSONModel;o.setData(e);s.setModel(o);s.bindAggregation("items","/results",i)}else{s.setNoDataText(t.getView().getModel("i18n").getProperty("NO_DATA"))}};var d=function(){};u.read(l,{success:g,error:d});s.open();s.setModel(a.getModel("i18n"),"i18n")},onOLIFlocVH:function(e){var t=this;var a=this.getView();var r=e.getSource().getBindingInfo("value").binding.sPath;var n=e.getSource().getParent().getBindingContextPath();n=parseInt(n.split("/")[1]);var i=this.getView().getModel("ObjListItemModel");var o=i.getData();var s=new sap.m.SelectDialog({title:this.getView().getModel("i18n").getProperty("FLOC_TXT"),noDataText:this.getView().getModel("i18n").getProperty("LOAD")+"...",items:{path:"/FunctionLocationSet",template:new sap.m.StandardListItem({title:"{Tplnr}",description:"{Pltxt}"})},confirm:function(e){o[n].FlocObj=e.getParameters().selectedItem.getProperty("title");o[n].Tplnrtxt=e.getParameters().selectedItem.getProperty("description");o[n].FlocObjState="None";o[n].Enable=false;i.setData(o);var a=sap.ui.getCore().getModel("AIWFLOC").getData();var s=false;for(var l=0;l<a.length;l++){if(a[l].Functionallocation===o[n].FlocObj){s=true;break}}if(s){t.fetchStagingData(n,r)}else{t.deriveObjectListData(n,r)}},search:function(e){var t=e.getParameter("value");e.getSource().getBinding("items").filter(!t?[]:[new sap.ui.model.Filter([new sap.ui.model.Filter("Tplnr",sap.ui.model.FilterOperator.Contains,t),new sap.ui.model.Filter("Pltxt",sap.ui.model.FilterOperator.Contains,t)],false)])}});var l="/FunctionLocationSet";var u=this.getView().getModel("valueHelp");var g=function(e){var a=sap.ui.getCore().getModel("AIWFLOC").getData();if(a.length>0){for(var r=0;r<a.length;r++){var n={Tplnr:a[r].Functionallocation,Pltxt:a[r].Flocdescription};e.results.unshift(n)}}if(e.results.length>0){var i=new sap.m.StandardListItem({title:"{Tplnr}",description:"{Pltxt}",active:true});var o=new sap.ui.model.json.JSONModel;o.setData(e);s.setModel(o);s.bindAggregation("items","/results",i)}else{s.setNoDataText(t.getView().getModel("i18n").getProperty("NO_DATA"))}};var d=function(){};u.read(l,{success:g,error:d});s.open();s.setModel(a.getModel("i18n"),"i18n")},onOLIUIIVH:function(e){var t=this;var a=t.getView().getModel("valueHelp2");var r=e.getSource().getParent().getBindingContextPath();r=parseInt(r.split("/")[1]);var n=e.getSource().getBindingInfo("value").binding.sPath;var i=this.getView().getModel("ObjListItemModel");var o=i.getData();var l={title:"UII",noDataText:"{i18n>LOAD}"+"...",columns:[new sap.m.Column({header:[new sap.m.Text({text:"UII"})]}),new sap.m.Column({demandPopin:true,minScreenWidth:"Tablet",header:[new sap.m.Text({text:"Material"})]}),new sap.m.Column({demandPopin:true,minScreenWidth:"Tablet",header:[new sap.m.Text({text:"Serial Number"})]}),new sap.m.Column({demandPopin:true,minScreenWidth:"Tablet",header:[new sap.m.Text({text:"Equipement"})]}),new sap.m.Column({demandPopin:true,minScreenWidth:"Tablet",header:[new sap.m.Text({text:"Equi. Desc."})]}),new sap.m.Column({demandPopin:true,minScreenWidth:"Tablet",header:[new sap.m.Text({text:"UII Plant"})]})],items:{path:"/UIIVHSet",template:new sap.m.ColumnListItem({type:"Active",unread:false,cells:[new sap.m.Text({text:"{Uii}"}),new sap.m.Text({text:"{Matnr}"}),new sap.m.Text({text:"{Sernr}"}),new sap.m.Text({text:"{Equnr}"}),new sap.m.Text({text:"{Eqktu}"}),new sap.m.Text({text:"{UiiPlant}"})]})},confirm:function(e){o[r].UiiObj=e.getParameter("selectedItem").getCells()[0].getText();o[r].UiiObjState="None";o[r].Enable=false;i.setData(o);t.deriveObjectListData(r,n)}};var u="/UIIVHSet";var g=[];var d=[new sap.m.Text({text:"{Uii}"}),new sap.m.Text({text:"{Matnr}"}),new sap.m.Text({text:"{Sernr}"}),new sap.m.Text({text:"{Equnr}"}),new sap.m.Text({text:"{Eqktu}"}),new sap.m.Text({text:"{UiiPlant}"})];var p=s.getValueHelp(a,u,d,g,l,"Uii","Matnr");p.open();p.setModel(t.getView().getModel("i18n"),"i18n")},onOLISerNumVH:function(e){var t=this;var a=t.getView().getModel("valueHelp2");var r=e.getSource().getParent().getBindingContextPath();r=parseInt(r.split("/")[1]);var n=e.getSource().getBindingInfo("value").binding.sPath;var i=this.getView().getModel("ObjListItemModel");var o=i.getData();var l={title:"Serial Number",noDataText:"{i18n>LOAD}"+"...",columns:[new sap.m.Column({header:[new sap.m.Text({text:"Serial Number"})]}),new sap.m.Column({demandPopin:true,minScreenWidth:"Tablet",header:[new sap.m.Text({text:"Material"})]}),new sap.m.Column({demandPopin:true,minScreenWidth:"Tablet",header:[new sap.m.Text({text:"UII"})]})],items:{path:"/EqsnsSet",template:new sap.m.ColumnListItem({type:"Active",unread:false,cells:[new sap.m.Text({text:"{Sernr}"}),new sap.m.Text({text:"{Matnr}"}),new sap.m.Text({text:"{Uii}"})]})},confirm:function(e){o[r].SernrObj=e.getParameter("selectedItem").getCells()[0].getText();o[r].SernrObjState="None";o[r].Enable=false;i.setData(o);t.deriveObjectListData(r,n)}};var u="/EqsnsSet";var g=[];var d=[new sap.m.Text({text:"{Sernr}"}),new sap.m.Text({text:"{Matnr}"}),new sap.m.Text({text:"{Uii}"})];var p=s.getValueHelp(a,u,d,g,l,"Sernr","Matnr");p.open();p.setModel(t.getView().getModel("i18n"),"i18n")},onObjListItmChange:function(e){var t=this;var a=e.getParameters().newValue;var r=e.getSource().getBindingInfo("value").binding.sPath;var n=e.getSource().getParent().getBindingContextPath();var i=parseInt(n.split("/")[1]);switch(r){case"MatnrObj":t.onOLIMaterialChange(i,a,r);break;case"EquiObj":t.onOLIEquipmentChange(i,a,r);break;case"FlocObj":t.onOLIFlocChange(i,a,r);break;case"AsmblyOb":t.onOLIMaterialChange(i,a,r);break;case"UiiObj":t.onOLIUIIChange(i,a,r);break;case"SernrObj":t.onOLISerNumChange(i,a,r);break}},onOLIMaterialChange:function(e,t,a){var r=this;var n="/MaterialSHSet";var i=t.toUpperCase();var o=new sap.ui.model.Filter("Matnr","EQ",i);var s=this.getView().getModel("valueHelp");var l=this.getView().getModel("ObjListItemModel");var u=l.getData();s.read(n,{filters:[o],success:function(t,n){if(t.results.length>0){if(a==="MatnrObj"){u[e].MatnrObjState="None";u[e].MatnrObj=i;u[e].Matnrtxt=t.results[0].Maktx;u[e].Enable=false;r.deriveObjectListData(e,a)}else if(a==="AsmblyOb"){u[e].AsmblyObState="None";u[e].AsmblyOb=i;u[e].Bautltxt=t.results[0].Maktx;u[e].Enable=false;r.validateOLI(e,a)}l.setData(u)}else{if(a==="MatnrObj"){u[e].MatnrObjState="Error"}else if(a==="AsmblyOb"){u[e].AsmblyObState="Error"}l.setData(u)}},error:function(){if(a==="MatnrObj"){u[e].MatnrObjState="Error"}else if(a==="AsmblyOb"){u[e].AsmblyObState="Error"}l.setData(u)}})},onOLIEquipmentChange:function(e,t,a){var r=this;var n=t.toUpperCase();var i=this.getView().getModel("ObjListItemModel");var o=i.getData();var s=sap.ui.getCore().getModel("AIWEQUI").getData();var l=false;for(var u=0;u<s.length;u++){if(s[u].Equnr===n){l=true;break}}if(l){r.fetchStagingData(e,a)}else{var g="/EquipmentNumberSet";var d=new sap.ui.model.Filter("Equnr","EQ",n);var p=this.getView().getModel("valueHelp");p.read(g,{filters:[d],success:function(t,s){if(t.results.length>0){o[e].EquiObjState="None";o[e].EquiObj=n;o[e].Equnrtxt=t.results[0].Eqktx;o[e].Enable=false;i.setData(o);r.deriveObjectListData(e,a)}else{o[e].EquiObjState="Error";i.setData(o)}},error:function(){o[e].EquiObjState="Error";i.setData(o)}})}},onOLIFlocChange:function(e,t,a){var r=this;var n=t.toUpperCase();var i=this.getView().getModel("ObjListItemModel");var o=i.getData();var s=sap.ui.getCore().getModel("AIWFLOC").getData();var l=false;for(var u=0;u<s.length;u++){if(s[u].Functionallocation===n){l=true;break}}if(l){r.fetchStagingData(e,a)}else{var g="/FunctionLocationSet";var d=new sap.ui.model.Filter("Tplnr","EQ",n);var p=this.getView().getModel("valueHelp");p.read(g,{filters:[d],success:function(t,s){if(t.results.length>0){o[e].FlocObjState="None";o[e].FlocObj=n;o[e].Tplnrtxt=t.results[0].Pltxt;o[e].Enable=false;i.setData(o);r.deriveObjectListData(e,a)}else{o[e].FlocObjState="Error";i.setData(o)}},error:function(){o[e].FlocObjState="Error";i.setData(o)}})}},onOLIUIIChange:function(e,t,a){var r=this;var n=t.toUpperCase();var i=this.getView().getModel("ObjListItemModel");var o=i.getData();var s="/UIIVHSet";var l=new sap.ui.model.Filter("Uii","EQ",n);var u=this.getView().getModel("valueHelp2");u.read(s,{filters:[l],success:function(t,n){if(t.results.length>0){o[e].UiiObj=t.results[0].Uii;o[e].UiiObjState="None";o[e].Enable=false;i.setData(o);r.deriveObjectListData(e,a)}else{o[e].UiiObjState="Error";i.setData(o)}},error:function(){o[e].UiiObjState="Error";i.setData(o)}})},onOLISerNumChange:function(e,t,a){var r=this;var n=t.toUpperCase();var i=this.getView().getModel("ObjListItemModel");var o=i.getData();var s="/EqsnsSet";var l=new sap.ui.model.Filter("Sernr","EQ",n);var u=this.getView().getModel("valueHelp2");u.read(s,{filters:[l],success:function(t,n){if(t.results.length>0){o[e].SernrObj=t.results[0].Sernr;o[e].SernrObjState="None";o[e].Enable=false;i.setData(o);r.deriveObjectListData(e,a)}else{o[e].SernrObjState="Error";i.setData(o)}},error:function(){o[e].SernrObjState="Error";i.setData(o)}})},deriveObjectListData:function(e,t){var a=this;var r=this.getView().getModel("ObjListItemModel");var n=r.getData();var i="/MPOBListSet(EquiObj='"+n[e].EquiObj+"',FlocObj='"+n[e].FlocObj+"',MatnrObj='"+n[e].MatnrObj+"',SernrObj='"+n[e].SernrObj+"',UiiObj='"+n[e].UiiObj+"',AsmblyOb='"+n[e].AsmblyOb+"')";var o=this.getView().getModel();o.read(i,{success:function(i,o){n[e].UiiObj=i.UiiObj;n[e].SernrObj=i.SernrObj;n[e].EquiObj=i.EquiObj;n[e].FlocObj=i.FlocObj;n[e].MatnrObj=i.MatnrObj;n[e].AsmblyOb=i.AsmblyOb;n[e].Equnrtxt=i.Equnrtxt;n[e].Matnrtxt=i.Matnrtxt;n[e].Tplnrtxt=i.Tplnrtxt;r.setData(n);a.validateOLI(e,t)},error:function(e){}})},validateOLI:function(e,t){var a=this;var r=this.getView().getModel("ObjListItemModel");var n=r.getData();for(var i=0;i<n.length;i++){if(i!==e&&n[i].Mitemnumb===n[e].Mitemnumb){if(n[i].MatnrObj===n[e].MatnrObj&&n[i].EquiObj===n[e].EquiObj&&n[i].FlocObj===n[e].FlocObj&&n[i].AsmblyOb===n[e].AsmblyOb){if(t==="MatnrObj"){n[e].MatnrObjState="Error";a.OLIMessage="Material "+n[e].MatnrObj+" is already in Object List";a.invokeMessage("Material "+n[e].MatnrObj+" is already in Object List");break}else if(t==="EquiObj"){n[e].EquiObjState="Error";a.OLIMessage="Equipment "+n[e].EquiObj+" is already in Object List";a.invokeMessage("Equipment "+n[e].EquiObj+" is already in Object List");break}else if(t==="FlocObj"){n[e].FlocObjState="Error";a.OLIMessage="Functional Location "+n[e].FlocObj+" is already in Object List";a.invokeMessage("Functional Location "+n[e].FlocObj+" is already in Object List");break}else if(t==="AsmblyOb"){n[e].AsmblyObState="Error";a.OLIMessage="Assembly "+n[e].AsmblyOb+" is already in Object List";a.invokeMessage("Assembly "+n[e].AsmblyOb+" is already in Object List");break}else if(t==="UiiObj"){n[e].UiiObjState="Error";a.OLIMessage="UII "+n[e].UiiObj+" is already in Object List";a.invokeMessage("UII "+n[e].UiiObj+" is already in Object List");break}else if(t==="SernrObj"){n[e].SernrObjState="Error";a.OLIMessage="Serial Number "+n[e].SernrObj+" is already in Object List";a.invokeMessage("Serial Number "+n[e].SernrObj+" is already in Object List");break}}}}r.setData(n)},deleteObjListItmRow:function(){var e=this.getView().byId("idObjectListItem");var t=e.getModel("ObjListItemModel");var a=t.getData();var r=e.getSelectedContextPaths();var n=[];for(var i=0;i<r.length;i++){n.push(parseInt(r[i].split("/")[1]))}n.sort();var o;for(var s=n.length-1;s>=0;s--){o=n[s];a.splice(o,1)}e.removeSelections();t.setData(a);this.getView().byId("idObjListItmDelete").setEnabled(false)},fetchStagingData:function(e,t){var a=this;var r="/ChangeRequestSet";var n=a.getView().getModel();var i={ChangeRequestType:"AIWEAM0P",CrDescription:"",Reason:"01",DeriveData:true,FuncLoc:[],FLAddr:[],FLClass:[],FLVal:[],Equipment:[],EqPRT:[],EqAddr:[],EqClass:[],EqVal:[],MSPoint:[],MSClass:[],MSVal:[],MPLAN:[],MPItem:[],MPOBList:[],MPCycle:[],MRBHeader:[],MRBItem:[],MRBSBIT:[],EBHeader:[],EBItem:[],EBSBIT:[],FBHeader:[],FBItem:[],FBSBIT:[],WBHeader:[],WBItem:[],WBSBIT:[],ONetwork:[],ONLAM:[],Workcenter:[],WCCost:[],GTList:[],GTOprs:[],GTComp:[],GTClass:[],GTVal:[],ETList:[],ETOprs:[],ETComp:[],ETClass:[],ETVal:[],FTList:[],FTOprs:[],FTComp:[],FTClass:[],FTVal:[],Olink:[],OLClass:[],OLVal:[]};var o=sap.ui.getCore().getModel("AIWEQUI").getData();var s=sap.ui.getCore().getModel("AIWFLOC").getData();var l;if(a.viewName==="ChangeMpmi"){l=[sap.ui.getCore().getModel("AIWMPMIDetail").getData()]}else{l=sap.ui.getCore().getModel("AIWMPMI").getData()}if(s.length>0){for(var u=0;u<s.length;u++){var g={Tplnr:s[u].Functionallocation,Txtmi:s[u].Flocdescription,TplkzFlc:s[u].Strucindicator,Tplxt:s[u].StrucIndicatorDesc,EditMask:s[u].EditMask,Hierarchy:s[u].Hierarchy,Fltyp:s[u].Floccategory,Flttx:s[u].FlocCategoryDesc,Swerk:s[u].Maintplant,Plantname:s[u].MaintplantDesc,StorFloc:s[u].Location,Locationdesc:s[u].Locationdesc,Abckzfloc:s[u].Abckz,Abctx:s[u].Abctx,Bukrsfloc:s[u].Bukrs,Butxt:s[u].Butxt,City:s[u].City,KostFloc:s[u].Kostl,KokrFloc:s[u].Kokrs,Contareaname:s[u].Mctxt,PlntFloc:s[u].Werks,Planningplantdes:s[u].Planningplantdes,Ingrp:s[u].Ingrp,Plannergrpdesc:s[u].Innam,Arbplfloc:s[u].Arbpl,Wergwfloc:s[u].WcWerks,Gewrkfloc:s[u].MainArbpl,MainWcPlant:s[u].MainWerks,Tplma:s[u].SupFunctionallocation,Supflocdesc:s[u].SupFlocdescription,BeberFl:s[u].BeberFl,Fing:s[u].Fing,Tele:s[u].Tele,Submtiflo:s[u].ConstrType,Constdesc:s[u].ConstructionDesc,Eqart:s[u].TechnicalObjectTyp,Eartx:s[u].Description,Stattext:s[u].Stattext,StsmFloc:s[u].StsmEqui,Statproftxt:s[u].StsmEquiDesc,UstwFloc:s[u].UstwEqui,UswoFloc:s[u].UswoEqui,UstaFloc:s[u].UstaEqui,IsMenu:s[u].menuAction,Adrnri:s[u].Adrnri};g.Type=true;i.FuncLoc.push(g);if(s[u].Title!==""&&s[u].Title!==undefined||s[u].TitleCode!==""&&s[u].TitleCode!==undefined||s[u].Name1!==""&&s[u].Name1!==undefined||s[u].Name2!==""&&s[u].Name2!==undefined||s[u].Name3!==""&&s[u].Name3!==undefined||s[u].Name4!==""&&s[u].Name4!==undefined||s[u].Sort1!==""&&s[u].Sort1!==undefined||s[u].Sort2!==""&&s[u].Sort2!==undefined||s[u].NameCo!==""&&s[u].NameCo!==undefined||s[u].PostCod1!==""&&s[u].PostCod1!==undefined||s[u].City1!==""&&s[u].City1!==undefined||s[u].Building!==""&&s[u].Building!==undefined||s[u].Floor!==""&&s[u].Floor!==undefined||s[u].Roomnum!==""&&s[u].Roomnum!==undefined||s[u].AddrLocation!==""&&s[u].AddrLocation!==undefined||s[u].Strsuppl1!==""&&s[u].Strsuppl1!==undefined||s[u].Strsuppl2!==""&&s[u].Strsuppl2!==undefined||s[u].Strsuppl3!==""&&s[u].Strsuppl3!==undefined||s[u].TimeZone!==""&&s[u].TimeZone!==undefined||s[u].RefPosta!==""&&s[u].RefPosta!==undefined||s[u].Region!==""&&s[u].Region!==undefined){var d={Funcloc:s[u].Functionallocation,Title:s[u].TitleCode,Name1:s[u].Name1,Name2:s[u].Name2,Name3:s[u].Name3,Name4:s[u].Name4,Sort1:s[u].Sort1,Sort2:s[u].Sort2,NameCo:s[u].NameCo,PostCod1:s[u].PostCod1,City1:s[u].City1,Building:s[u].Building,Floor:s[u].Floor,Roomnum:s[u].Roomnum,Strsuppl1:s[u].Strsuppl1,Strsuppl2:s[u].Strsuppl2,Strsuppl3:s[u].Strsuppl3,Location:s[u].AddrLocation,RPostafl:s[u].RefPosta,Landx:s[u].Landx,TimeZone:s[u].TimeZone,RPostFl:s[u].Region,Regiotxt:s[u].RegionDesc};i.FLAddr.push(d)}var p=s[u].classItems;if(p){if(p.length>0){for(var c=0;c<p.length;c++){var m={Funcloc:s[u].Functionallocation,Classtype:p[c].Classtype,Class:p[c].Class,Clstatus1:p[c].Clstatus1,Artxt:p[c].ClassTypeDesc};i.FLClass.push(m)}}}var M=s[u].characteristics;if(M){if(M.length>0){for(var f=0;f<M.length;f++){var h={Funcloc:s[u].Functionallocation,Atnam:M[f].Atnam,Textbez:M[f].Textbez,Atwrt:M[f].Atwrt,Class:M[f].Class};i.FLVal.push(h)}}}}}if(o.length>0){for(var S=0;S<o.length;S++){var b={Herst:o[S].Herst,Equnr:o[S].Equnr,Txtmi:o[S].Eqktx,Swerk:o[S].Maintplant,Name1:o[S].MaintplantDesc,TplnEilo:o[S].Tplnr,Flocdescription:o[S].Pltxt,Eqtyp:o[S].EquipmentCatogory,Etytx:o[S].EquipCatgDescription,Eqart:o[S].TechnicalObjectTyp,Eartx:o[S].Description,Typbz:o[S].Typbz,SubmEeqz:o[S].ConstrType,Constdesc:o[S].ConstructionDesc,BukrEilo:o[S].Bukrs,Butxt:o[S].Butxt,HequEeqz:o[S].SuperordinateEquip,SuperordEqDes:o[S].SuperordinateEquipDesc,TidnEeqz:o[S].TechIdNum,KostEilo:o[S].Kostl,KokrEilo:o[S].Kokrs,Contareaname:o[S].Mctxt,StorEilo:o[S].Location,Locationdesc:o[S].Locationdesc,AbckEilo:o[S].Abckz,Abctx:o[S].Abctx,PplaEeqz:o[S].Werks,Planningplantdes:o[S].Planningplantdes,IngrEeqz:o[S].Ingrp,Plannergrpdesc:o[S].Innam,Serge:o[S].Serge,MapaEeqz:o[S].MapaEeqz,Stattext:o[S].Stattext,StsmEqui:o[S].StsmEqui,Statproftxt:o[S].StsmEquiDesc,UstwEqui:o[S].UstwEqui,UswoEqui:o[S].UswoEqui,UstaEqui:o[S].UstaEqui,Answt:o[S].Answt,Ansdt:a._formatDate(o[S].Ansdt),Waers:o[S].Waers,ArbpEilo:o[S].Arbpl,WorkCenterPlant:o[S].WcWerks,ArbpEeqz:o[S].MainArbpl,MainWcPlant:o[S].MainWerks,BebeEilo:o[S].BeberFl,Fing:o[S].Fing,Tele:o[S].Tele,HeqnEeqz:o[S].EquipPosition,IsMenu:o[S].menuAction,Adrnri:o[S].Adrnri};b.Type=true;i.Equipment.push(b);if(o[S].Title!==""&&o[S].Title!==undefined||o[S].TitleCode!==""&&o[S].TitleCode!==undefined||o[S].Name1!==""&&o[S].Name1!==undefined||o[S].Name2!==""&&o[S].Name2!==undefined||o[S].Name3!==""&&o[S].Name3!==undefined||o[S].Name4!==""&&o[S].Name4!==undefined||o[S].Sort1!==""&&o[S].Sort1!==undefined||o[S].Sort2!==""&&o[S].Sort2!==undefined||o[S].NameCo!==""&&o[S].NameCo!==undefined||o[S].PostCod1!==""&&o[S].PostCod1!==undefined||o[S].City1!==""&&o[S].City1!==undefined||o[S].Building!==""&&o[S].Building!==undefined||o[S].Floor!==""&&o[S].Floor!==undefined||o[S].Roomnum!==""&&o[S].Roomnum!==undefined||o[S].AddrLocation!==""&&o[S].AddrLocation!==undefined||o[S].Strsuppl1!==""&&o[S].Strsuppl1!==undefined||o[S].Strsuppl2!==""&&o[S].Strsuppl2!==undefined||o[S].Strsuppl3!==""&&o[S].Strsuppl3!==undefined||o[S].TimeZone!==""&&o[S].TimeZone!==undefined||o[S].RefPosta!==""&&o[S].RefPosta!==undefined||o[S].Region!==""&&o[S].Region!==undefined){var v={Equi:o[S].Equnr,Title:o[S].TitleCode,Name1:o[S].Name1,Name2:o[S].Name2,Name3:o[S].Name3,Name4:o[S].Name4,Sort1:o[S].Sort1,Sort2:o[S].Sort2,NameCo:o[S].NameCo,PostCod1:o[S].PostCod1,City1:o[S].City1,Building:o[S].Building,Floor:o[S].Floor,Roomnum:o[S].Roomnum,Strsuppl1:o[S].Strsuppl1,Strsuppl2:o[S].Strsuppl2,Strsuppl3:o[S].Strsuppl3,Location:o[S].AddrLocation,RefPosta:o[S].RefPosta,Landx:o[S].Landx,TimeZone:o[S].TimeZone,RfePost:o[S].Region,Regiotxt:o[S].RegionDesc};i.EqAddr.push(v)}var E={Equi:o[S].Equnr,PlanvPrt:o[S].PlanvPrt,SteufPrt:o[S].SteufPrt,KtschPrt:o[S].KtschPrt,Ewformprt:o[S].Ewformprt,SteufRef:o[S].SteufRef,KtschRef:o[S].KtschRef,EwformRef:o[S].EwformRef};i.EqPRT.push(E);var P=o[S].classItems;if(P){if(P.length>0){for(var C=0;C<P.length;C++){var I={Equi:o[S].Equnr,Classtype:P[C].Classtype,Class:P[C].Class,Clstatus1:P[C].Clstatus1,Artxt:P[C].ClassTypeDesc};i.EqClass.push(I)}}}var T=o[S].characteristics;if(T){if(T.length>0){for(var O=0;O<T.length;O++){var A={Equi:o[S].Equnr,Atnam:T[O].Atnam,Textbez:T[O].Textbez,Atwrt:T[O].Atwrt,Class:T[O].Class};i.EqVal.push(A)}}}}}if(l.length>0){for(var x=0;x<l.length;x++){var y={Warpl:l[x].Warpl,Abrho:l[x].Abrho,Hunit:l[x].Hunit,Mptyp:l[x].Mptyp,Wptxt:l[x].Wptxt,Stich:l[x].Stich.toString(),Fabkl:l[x].Fabkl,FabklDesc:l[x].FabklDesc,Sfakt:l[x].Sfakt,Andor:a.parseValue(l[x].Andor),Mehrfach:a.parseValue(l[x].Mehrfach),Strat:l[x].Strat,StratDesc:l[x].StratDesc,Wset:l[x].Wset,Startdate:a._formatDate(l[x].Stadt),Unitc:l[x].Unitc,Szaeh:l[x].Szaeh,PointStp:l[x].Mpcycleno,Vspos:l[x].Vspos,Topos:l[x].Topos,Vsneg:l[x].Vsneg,Toneg:l[x].Toneg,Horiz:l[x].Horiz,CallConf:l[x].CallConf,PlanSort:l[x].PlanSort,Begru:l[x].Begru,IsMenu:l[x].menuAction};y.Type=true;i.MPLAN.push(y);var w=l[x].itemModel;if(w){for(var q=0;q<w.length;q++){var D={Mplan:l[x].Warpl,Qmart:w[q].Qmart,Qmartx:w[q].nTypeTxt,PlntMi:w[q].Werks,Planningplantdes:w[q].Planningplantdes,IngrpMi:w[q].Ingrp,Plannergrpdesc:w[q].Innam,Pstxt:w[q].Pstxt,WergwMi:w[q].WergwMi,ArbpMi:w[q].ArbpMi,Auart:w[q].Auart,Ordertypedesc:w[q].oTypeTxt,Bautl:w[q].AsmblyOb,Cycleseq:w[q].Cycleseq,Equnr:w[q].Equnr,Equipdesc:w[q].Eqktx,TplnrMi:w[q].Tplnr,Flocdesc:w[q].Pltxt,Mitemnumb:w[q].Mitemnumb,PlnnrMi:w[q].PlnnrMi,PlntyMi:w[q].PlntyMi,PlnalMi:w[q].PlnalMi};D.Type=true;i.MPItem.push(D)}}var V=this.getView().getModel("ObjListItemModel").getData();if(V){for(var L=0;L<V.length;L++){if(V[L].Warpl===l[x].Warpl){var N={AsmblyOb:V[L].AsmblyOb,EquiObj:V[L].EquiObj,FlocObj:V[L].FlocObj,MatnrObj:V[L].MatnrObj,Mitemnumb:V[L].Mitemnumb,Mplan:V[L].Warpl};i.MPOBList.push(N)}}}var F=l[x].cycleModel;if(F){for(var k=0;k<F.length;k++){var j={Mplan:l[x].Warpl,Point:F[k].Point,PointTxt:F[k].Psort,Offset:F[k].Offset,Ofsetunit:F[k].Ofsetunit,PakText:F[k].PakText,Zeieh:F[k].Zeieh,Zykl1:F[k].Zykl1,Cycleseqi:F[k].Cycleseqi,Mpcycleno:F[k].Mpcycleno};i.MPCycle.push(j)}}}}var W=function(r){var n={ObjListItems:[]};if(r.MPOBList){var i=r.MPOBList.results;if(i){var o=[];for(var s=0;s<i.length;s++){var l={};l.Warpl=i[s].Mplan;l.Mitemnumb=i[s].Mitemnumb;l.MatnrObj=i[s].MatnrObj;l.FlocObj=i[s].FlocObj;l.EquiObj=i[s].EquiObj;l.AsmblyOb=i[s].AsmblyOb;l.Matnrtxt=i[s].Matnrtxt;l.Equnrtxt=i[s].Equnrtxt;l.Tplnrtxt=i[s].Tplnrtxt;l.Bautltxt=i[s].Bautltxt;l.Enable=false;o.push(l)}n.ObjListItems=o}}a.getView().getModel("ObjListItemModel").setData(n.ObjListItems);a.validateOLI(e,t)};var B=function(e){var t=[];if(JSON.parse(e.responseText).error.innererror.errordetails===undefined||JSON.parse(e.responseText).error.innererror.errordetails.length===0){t[0]=JSON.parse(e.responseText).error.message.value}else{for(var r=0;r<JSON.parse(e.responseText).error.innererror.errordetails.length;r++){t[r]=JSON.parse(e.responseText).error.innererror.errordetails[r].message}}var n=t.join("\n");a.invokeMessage(n)};n.create(r,i,{success:W,error:B})},invokeMessage:function(e){this.createMessagePopover(e,"Error")},_getMessagePopover:function(){if(!this._oMessagePopover){this._oMessagePopover=sap.ui.xmlfragment("ugieamui.mdg.eam.lib.popover.MessagePopover",this);this.getView().addDependent(this._oMessagePopover)}return this._oMessagePopover},handleMessagePopoverPress:function(e){this._getMessagePopover().openBy(e.getSource())},createMessagePopover:function(e,t){var a=[];var r,n=this._getMessagePopover();if(typeof e==="string"){a.push({type:t,title:e,message:e})}else if(Array.isArray(e)){a=e;for(var i=0;i<a.length;i++){a[i].message=a[i].title}}sap.ui.getCore().getMessageManager().removeAllMessages();for(var i=0;i<a.length;i++){r=new l({message:a[i].message,type:a[i].type,target:"/Dummy",processor:this.getView().getModel()});sap.ui.getCore().getMessageManager().addMessages(r)}n.toggle(this.getView().byId("idMessagePopover"));this.getView().byId("idMessagePopover").setEnabled(true);this.getView().byId("idMessagePopover").setText(a.length+"")},onMaintPlantVH:function(e){o.maintPlantIPVH(e,this)},onMaintPlantChange:function(e){o.maintPlantIPchange(e,this)},onLocationVH:function(e){o.LocationIPVH(e,this)},onLocationChange:function(e){o.LocationIPchange(e,this)},onPlntSecVH:function(e){o.PlntSecIPVH(e,this)},onPlntSecChange:function(e){o.PlntSecIPchange(e,this)},onWrkCtrVH:function(e){o.WrkCtrIPVH(e,this)},onWrkCtrChange:function(e){o.WrkCtrIPchange(e,this)},onAbcIndVH:function(e){o.AbcIndIPVH(e,this)},onAbcIndChange:function(e){o.AbcIndIPchange(e,this)},onCompCodeVH:function(e){o.CompCodeIPVH(e,this)},onCompCodeChange:function(e){o.CompCodeIPchange(e,this)},onAssetVH:function(e){o.AssetIPVH(e,this)},onAssetChange:function(e){o.AssetIPchange(e,this)},onSubVH:function(e){o.SubIPVH(e,this)},onSubChange:function(e){o.SubIPchange(e,this)},onITBusinessVH:function(e){o.ITBusinessIPVH(e,this)},onITBusinessChange:function(e){o.ITBusinessIPchange(e,this)},onCostCenterVH:function(e){o.CostCenterIPVH(e,this)},onCostCenterChange:function(e){o.CostCenterIPchange(e,this)},onWBSEleVH:function(e){o.WBSEleIPVH(e,this)},onWBSEleChange:function(e){o.WBSEleIPchange(e,this)},onSetlOrdVH:function(e){o.SetlOrdIPVH(e,this)},onSetlOrdChange:function(e){o.SetlOrdIPchange(e,this)},onSerialNumVH:function(e){o.SerialNumVH(e,this)},onSerialNumChange:function(e){o.SerialNumChange(e,this)},onUIIVH:function(e){o.UIIVH(e,this)},onUIIChange:function(e){o.UIIChange(e,this)}})});